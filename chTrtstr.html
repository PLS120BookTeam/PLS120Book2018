<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <meta name="description" content="">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  


<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Applied Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path=""><a href="#chTrtstr"><i class="fa fa-check"></i><b>1</b> Treatment Structures and Comparisons</a><ul>
<li class="chapter" data-level="1.1" data-path=""><a href="#LearnObj12"><i class="fa fa-check"></i><b>1.1</b> Learning Objectives for Chapter</a></li>
<li class="chapter" data-level="1.2" data-path=""><a href="#PairComp"><i class="fa fa-check"></i><b>1.2</b> Pairwise Comparisons</a><ul>
<li class="chapter" data-level="1.2.1" data-path=""><a href="#least-significant-difference"><i class="fa fa-check"></i><b>1.2.1</b> Least Significant Difference</a></li>
<li class="chapter" data-level="1.2.2" data-path=""><a href="#experiment-wise-and-family-wise-error-rates"><i class="fa fa-check"></i><b>1.2.2</b> Experiment-wise and Family-wise Error Rates</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path=""><a href="#Factorials"><i class="fa fa-check"></i><b>1.3</b> Factorials</a><ul>
<li class="chapter" data-level="1.3.1" data-path=""><a href="#interactions"><i class="fa fa-check"></i><b>1.3.1</b> Interactions</a></li>
<li class="chapter" data-level="1.3.2" data-path=""><a href="#interactions-and-main-effects"><i class="fa fa-check"></i><b>1.3.2</b> Interactions and Main Effects</a></li>
<li class="chapter" data-level="1.3.3" data-path=""><a href="#model-and-calculations-in-factorials"><i class="fa fa-check"></i><b>1.3.3</b> Model and Calculations in Factorials</a></li>
<li class="chapter" data-level="1.3.4" data-path=""><a href="#advantages-of-factorials"><i class="fa fa-check"></i><b>1.3.4</b> Advantages of factorials</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path=""><a href="#Contrasts"><i class="fa fa-check"></i><b>1.4</b> Contrasts</a></li>
<li class="chapter" data-level="1.5" data-path=""><a href="#LinCombo"><i class="fa fa-check"></i><b>1.5</b> Linear Combinations</a></li>
<li class="chapter" data-level="1.6" data-path=""><a href="#ExSol12"><i class="fa fa-check"></i><b>1.6</b> Exercises and Solutions</a></li>
<li class="chapter" data-level="1.7" data-path=""><a href="#Hwk12"><i class="fa fa-check"></i><b>1.7</b> Homework</a></li>
<li class="chapter" data-level="1.8" data-path=""><a href="#laboratory-exercises"><i class="fa fa-check"></i><b>1.8</b> Laboratory Exercises</a><ul>
<li class="chapter" data-level="1.8.1" data-path=""><a href="#Lab12PLS"><i class="fa fa-check"></i><b>1.8.1</b> Plant Sciences</a></li>
<li class="chapter" data-level="1.8.2" data-path=""><a href="#Lab12ANS"><i class="fa fa-check"></i><b>1.8.2</b> Animal Sciences</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:title:end-->
<!--bookdown:title:start-->
<div id="chTrtstr" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Treatment Structures and Comparisons</h1>
<div id="LearnObj12" class="section level2">
<h2><span class="header-section-number">1.1</span> Learning Objectives for Chapter</h2>
<ol style="list-style-type: decimal">
<li>Identify treatments and factor levels in a factorial experiment.</li>
<li>State the null and alternative hypotheses of a factorial experiment.</li>
<li>Define and compare simple and main effects in a factorial.</li>
<li>Given a graph of factorial experiment results, determine if there are main effects and/or interaction effects.</li>
<li>Calculate PLSD confidence intervals for a pairwise comparison of means and determine if two means are significantly different based on the CIs.</li>
<li>Design factorial treatment combinations to answer a research question.</li>
<li>Transform a real-world question into a null hypothesis about means.</li>
<li>Create linear combinations of means that address practical real-world questions.</li>
<li>Define statistical interaction and explain it graphically.</li>
<li>Test hypotheses involving more than one and more than 2 means.</li>
<li>Interpret result of ANOVA with factorial treatments.</li>
<li>Interpret a graph of a factorial experiment, including description of L, Q and C trends.</li>
<li>Given a set of treatments, formulate and test useful contrasts.</li>
<li>Determine if a linear combination of means is a contrast.</li>
<li>Create contrasts to estimate the value and variance of interactions.</li>
<li>Estimate the variance of a linear combination of means.</li>
<li>Make confidence intervals for linear combination of estimated means.</li>
<li>Calculate and use the Least Significant Difference (LSD) to test for differences among treatments.</li>
<li>Apply the Protected LSD and explain how it ameliorates the inflation of alpha?</li>
<li>Create linear combinations of estimated treatment means.</li>
<li>Create contrasts to answer research questions such as effects of treatments, linear and quadratic effects of continuous treatment variables.</li>
</ol>
</div>
<div id="PairComp" class="section level2">
<h2><span class="header-section-number">1.2</span> Pairwise Comparisons</h2>
<p>ANOVA performs one test for the whole experiment, and one for each effect or line item in the model, including treatments. The single F test for treatments is used to test the null hypothesis that there are no treatment effects. If the F-value is greater than the critical value “from table” we reject Ho and accept the alternative, but we still do not know which treatments or factor levels are significantly different from each other. Estimated means need to be compared to determine which ones are different.</p>
<div id="least-significant-difference" class="section level3">
<h3><span class="header-section-number">1.2.1</span> Least Significant Difference</h3>
<p>Means are compared by subtracting one from the other and testing if the difference is significantly different form zero.</p>
<p><span class="math display">\[H_0: \mu_1 = \mu_2 \\
H_0: \mu_1 - \mu_2 = 0\]</span></p>
<p>Because the means are not known we use the estimates. Estimates of means are statistics, and because they are calculated as linear functions of normally distributed random variables, they are themselves normally distributed random variables.</p>
<div class="stattip">
<ul>
<li>
Recall: Linear combinations of normal random variables are normal random variables.
</li>
<li>
The mean of a linear combination is the linear combination of the means.
</li>
<li>
The variance of the difference between two RV’s is the sum of the individual variances plus twice their covariance.
</li>
<li>
Estimated means of balanced experiments are independent random variables (i.e. their covariance is zero).
</li>
</ul>
</div>
<p>The variance of an estimated mean depends on the number of observations used to estimate the mean (number of observations averaged) and on the variance of individual observations, which comes fro the random errors. The relationship between the variance of an average and the variance of individual observations is given by the <strong>PRIME DIRECTIVE</strong> of this course.</p>
</div>
<div id="experiment-wise-and-family-wise-error-rates" class="section level3">
<h3><span class="header-section-number">1.2.2</span> Experiment-wise and Family-wise Error Rates</h3>
<p>When multiple means are compared sequentially, a new problem arises. To understand the solution, first we need to fully understand the problem. In testing hypotheses we are particularly interested in avoiding problemd of “false positives” where two averages appear to be significantly different while they really are not. This is called “Type I” error. The nominal probability of making a Type I error in a test is <span class="math inline">\(\alpha\)</span>. This is referred to as the “test-wise” or “comparison-wise” error rate, because it is the error rate in each single comparison or test.</p>
<p>The probability of making at least one error Type I in a set of tests comparing treatments or testing other contrasts is called “family-wise” or “experiment-wise” error rate. Family-wise error rate tends to increase as the number of tests in the family increases, because an error in any of the tests is an error for the family. If tests are independent and test-wise error rate is kept constant at <span class="math inline">\(\alpha\)</span>, the number of errors in a family has a Binomial distribution. The probability of not making <strong>any</strong> errors in n comparisons, assuming independence, is <span class="math inline">\((1-\alpha)^n\)</span>. Thus, the probability of making <em>at least</em> one error is <span class="math inline">\(1-(1-\alpha)^n\)</span>.</p>
<p>As an example, consider an experiment where there are 6 treatments. The total number of pairwise comparisons is</p>
<p><span class="math display">\[\left(
    \begin{array}{c}
      6 \\
      2
    \end{array}
  \right) = \frac{6!}{2!(6-2)!} = 15\]</span></p>
<p>With 15 comparisons, the probability of making at least one error in the set is 0.5367087698. Obviosuly, this error is much greater than the nominal rate for each comparison. Several methods are available to make sure that the family-wise error rate remains close to the nominal of 5%.</p>
</div>
</div>
<div id="Factorials" class="section level2">
<h2><span class="header-section-number">1.3</span> Factorials</h2>
<p>Factorials are experiments where treatments have a special structure resulting from combining levels of different factors. The treatment structure allows us to assess the effects of several treatment factors as well as the interaction between factors. The concept of <strong>interaction</strong> is fundamental in statistics and in life in general and it is treated in detail below. Let’s concentrate on the factorial structure for now.</p>
<p>For a factorial set of treatments we need at least two factors or variables, each of which will take at least two values. Suppose you are trying to invite someone to have a meal with you and you want to maximize the chances of being accepted. Two main factors come into play: the type of cuisine you propose and the meal. In your town you have Mexican, Thai, Chinese, American and Japanese restaurants. You can have lunch or dinner. Therefore, you have 5 x 2 options for the invitation. For another example, imagine that you want to determine the best combination of speed and tire pressure to maximize your fuel efficiency whie commuting. The car manufacturer gives a recommendation for tire pressure, but that is not specifically adjusted for the roads in your commute, or for your typical range of speeds. You can choose several tire pressures around the manufacturers recommendation, and several speeds that are resonable around your average. Most likely, the effect of tire pressure will depend on speed because the relative importance of tire resistance and boncing depend on speed. Say you choose 32, 34 and 36 psi for tire pressure and 65, 70 and 75 mph for speed. You will have to test 3 x 3 combinations. These are called complete factorials because each level of each factor appears with each level of the other factors. Sometimes we say that the factors are <em>crossed</em> as in a table where rows are levels of one factor and columns are levels of the other factor (Table <a href="#tab:CrossedFactors">1.1</a>)</p>
<p><br><br></p>
<table>
<caption><span id="tab:CrossedFactors">Table 1.1: </span> Treatments resulting from the factorial combination of three levels of tire pressure (columns) and three levels of speed (rows). The treatment structure is a 3x3 factorial.</caption>
<thead>
<tr class="header">
<th align="right"></th>
<th align="center">32 psi</th>
<th align="center">34 psi</th>
<th align="center">36 psi</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">65 mph</td>
<td align="center">65-32</td>
<td align="center">65-34</td>
<td align="center">65-36</td>
</tr>
<tr class="even">
<td align="right">70 mph</td>
<td align="center">70-32</td>
<td align="center">70-34</td>
<td align="center">70-36</td>
</tr>
<tr class="odd">
<td align="right">75 mph</td>
<td align="center">75-32</td>
<td align="center">75-34</td>
<td align="center">75-36</td>
</tr>
</tbody>
</table>
<p><br><br></p>
<div id="interactions" class="section level3">
<h3><span class="header-section-number">1.3.1</span> Interactions</h3>
<p>Statistically, a two way interaction (or simply an interaction) is present when the effect of one factor depends on the level of another. The combined effects of changes in two factors is larger (synergistic or positive interaction) or smaller (antagonistic or negative interaction) than the sum of individual effects obtained when each factors is changed at a time. Interactions are common and we are familiar with them in daily life, but we typically do not take the time to think of them as interactions. Take for example the effect of putting on a nice warm coat on your level of comfort. It is a desirable effect if it is cold and not so good if it is really hot. There is an interaction between clothing and weather on comfort.</p>
<p>Three variables are involved in a two-way interaction, two predictor variables or treatment factors and one response variable. We say that predictor variable 1 (clothing) interacts with predictor variable 2 (ambient temperature) to determine the value of the reponse variable (level of comfort). Typical examples of interactions are:</p>
<ul>
<li>environment by genotype interaction on phenotype;</li>
<li>drug interaction of alcohol with opiods on alertness;</li>
<li>nitrogen and water supply interaction on crop yield.</li>
</ul>
<p>Interactions are scale dependent, which is a specific effect of the fact that interactions depend on the response variable. An interaction that is significant in one scale may become non-significant after a logarithmic transformation of the response variable.</p>
<p>Hamilton and Saito <span class="citation">[@HamiltonSaito2014]</span> describe an interaction between level of education and political affiliation on belief in anthropogenic climate change (<a href="#fig:HamiltonSaito2014">1.1</a>). The effect of increasing education on the proportion of people that believe that climate change is mostly anthropogenic depends on their political affiliation: while for Democrats belief increases with increasing education, for Republicans there is no effect and for Tea Party members it.</p>
<p><br></p>
<div class="figure" style="text-align: center"><span id="fig:HamiltonSaito2014"></span>
<img src="images/HamiltonSaito2014.png" alt="Example of an interaction graph where political party and level of education interact in determining the probability that a person believes that climate change is mostly anthropogenic. See citation in text." width="50%" />
<p class="caption">
Figure 1.1: Example of an interaction graph where political party and level of education interact in determining the probability that a person believes that climate change is mostly anthropogenic. See citation in text.
</p>
</div>
<p><br></p>
<p>Olson et al. <span class="citation">[@OlsonEtAl1991]</span> reported a typical genotype by environment on calf birth weight showing that different cattle breed have specific adaptation to environmental conditions. Brahman is a breed of <em>Bos indicus</em> that evolved in Asia and has been selected for tropical conditions, whereas Angus and Hereford are breeds that were selected for colder climates with higher quality forages. The effect of location on calf birth weight (kg) depends on the breed, therefore, there is an interaction.</p>
<p><br></p>
<div class="figure" style="text-align: center"><span id="fig:OlsonEtAl1991"></span>
<img src="12.0_TrtStructure_files/figure-html/OlsonEtAl1991-1.png" alt="Example of genotype by environment interaction on calf birth weight. British crosses (Angus-Hereford) perform better in Nebraska, whereas Brahman crosses do better in the semitropical climate of Florida. Vertical bars are standard errors of estimated means" width="60%" />
<p class="caption">
Figure 1.2: Example of genotype by environment interaction on calf birth weight. British crosses (Angus-Hereford) perform better in Nebraska, whereas Brahman crosses do better in the semitropical climate of Florida. Vertical bars are standard errors of estimated means
</p>
</div>
<p><br></p>
<p>Factorial treatment combinations can result from combining levels of more than two factors. There is no theoretical limit to the number of factors that can be included, but the number of treatments grows very fast with number of treatments and levels per factor. For example, a factorial of three factors, each with three levels has 27 different treatments.</p>
<p>When there are more than two factors, new levels of interactions appear in the partition of variation and each observation. With three factors, say A, B and C there are three 2-way interactions (AB, AC and BC) and one 3-way interaction (ABC). A 3-way interaction means that the two way interaction between two of the three factors is different in the two levels of the third factor.</p>
<p>Photosynthesis and plant growth are known to require nitrogen (mostly for enzymes, nucleic acids and structural proteins), light and carbon dioxide. Growth rate typically responds nonlinearly to each of these factors and is limited by all of them. The following figure shows a representation of a typical pattern of response (Figure <a href="#fig:threeWayA">1.3</a>)</p>
<p><br></p>
<div class="figure" style="text-align: center"><span id="fig:threeWayA"></span>
<img src="images/3WayFactorialA.png" alt="Representation of effects of light intensity, nitrogen and carbon dioxide concentration on photosynthesis rate by a well watered plant. $N_0$ and $N_1$ represents low and high nitrogen fertilization. $CO_{2_0}$ and $CO_{2_1}$ are low and high concentrations of carbon dioxide. Effects of increasing $CO_2$ concentration with high light intensity are labeled $e_1$ and $e_2$ for low and high N. Effects of increasing $CO_2$ concentration with low light intensity are labeled $e_3$ and $e_4$ for low and high N." width="60%" />
<p class="caption">
Figure 1.3: Representation of effects of light intensity, nitrogen and carbon dioxide concentration on photosynthesis rate by a well watered plant. <span class="math inline">\(N_0\)</span> and <span class="math inline">\(N_1\)</span> represents low and high nitrogen fertilization. <span class="math inline">\(CO_{2_0}\)</span> and <span class="math inline">\(CO_{2_1}\)</span> are low and high concentrations of carbon dioxide. Effects of increasing <span class="math inline">\(CO_2\)</span> concentration with high light intensity are labeled <span class="math inline">\(e_1\)</span> and <span class="math inline">\(e_2\)</span> for low and high N. Effects of increasing <span class="math inline">\(CO_2\)</span> concentration with low light intensity are labeled <span class="math inline">\(e_3\)</span> and <span class="math inline">\(e_4\)</span> for low and high N.
</p>
</div>
<p><br></p>
<p>To work our way up to the 3-way interaction we start with “effects” of increasing <span class="math inline">\(CO_2\)</span> concentration. The effect of increasing <span class="math inline">\(CO_2\)</span> concentration in with high light and N is calculated on the red curve in the top graph. The four curves are separated into different panels to facilitate the visualization of effects (<a href="#fig:threeWayB">1.4</a>)</p>
<p><br></p>
<div class="figure" style="text-align: center"><span id="fig:threeWayB"></span>
<img src="images/3WayFactorialB.png" alt="Same information as in previous figure, but presented in one separate set of axes for each combination of light intensity and N fertilizer addition. Top row has high N, and right colunm has high light intensity. The effect of increasing $CO_2$ concentration is depiced by a vertical bar and labeled $e_1$ to $e_4$." width="100%" />
<p class="caption">
Figure 1.4: Same information as in previous figure, but presented in one separate set of axes for each combination of light intensity and N fertilizer addition. Top row has high N, and right colunm has high light intensity. The effect of increasing <span class="math inline">\(CO_2\)</span> concentration is depiced by a vertical bar and labeled <span class="math inline">\(e_1\)</span> to <span class="math inline">\(e_4\)</span>.
</p>
</div>
<p><br></p>
<p>To calculate the effect of increasing <span class="math inline">\(CO_2\)</span> concentration in with high light and N, we move vertically on <span class="math inline">\(CO_{2_0}\)</span> and <span class="math inline">\(CO_{2_1}\)</span> until we reach the red curve. At each of the two points reached on the red curve we move horizontally to the left until we reach the Y axis, were we read the photosynthesis rate (PR) for low and high <span class="math inline">\(CO_2\)</span>. The difference between the two PR’s is the effect of increasing <span class="math inline">\(CO_2\)</span> for high light intensity and high level of N fertilization, and it is labeled <span class="math inline">\(e_1\)</span>. The process is repeated for each one of the graphs to get the effect of increasing <span class="math inline">\(CO_2\)</span> in each of the other three combinations of light and N, which are labeled <span class="math inline">\(e_2\)</span> through <span class="math inline">\(e_4\)</span>.</p>
<p><br></p>
<p>First, consider only the two graphs with high light intensity (righ column of Figure <a href="#fig:threeWayB">1.4</a>. We have a large effect of <span class="math inline">\(CO_2\)</span> with high N (<span class="math inline">\(e_1\)</span>, red vertical bar) and a smaller effect of <span class="math inline">\(CO_2\)</span> with low N (<span class="math inline">\(e_2\)</span>, yellow vertical bar). Therefore, the effect of <span class="math inline">\(CO_2\)</span> depends on the level of N, which fits the definition of a significant 2-way interaction. The value of this interaction is the difference in length between the red and the yellow bars or <span class="math inline">\(e_1 - e_2\)</span>, which is represented in Figure <a href="#fig:threeWayC">1.5</a> with a green vertical bar.</p>
<p>Now consider only the two graphs with low light intensity (left column of Figure <a href="#fig:threeWayB">1.4</a>). By repeating the same procedure applied in the right column we get two new effects of increasing <span class="math inline">\(CO_2\)</span> (<span class="math inline">\(e_3\)</span> with high and <span class="math inline">\(e_4\)</span> with low N) and their difference, which is the value of the 2-way interaction between <span class="math inline">\(CO_2\)</span> and N with low light (dark red or maroon vertical bar).</p>
<p>Finally, just like the difference in effects of one factor between levels or a second one is the 2-way interaction, the difference between 2-way interactions between levels of a third factor is the 3-way interaction, which is represented by the dark pink vertical bar.</p>
<p><br></p>
<div class="figure" style="text-align: center"><span id="fig:threeWayC"></span>
<img src="images/3WayFactorialC.png" alt="Two-way interactions between $CO_2$ and nitrogen are calculated as differences of effects of $CO_2$ between levels of N. There is a large difference in the high light condition and a smaller difference in the low light condifion. The difference between the 2-way $CO_2$ x N interactions in the two light conditions constitute the 3-way light x $CO_2$ x N interaction." width="100%" />
<p class="caption">
Figure 1.5: Two-way interactions between <span class="math inline">\(CO_2\)</span> and nitrogen are calculated as differences of effects of <span class="math inline">\(CO_2\)</span> between levels of N. There is a large difference in the high light condition and a smaller difference in the low light condifion. The difference between the 2-way <span class="math inline">\(CO_2\)</span> x N interactions in the two light conditions constitute the 3-way light x <span class="math inline">\(CO_2\)</span> x N interaction.
</p>
</div>
<p><br></p>
<p>Four factors produce six 2-way interactions (AB, AC, AD, BC, BD, CD), four 3-way interactions (ABC, ABD, ACD, BCD) and one 4-way interaction (ABCD), and so on. Two-way interactions are common and easy to understand intuitively; 3-way interactions may be common and are a bit harder to understand intuitively; 4-way interactions are almost impossible to understand in general terms for most people. However, I would guess that in the “real world” there are all sorts of complex interactions. Consider for example that you study plant growth rate and you use a factorial of four factors, each with 2 levels: with or without water, with or without carbon dioxide, with or without light and at -20 and 20 C. The plant will only grow in one of the 16 treatments, the one that includes water, carbon dioxide, light and a positive temperature. That is a 4-way interaction.</p>
</div>
<div id="interactions-and-main-effects" class="section level3">
<h3><span class="header-section-number">1.3.2</span> Interactions and Main Effects</h3>
<p>When a factorial has a significant interaction, the <strong>main effects may have little meaning</strong>, because they average over conditions that have different consequences for the factor in question. Take for example a typical (realistic but fictitious data) experiment in which a strong ecotype by environment is present. Two ecotypes (Montanus and Desertorum) are grown in two environments (desert and mountain) in what is called a reciprocal transplant experiment, where each ecotype is grown in its native environment and in the other’s environment, with replication. Mature size of the organisms (could be plants or animals or anything else that is alive and has a mature size) is measured and analyzed.</p>
<p><br></p>
<div class="figure" style="text-align: center"><span id="fig:interxVsMain"></span>
<img src="images/InterxVsMain.png" alt="Interaction plot showing the effects of ecotpye and environment on mature size. Although there are obsious responses to the treatments, main effects show no response for either factor." width="60%" />
<p class="caption">
Figure 1.6: Interaction plot showing the effects of ecotpye and environment on mature size. Although there are obsious responses to the treatments, main effects show no response for either factor.
</p>
</div>
<p><br></p>
<p>Each ecotype does better than the other when grown in its original environment (Panel A, Figure <a href="#fig:interxVsMain">1.6</a>). However, on average over ecotypes and over environments, there are no differences in mature size (Panels B and C, Figure <a href="#fig:interxVsMain">1.6</a>). The main effects hide the clear pattern of response exhibited by the individual treatment means. It would not make sense to say that either factor has no effect, however it is true that averaged over the levels of ecotype, environment had not effect, and vice versa. Thus, whenever interactions are present and significant, interpretation of results should start with an inspection of interaction graphs. <br></p>
</div>
<div id="model-and-calculations-in-factorials" class="section level3">
<h3><span class="header-section-number">1.3.3</span> Model and Calculations in Factorials</h3>
<p>Factorial treatments can be used with different experimental designs, because the treatment structure is independent of the experimental design that determines how treatments are assigned to experimental units. Consider an experiment in which two factors (say nitrogen fertilization and amount of irrigation) are used to create a factorial treatment structure by combining all levels of both factors. Each combination is a treatment, and we can (but some times we may not want to) ignore the treatment structure when assigning treatments to experimental units. We start with the simplest experimental design, the completely radomized design (CRD) where treatments are assigned to experimental units completely at random.</p>
<p>To make the equations general, we will call</p>
<ul>
<li><p>nitrogen <em>factor A</em> with levels <span class="math inline">\(a_1, \dots, a_{k_a}\)</span> and</p></li>
<li><p>irrigation will be <em>factor B</em> with levels <span class="math inline">\(b_1, \dots, b_{k_b}\)</span>.</p></li>
</ul>
<p>For example, the third nitrogen fertilization level is called <span class="math inline">\(a_3\)</span>, and the first level of irrigation is <span class="math inline">\(b_1\)</span>, thus, the treatment with level 3 of nitrogen and level 1 of irrigation is called <span class="math inline">\(a_3b_1\)</span>. The symbol <span class="math inline">\(k_a\)</span> represent the number of levels of factor A, and <span class="math inline">\(k_b\)</span> is the number of levels of factor B. The statistical model for this experiment is:</p>
<p><br><br></p>
<span class="math display" id="eq:crdFactorial">\[\begin{equation}
Y_{ijh} = \mu_{ij.} + \epsilon_{ijh} \\[20pt]
= \mu_{...} + \tau_{ij} + \epsilon_{ijh} \\[20pt]
= \mu_{...} + \alpha_i + \beta_j + \alpha\beta_{ij} + \epsilon_{ijh} \\[20pt]
\epsilon_{ijh} \sim N(0,\sigma) \\[20pt]
\text{where: } \quad \mu_{...} \quad \text{is the overall mean} \\[20pt]
\mu_{ij.} = \mu_{...} + \alpha_i + \beta_j + \alpha\beta_{ij} \quad \text{is the mean for treatment} \ a_ib_j\\[20pt]
\tau_{ij} =  \alpha_i + \beta_j + \alpha\beta_{ij} \quad \text{is the effect of treatment} \ a_ib_j\\[20pt]
\alpha_i \quad \text{is the effect of level } a_i \text{ of factor } A\\[20pt]
\beta_j \quad \text{is the effect of level } b_j \text{ of factor } B \\[20pt]
\alpha\beta_{ij} \quad \text{is the interaction between } a_i \text{ and } b_j
\tag{1.1}
\end{equation}\]</span>
<p><br><br></p>
<p>The model implies that each observation is partitioned into the five components present in the model: overall mean, effect of A, effect of B, interaction AB and random error. As usual, the model has a counterpart that uses estimates instead of the true but unknown parameter values. When the design is complete and balanced such that all treatments have the same number of replications,</p>
<p><br><br></p>
<span class="math display" id="eq:crdFactorialHat">\[\begin{equation}
Y_{ijh} = \hat{\mu}_{ij.} + \hat{\epsilon}_{ijh} \\[20pt]
= \hat{\mu}_{...} + \hat{\tau}_{ij} + \hat{\epsilon}_{ijh} \\[20pt]
= \hat{\mu}_{...} + \hat{\alpha}_i + \hat{\beta}_j + \hat{\alpha\beta}_{ij} + e_{ijh} \\[20pt]
\text{where: } \quad \hat{\mu}_{...} = \bar{Y}_{...} \quad \text{is the overall average} \\[20pt]
\hat{\tau}_{ij} = \bar{Y}_{ij.} - \bar{Y}_{...} = \hat{\alpha}_i + \hat{\beta}_j + \hat{\alpha\beta}_{ij} \quad \text{is the estimated effect of treatment} \ a_ib_j\\[20pt]
\hat{\alpha}_i = \bar{Y}_{i..} - \bar{Y}_{...} \quad \text{is the estimated effect of level } a_i \text{ of factor } A\\[20pt]
\hat{\beta}_j = \bar{Y}_{.j.} - \bar{Y}_{...} \quad \text{is the estimated effect of level } b_j \text{ of factor } B \\[20pt]
\hat{\alpha\beta}_{ij} = \bar{Y}_{ij.} -  \bar{Y}_{i..} - \bar{Y}_{.j.} + \bar{Y}_{...} \quad \text{is the estimated interaction between } a_i \text{ and } b_j
\tag{1.2}
\end{equation}\]</span>
<p><br><br></p>
<p>If the experiment is laid out in a randomized complete block design, we simply add a term for blocks to the model (Equation <a href="#eq:rcbdFactorial">(1.3)</a>). Block effects are calculated as the difference of block averages and overall average, as usual</p>
<p><br><br></p>
<span class="math display" id="eq:rcbdFactorial">\[\begin{equation}
Y_{ijh} = \mu_{ij.} + B_h + \epsilon_{ijh} \\[20pt]
= \mu_{...} + \tau_{ij} + B_h + \epsilon_{ijh} \\[20pt]
\text{where: } \quad B_h \quad \text{is the effect of block h} \\[20pt]
B_h = \mu_{..j} - \mu_{...} \\[20pt]
\text{which is estimated as} \\[20pt]
\hat{B}_h = \bar{Y}_{..j} - \bar{Y}_{...} \\[20pt]
\tag{1.3}
\end{equation}\]</span>
<p><br><br></p>
<div id="r-code-for-factorial-in-rcbd" class="section level4">
<h4><span class="header-section-number">1.3.3.1</span> R Code for Factorial in RCBD</h4>
<p>The equations and calculations are illustrated with a numerical example. We conducted an experiment to determine the competitive ability of two naturalized grasses of the California Annual Grassland (Laca, unpublished data), <em>Lolium multiflorum</em> (Lam.) and <em>Bromus hordeaceus</em> (L.) which we will call Lomu and Brho for short. The experiment was laid out in an RCBD with 10 blocks and 6 treatments. Blocks were used because the field had fertility gradients caused by differences in soil types. Treatment structure was a 2 x 3 factorial of <strong>target</strong> plant (the species of the plant measured, which was Lomu or Brho) and <strong>competitor</strong> (self, both and none), which was the species surrounding the target individual. “Self” competitor was a competitor of the same species as the target (intraspecific competition), “both” was a mix of both species, and “none” meant that the target plant was grown in an area that was kept clear of any other species within a radius of 10 cm of the target plant. All plots were circular and had a radius of 10 cm around the target plant (Figure <a href="#fig:LomuBrhoTrtFig">1.7</a>). Areas around plots were kept clear of vegetation. Target plant mass and height were measured at maturity. Plant mass was transformed to meet the assumption of homogeneity of variance, but the range of values is comparable to the original units in mg per plant. We analyze plant mass as a function of blocks and the factorial set of treatments.</p>
<p><strong>Goal and hypothesis</strong> The goal of the study (for this section) was to determine if intra and interspecific competition were different for Lomu and Brho. The null hypothesis is that the effect of adding competitors depends on whether the competitor is of the same species or not. For logistic reasons, instead of using treatments with only interspecific competitors, we used a mixture of both species. Therefore, the main reason for the experiment was to determine if there was a significant statistical interaction between target and competitor species. We also had more specific hypotheses about which species was the superior competitor and the relative effects of intra and interspecific competition. Those are addressed in the <a href="#Contrasts">Section about Contrasts</a>.</p>
<p><br></p>
<div class="figure" style="text-align: center"><span id="fig:LomuBrhoTrtFig"></span>
<img src="images/LomuBrhoTrtFig.png" alt="Treatments used in the experiment to study competition between ryegrass (Lomu) and softchess (Brho). Rows are for target plants measured and columns are for competitor. Plots were circles of 20 cm diameter established in a field." width="80%" />
<p class="caption">
Figure 1.7: Treatments used in the experiment to study competition between ryegrass (Lomu) and softchess (Brho). Rows are for target plants measured and columns are for competitor. Plots were circles of 20 cm diameter established in a field.
</p>
</div>
<p><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">list</span>(lb.compDat[<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>, <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">5</span>)], lb.compDat[<span class="dv">31</span><span class="op">:</span><span class="dv">60</span>, <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">5</span>)]) <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw">kable</span>(<span class="dt">caption =</span> <span class="st">&quot;Data from experiment on competition between ryegrass and softchess (Laca, unpublished data)&quot;</span>, 
         <span class="dt">row.names =</span> <span class="ot">FALSE</span>, 
         <span class="dt">digits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">   </span><span class="kw">kable_styling</span>(<span class="dt">font_size =</span> <span class="dv">10</span>, 
                 <span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;condensed&quot;</span>))</code></pre></div>
<table class="kable_wrapper table table-condensed" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:LomuBrhoCompDat">Table 1.2: </span>Data from experiment on competition between ryegrass and softchess (Laca, unpublished data)
</caption>
<tbody>
<tr>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
block
</th>
<th style="text-align:left;">
species
</th>
<th style="text-align:left;">
competitor
</th>
<th style="text-align:right;">
mass.mg
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
1.Self
</td>
<td style="text-align:right;">
203
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
2.Both
</td>
<td style="text-align:right;">
133
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
3.None
</td>
<td style="text-align:right;">
269
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
1.Self
</td>
<td style="text-align:right;">
205
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
2.Both
</td>
<td style="text-align:right;">
245
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
3.None
</td>
<td style="text-align:right;">
391
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
1.Self
</td>
<td style="text-align:right;">
268
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
2.Both
</td>
<td style="text-align:right;">
221
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
3.None
</td>
<td style="text-align:right;">
340
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
1.Self
</td>
<td style="text-align:right;">
369
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
2.Both
</td>
<td style="text-align:right;">
226
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
3.None
</td>
<td style="text-align:right;">
268
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
1.Self
</td>
<td style="text-align:right;">
413
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
2.Both
</td>
<td style="text-align:right;">
317
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
3.None
</td>
<td style="text-align:right;">
279
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
1.Self
</td>
<td style="text-align:right;">
365
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
2.Both
</td>
<td style="text-align:right;">
453
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
3.None
</td>
<td style="text-align:right;">
649
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
1.Self
</td>
<td style="text-align:right;">
346
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
2.Both
</td>
<td style="text-align:right;">
287
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
3.None
</td>
<td style="text-align:right;">
248
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
1.Self
</td>
<td style="text-align:right;">
240
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
2.Both
</td>
<td style="text-align:right;">
205
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
3.None
</td>
<td style="text-align:right;">
475
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
1.Self
</td>
<td style="text-align:right;">
136
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
2.Both
</td>
<td style="text-align:right;">
132
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
3.None
</td>
<td style="text-align:right;">
427
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
1.Self
</td>
<td style="text-align:right;">
254
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
2.Both
</td>
<td style="text-align:right;">
181
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
3.None
</td>
<td style="text-align:right;">
425
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
block
</th>
<th style="text-align:left;">
species
</th>
<th style="text-align:left;">
competitor
</th>
<th style="text-align:right;">
mass.mg
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
1.Self
</td>
<td style="text-align:right;">
212
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
2.Both
</td>
<td style="text-align:right;">
109
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
3.None
</td>
<td style="text-align:right;">
348
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
1.Self
</td>
<td style="text-align:right;">
252
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
2.Both
</td>
<td style="text-align:right;">
207
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
3.None
</td>
<td style="text-align:right;">
347
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
1.Self
</td>
<td style="text-align:right;">
205
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
2.Both
</td>
<td style="text-align:right;">
243
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
3.None
</td>
<td style="text-align:right;">
313
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
1.Self
</td>
<td style="text-align:right;">
166
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
2.Both
</td>
<td style="text-align:right;">
143
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
3.None
</td>
<td style="text-align:right;">
410
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
1.Self
</td>
<td style="text-align:right;">
242
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
2.Both
</td>
<td style="text-align:right;">
129
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
3.None
</td>
<td style="text-align:right;">
345
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
1.Self
</td>
<td style="text-align:right;">
186
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
2.Both
</td>
<td style="text-align:right;">
177
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
3.None
</td>
<td style="text-align:right;">
563
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
1.Self
</td>
<td style="text-align:right;">
401
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
2.Both
</td>
<td style="text-align:right;">
135
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
3.None
</td>
<td style="text-align:right;">
394
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
1.Self
</td>
<td style="text-align:right;">
229
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
2.Both
</td>
<td style="text-align:right;">
320
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
3.None
</td>
<td style="text-align:right;">
508
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
1.Self
</td>
<td style="text-align:right;">
326
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
2.Both
</td>
<td style="text-align:right;">
162
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
Brho
</td>
<td style="text-align:left;">
3.None
</td>
<td style="text-align:right;">
395
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
1.Self
</td>
<td style="text-align:right;">
190
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
2.Both
</td>
<td style="text-align:right;">
222
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
Lomu
</td>
<td style="text-align:left;">
3.None
</td>
<td style="text-align:right;">
540
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>First we analyze the data using high-level R functions for linear models. Then, we will recreate the calculations “by hand” using basic functions and applying the formulas directly derived from the model. Prior to looking at results we check for homogeneity of residuals and normality using graphics. Residuals should be distributed symmetrically about zero, and should not exhibit any patterns when plotted against the predicted values for each observation. The quantile-quantile scatterplot should be closely grouped around a straight line.</p>
<p><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lb.m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(mass.mg <span class="op">~</span><span class="st"> </span>block <span class="op">+</span><span class="st"> </span>species <span class="op">*</span><span class="st"> </span>competitor, <span class="dt">data =</span> lb.compDat)

<span class="kw">plot</span>(<span class="kw">residuals</span>(lb.m1) <span class="op">~</span><span class="st"> </span><span class="kw">fitted</span>(lb.m1),
     <span class="dt">xlab =</span> <span class="st">&quot;Fitted values (Y hats)&quot;</span>, 
     <span class="dt">ylab =</span> <span class="st">&quot;Residuals (e&#39;s)&quot;</span>, 
     <span class="dt">pch =</span> <span class="dv">16</span>, 
     <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)

<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)

<span class="kw">qqp</span>(<span class="kw">residuals</span>(lb.m1), <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</code></pre></div>
<pre><code>## [1] 12 15</code></pre>
<div class="figure" style="text-align: center"><span id="fig:resdlLomuBrhoComp"></span>
<img src="12.0_TrtStructure_files/figure-html/resdlLomuBrhoComp-1.png" alt="Residual plots for factorial of target and competitor in RCBD." width="50%" /><img src="12.0_TrtStructure_files/figure-html/resdlLomuBrhoComp-2.png" alt="Residual plots for factorial of target and competitor in RCBD." width="50%" />
<p class="caption">
Figure 1.8: Residual plots for factorial of target and competitor in RCBD.
</p>
</div>
<p><br></p>
<p>Observations 12 and 15 are a little out of the assumed distribution (Figure <a href="#fig:resdlLomuBrhoComp">1.8</a>) because they have extremely large residuals compared to the rest of the observations. In a real analysis, we would explore the reasons why those observations have large residuals by double checking data entry and field notes, as well as integrity of lab samples. We note but ignore the outliers in the rest of the explanation, as the extreme residuals do not change the way calculations are done.</p>
<p><br></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:aovLomuBrhoComp">Table 1.3: </span>Analysis of variance table for Lomu vs. Brho competition experiment.
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Df
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
Mean Sq
</th>
<th style="text-align:right;">
F value
</th>
<th style="text-align:right;">
Pr(&gt;F)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
block
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
147639
</td>
<td style="text-align:right;">
16404
</td>
<td style="text-align:right;">
3.08
</td>
<td style="text-align:right;">
0.00586
</td>
</tr>
<tr>
<td style="text-align:left;">
species
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
34225
</td>
<td style="text-align:right;">
34225
</td>
<td style="text-align:right;">
6.42
</td>
<td style="text-align:right;">
0.01486
</td>
</tr>
<tr>
<td style="text-align:left;">
competitor
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
365809
</td>
<td style="text-align:right;">
182905
</td>
<td style="text-align:right;">
34.29
</td>
<td style="text-align:right;">
0.00000
</td>
</tr>
<tr>
<td style="text-align:left;">
species:competitor
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
57388
</td>
<td style="text-align:right;">
28694
</td>
<td style="text-align:right;">
5.38
</td>
<td style="text-align:right;">
0.00804
</td>
</tr>
<tr>
<td style="text-align:left;">
Residuals
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
240016
</td>
<td style="text-align:right;">
5334
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>All effects in the model were significant. The line items in the ANOVA table (Table <a href="#tab:aovLomuBrhoComp">1.3</a>) correspond to specfic hypotheses, and the fact that the probabilities, listed in the last column, are all smaller than 0.05 means that all null hypotheses are rejected. In general, hypotheses tested are that effects are all zero, but the origin of the hypotheses is a set of questions about intra and interspecific competition. Our main question whether intra and interspecific competition is the same in boh species. This is convenient because it focuses first on the interaction. In general, the interactions should be tested first in factorials. If they are significant, then specific comparisons of cell means should be performed and interpreted, because marginal means may no be interpretable (see <a href="#Contrasts">Section about Contrasts</a>).</p>
<p><strong>Interaction between species and competitor:</strong> Is the effect of competition the same in both species? If competitive effects are equal, the <strong>effect of adding competitors</strong> will be the same in all cases. This effect is the difference between the control with no competition and each of the treatments with competitors, wthin species. To say that competitive strengths differs between species is the same as stating that the effects of competition (factor B) differ between levels of species (factor A), which is the definition of interaction. So our first interesting hypothesis refers directly to the interaction.</p>
<p><br></p>
<p><span class="math display">\[\text{ Null hypothesis: competition effects are the same for Lomu and Brho } \\[15pt]
H_0: \alpha\beta_{ij} =  0 \quad \text{for all pairs } \ i,j \\[15pt]
\text{which is equivalent to: } \\[15pt]
\begin{equation}
H_0: \quad
  \begin{cases}
    \mu_{LomuNone} - \mu_{LomuSelf} = \mu_{BrhoNone} - \mu_{BrhoSelf} &amp; \quad \text{and} \\
    \mu_{LomuNone} - \mu_{LomuBoth} = \mu_{BrhoNone} - \mu_{BrhoBoth} &amp; \quad \text{and} \\
    \mu_{LomuBoth} - \mu_{LomuSelf} = \mu_{BrhoBoth} - \mu_{BrhoSelf} 
  \end{cases} \\[45pt]
\text{Alternative hypothesis: at least one of the three pairs of effects is not equal} \\[15pt]
\end{equation}\]</span></p>
<p><br></p>
<p>The hypothesis about interactions is tested in the line of the ANOVA labeled <code>species:competitor</code>. The calculated F value is 5.38, which is rather large. The probability of observing a calculated F of such value or larger when <span class="math inline">\(H_0\)</span> is true (called “p-value”) is 0.008, which is smaller than the <span class="math inline">\(\alpha = 0.05\)</span> required for rejecting the null hypothesis. Thus, we reject <span class="math inline">\(H_0\)</span> and accept <span class="math inline">\(H_a\)</span>, which means that competition effects differ between the species. Because the interaction is “significant,” we can proceed to more detailed comparisons of cell means to answer the question more specifically: which species is the superior competitor, and how does competition against both competitors differ from competing against self? Those specific hypotheses are addressed below (see <a href="#Contrasts">Section about Contrasts</a>).</p>
<p><strong>Marginal competition effect:</strong> is there an effect of competition on mature mass? We pose the null hypothesis that leads to a strong inference by its rejection: on average over species, competition does not affect mature size. If there were no competition, then plant mass at maturity for each species should not be affected by the competitor treatment. Lomu and Brho may differ in mean size, but their size would not be affected by the competitor. Keep in mind that a significant interaction was detected, so the interpretation of marginal results may be misleading and have to be considered with caution. The line corresponding to <code>competitor</code> in the ANOVA table (Table <a href="#tab:aovLomuBrhoComp">1.3</a>) shows a p-value of 0, which is significant. The null hypothesis that competition has no effect, or that mature size is the same, regardless of competition, is rejected.</p>
<p><br></p>
<p><span class="math display">\[\text{ Null hypothesis: there is no competition effect on mature size } \\[15pt]
H_0: \mu_{.None} = \mu_{.Self} =  \mu_{.Both} \\[15pt]
\text{Alternative hypothesis: at least one of the three pairs is not equal} \\[15pt]
\begin{equation}
H_a: \quad
  \begin{cases}
    \mu_{.None} \neq  \mu_{.Self}       &amp; \quad \text{or} \\
    \mu_{.None} \neq  \mu_{.Both}       &amp; \quad \text{or} \\
    \mu_{.Self} \neq  \mu_{.Both}
  \end{cases}
\end{equation}\]</span></p>
<p><br></p>
<p>Note that the hypotheses were posed as means or effects being equal or not equal. It would be equivalent to state that the differences between the terms on each side of the “=” sign are zero. For example:</p>
<p><br></p>
<p><span class="math display">\[H_0: \mu_{.None} = \mu_{.Self} =  \mu_{.Both} \\[15pt]\]</span> is equivalent to</p>
<p><br></p>
<p><span class="math display">\[H_0:\mu_{.None} - \mu_{.Self} = 0 \quad \text{AND} \quad \mu_{.None} - \mu_{.Both} = 0  \quad \text{AND} \quad \mu_{.Self} - \mu_{.Both} = 0 \]</span></p>
<p><br></p>
<p><strong>Marginal species effect:</strong> do species differ in mature size, averaged over competition treatments? Because of the significant interaction detected, the same note about caution applies here. The interaction means that the difference in mature size between species depends on competition. Ignoring the interaction for now, we test the marginal effect of species. Based on the line for <code>species</code> in the ANOVA table, we reject the null hupothesis that mature plant mass is the same for both species.</p>
<p><br></p>
<p><span class="math display">\[\text{ Null hypothesis: there is no species effect on mature size } \\[15pt]
H_0: \mu_{Lomu.} = \mu_{Brho.} \\[15pt]
\text{Alternative hypothesis: mature size differs between species} \\[15pt]
\begin{equation}
H_a: \quad
    \mu_{Lomu.} \neq  \mu_{Brho.}
\end{equation}\]</span></p>
<p><br></p>
<p>Results can be presented using a table or a figure. A figure facilitates the interpretation of interactions. A table also includes standard errors and marginal means, which is more complete but harder to interpret quickly. Both are presented below for illustration.</p>
<p><br></p>
<div class="figure" style="text-align: center"><span id="fig:LomuBrhoCompFig1"></span>
<img src="12.0_TrtStructure_files/figure-html/LomuBrhoCompFig1-1.png" alt="Effects of species and competitor on mature plant size. Vertical bars are 95% confidence intervals. Plant mass is in transformed units, but values are commensurate with mass in mg." width="60%" />
<p class="caption">
Figure 1.9: Effects of species and competitor on mature plant size. Vertical bars are 95% confidence intervals. Plant mass is in transformed units, but values are commensurate with mass in mg.
</p>
</div>
<p><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cmm &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">emmeans</span>(lb.m1, <span class="st">&quot;competitor&quot;</span>))
smm &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">emmeans</span>(lb.m1, <span class="st">&quot;species&quot;</span>))
cspmm &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">emmeans</span>(lb.m1, <span class="st">&quot;species&quot;</span>, <span class="st">&quot;competitor&quot;</span>))</code></pre></div>
<p><br></p>
<table>
<caption><span id="tab:SppCompTable">Table 1.4: </span> Estimated marginal and cell means of mature plant mass for competition experiment. Mature plant mass is in transformed units <a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. Standard errors of cell means, marginal competitor and marginal species means are 23.09, 16.33 and 13.33.</caption>
<thead>
<tr class="header">
<th align="right"></th>
<th align="center"><strong>Competitor</strong></th>
<th align="center"></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><strong>Species</strong></td>
<td align="center"><strong>Self</strong></td>
<td align="center"><strong>Both</strong></td>
<td><strong>None</strong></td>
<td><strong>Spp means</strong></td>
</tr>
<tr class="even">
<td align="right">Brho</td>
<td align="center">275.2</td>
<td align="center">186.8</td>
<td>335.8</td>
<td>265.9</td>
</tr>
<tr class="odd">
<td align="right">Lomu</td>
<td align="center">245.6</td>
<td align="center">237.9</td>
<td>457.6</td>
<td>313.7</td>
</tr>
<tr class="even">
<td align="right"><strong>Comp. means</strong></td>
<td align="center">260.4</td>
<td align="center">212.3</td>
<td>396.7</td>
<td></td>
</tr>
</tbody>
</table>
<p><br></p>
<p><strong>R Code Summary</strong></p>
<p>The analysis of the factorial experiment, without the code for making the pretty figues and table was very simple. It only required 5 short lines of code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fit model to data. lb.compDat is the data frame with data</span>
lb.m1 &lt;-<span class="st"> </span><span class="kw">lm</span>(mass.mg <span class="op">~</span><span class="st"> </span>block <span class="op">+</span><span class="st"> </span>species <span class="op">*</span><span class="st"> </span>competitor, <span class="dt">data =</span> lb.compDat)

<span class="kw">anova</span>(lb.m1) <span class="co"># Perform ANOVA based on model</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: mass.mg
##                    Df    Sum Sq    Mean Sq  F value     Pr(&gt;F)    
## block               9 147638.82  16404.313  3.07561  0.0058621 ** 
## species             1  34224.82  34224.817  6.41673  0.0148598 *  
## competitor          2 365809.43 182904.717 34.29239 8.9656e-10 ***
## species:competitor  2  57388.23  28694.117  5.37980  0.0080369 ** 
## Residuals          45 240015.68   5333.682                        
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">residuals</span>(lb.m1) <span class="op">~</span><span class="st"> </span><span class="kw">fitted</span>(lb.m1)) <span class="co"># Check homogeneity of variance</span></code></pre></div>
<p><img src="12.0_TrtStructure_files/figure-html/FactorialCode1-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qqp</span>(<span class="kw">residuals</span>(lb.m1)) <span class="co"># Check normality</span></code></pre></div>
<p><img src="12.0_TrtStructure_files/figure-html/FactorialCode1-2.png" width="672" /></p>
<pre><code>## [1] 12 15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Get marginal means, S.E. and CI&#39;s for competitor</span>
<span class="kw">emmeans</span>(lb.m1, <span class="st">&quot;competitor&quot;</span>)</code></pre></div>
<pre><code>##  competitor emmean          SE df    lower.CL    upper.CL
##  1.Self     260.40 16.33046517 45 227.5087548 293.2912452
##  2.Both     212.35 16.33046517 45 179.4587548 245.2412452
##  3.None     396.70 16.33046517 45 363.8087548 429.5912452
## 
## Results are averaged over the levels of: block, species 
## Confidence level used: 0.95</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Get marginal means, S.E. and CI&#39;s for species</span>
<span class="kw">emmeans</span>(lb.m1, <span class="st">&quot;species&quot;</span>)</code></pre></div>
<pre><code>##  species      emmean          SE df    lower.CL    upper.CL
##  Brho    265.9333333 13.33376897 45 239.0777441 292.7889226
##  Lomu    313.7000000 13.33376897 45 286.8444107 340.5555893
## 
## Results are averaged over the levels of: block, competitor 
## Confidence level used: 0.95</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Get cell means, S.E. and CI&#39;s for treatments</span>
<span class="kw">emmeans</span>(lb.m1, <span class="st">&quot;species&quot;</span>, <span class="st">&quot;competitor&quot;</span>)</code></pre></div>
<pre><code>## competitor = 1.Self:
##  species emmean          SE df    lower.CL    upper.CL
##  Brho     275.2 23.09476532 45 228.6847549 321.7152451
##  Lomu     245.6 23.09476532 45 199.0847549 292.1152451
## 
## competitor = 2.Both:
##  species emmean          SE df    lower.CL    upper.CL
##  Brho     186.8 23.09476532 45 140.2847549 233.3152451
##  Lomu     237.9 23.09476532 45 191.3847549 284.4152451
## 
## competitor = 3.None:
##  species emmean          SE df    lower.CL    upper.CL
##  Brho     335.8 23.09476532 45 289.2847549 382.3152451
##  Lomu     457.6 23.09476532 45 411.0847549 504.1152451
## 
## Results are averaged over the levels of: block 
## Confidence level used: 0.95</code></pre>
</div>
<div id="detailed-calculations-for-factorial-in-rcbd" class="section level4">
<h4><span class="header-section-number">1.3.3.2</span> Detailed Calculations for Factorial in RCBD</h4>
<p>In this section we show the basic calculations to obtain parameter estimates and complete the ANOVA table for a factorial in a Randomized Complete Block Design. First, we obtain the parameter estimates by using overall and marginal averages. Then we partition each observation using the parameters and calculate the corresponding sums of squares. Finally, degrees of freedom are computed and the ANOVA table is constructed. Treatment averages:</p>
<p><br></p>
<p><span class="math display">\[\hat{\mu}_{ij.} = \bar{Y}_{ij.} = \frac{1}{r}\sum^{h=r}_{h=1}Y{ijh} \\[25pt]
\text{For example: } \\[25pt]
\hat{\mu}_{Brho,1.Self} = \frac{203 + 268 + 413 + 346 + 136 + 212 + 205 + 242 + 401 + 326}{10} = \]</span> 275.2</p>
<p><br></p>
<p>We can calculate treatment or cell averages using the <code>aggregate</code> function in R. Averages are merged with the data set so we can calculate treatment effects and later partition them into main effects and interactions.</p>
<div class="rtip">
<p>
Writing code in R can be greatly facilitated by carefully planning the names of objects. Note how the names below are organized such that it is easy to modify the code for species to get the code for competitors. The first chunk for cell averages was copied and quickly edited to get the chunks for marginal and block averages.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(cell.avgs &lt;-<span class="st"> </span><span class="kw">aggregate</span>(mass.mg <span class="op">~</span><span class="st"> </span>species <span class="op">+</span><span class="st"> </span>competitor, 
                         <span class="dt">data =</span> lb.compDat, 
                         <span class="dt">FUN =</span> mean))</code></pre></div>
<pre><code>##   species competitor mass.mg
## 1    Brho     1.Self   275.2
## 2    Lomu     1.Self   245.6
## 3    Brho     2.Both   186.8
## 4    Lomu     2.Both   237.9
## 5    Brho     3.None   335.8
## 6    Lomu     3.None   457.6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(cell.avgs)[<span class="dv">3</span>] &lt;-<span class="st"> &quot;cell.avg&quot;</span>

lb.compDat &lt;-<span class="st"> </span><span class="kw">merge</span>(lb.compDat, 
                    cell.avgs, 
                    <span class="dt">all =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Marginal averages are calculated as the averages of the corresponding cell averages.</p>
<p><span class="math display">\[\hat{\mu}_{i..} = \bar{Y}_{i..} = \frac{1}{k_b}\sum^{j=k_b}_{j=1}\bar{Y}_{ij.} = \frac{1}{k_b}\sum^{j=k_b}_{j=1}\hat{\mu}_{ij.} \\[25pt]
\text{where } k_b = 3 \text{ is the number of levels of factor B (competitor). For example: } \\[25pt]
\hat{\mu}_{Brho} = \frac{275.2 + 186.8 + 342.9}{3} = 265.9333333333\]</span></p>
<p><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(s.avgs &lt;-<span class="st"> </span><span class="kw">aggregate</span>(cell.avg <span class="op">~</span><span class="st"> </span>species, <span class="co"># get species averages</span>
                     <span class="dt">data =</span> cell.avgs, 
                     <span class="dt">FUN =</span> mean))</code></pre></div>
<pre><code>##   species    cell.avg
## 1    Brho 265.9333333
## 2    Lomu 313.7000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(s.avgs)[<span class="dv">2</span>] &lt;-<span class="st"> &quot;sp.avg&quot;</span> <span class="co"># change column name to facilitate merge</span>

(comp.avgs &lt;-<span class="st"> </span><span class="kw">aggregate</span>(cell.avg <span class="op">~</span><span class="st"> </span>competitor, <span class="co"># get competitor averages</span>
                     <span class="dt">data =</span> cell.avgs, 
                     <span class="dt">FUN =</span> mean))</code></pre></div>
<pre><code>##   competitor cell.avg
## 1     1.Self   260.40
## 2     2.Both   212.35
## 3     3.None   396.70</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(comp.avgs)[<span class="dv">2</span>] &lt;-<span class="st"> &quot;comp.avg&quot;</span> <span class="co"># change column name to facilitate merge</span></code></pre></div>
<p><br></p>
<p><span class="math display">\[\hat{\mu}_{.j.} = \bar{Y}_{.j.} = \frac{1}{k_a}\sum^{i=k_a}_{i=1}\bar{Y}_{ij.} = \frac{1}{k_a}\sum^{i=k_a}_{i=1}\hat{\mu}_{ij.} \\[25pt]
\text{where } k_a = 2 \text{ is the number of levels of factor A (target species). For example: } \\[25pt]
\hat{\mu}_{Self} = \frac{275.2 + 245.6}{2} = 260.4\\[30pt]\]</span></p>
<p>We follow an analogous procedure to estimate overall<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a> and block means with block averages. As an exercise, write down the equations to calculate block averages for this data set before read any further. The equations are shown further down (Equation <a href="#eq:FactBlockAvg">(1.4)</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># merge data set with marginal species and competitor averages</span>

lb.compDat &lt;-<span class="st"> </span><span class="kw">merge</span>(lb.compDat, 
                    s.avgs, 
                    <span class="dt">all =</span> <span class="ot">TRUE</span>)

lb.compDat &lt;-<span class="st"> </span><span class="kw">merge</span>(lb.compDat, 
                    comp.avgs, 
                    <span class="dt">all =</span> <span class="ot">TRUE</span>)

<span class="co"># calculate block averages and merge with data</span>

b.avgs &lt;-<span class="st"> </span><span class="kw">aggregate</span>(mass.mg <span class="op">~</span><span class="st"> </span>block, 
                    <span class="dt">data =</span> lb.compDat, 
                    <span class="dt">FUN =</span> mean)

<span class="kw">names</span>(b.avgs)[<span class="dv">2</span>] &lt;-<span class="st"> &quot;block.avg&quot;</span> <span class="co"># change column name to facilitate merge</span>

lb.compDat &lt;-<span class="st"> </span><span class="kw">merge</span>(lb.compDat, 
                    b.avgs, 
                    <span class="dt">all =</span> <span class="ot">TRUE</span>)

<span class="kw">print</span>(lb.compDat[ , <span class="op">-</span><span class="dv">4</span>], <span class="dt">digits =</span> <span class="dv">5</span>) <span class="co"># data with averages</span></code></pre></div>
<pre><code>##    block competitor species mass.mg cell.avg sp.avg comp.avg block.avg
## 1      1     1.Self    Brho     203    275.2 265.93   260.40    241.00
## 2      1     3.None    Lomu     391    457.6 313.70   396.70    241.00
## 3      1     2.Both    Brho     133    186.8 265.93   212.35    241.00
## 4      1     1.Self    Lomu     205    245.6 313.70   260.40    241.00
## 5      1     2.Both    Lomu     245    237.9 313.70   212.35    241.00
## 6      1     3.None    Brho     269    335.8 265.93   396.70    241.00
## 7     10     1.Self    Brho     205    275.2 265.93   260.40    246.67
## 8     10     2.Both    Brho     243    186.8 265.93   212.35    246.67
## 9     10     2.Both    Lomu     143    237.9 313.70   212.35    246.67
## 10    10     1.Self    Lomu     166    245.6 313.70   260.40    246.67
## 11    10     3.None    Lomu     410    457.6 313.70   396.70    246.67
## 12    10     3.None    Brho     313    335.8 265.93   396.70    246.67
## 13    11     3.None    Brho     345    335.8 265.93   396.70    273.67
## 14    11     2.Both    Brho     129    186.8 265.93   212.35    273.67
## 15    11     3.None    Lomu     563    457.6 313.70   396.70    273.67
## 16    11     1.Self    Lomu     186    245.6 313.70   260.40    273.67
## 17    11     1.Self    Brho     242    275.2 265.93   260.40    273.67
## 18    11     2.Both    Lomu     177    237.9 313.70   212.35    273.67
## 19    13     3.None    Brho     394    335.8 265.93   396.70    331.17
## 20    13     1.Self    Brho     401    275.2 265.93   260.40    331.17
## 21    13     3.None    Lomu     508    457.6 313.70   396.70    331.17
## 22    13     2.Both    Lomu     320    237.9 313.70   212.35    331.17
## 23    13     1.Self    Lomu     229    245.6 313.70   260.40    331.17
## 24    13     2.Both    Brho     135    186.8 265.93   212.35    331.17
## 25    14     3.None    Brho     395    335.8 265.93   396.70    305.83
## 26    14     2.Both    Brho     162    186.8 265.93   212.35    305.83
## 27    14     3.None    Lomu     540    457.6 313.70   396.70    305.83
## 28    14     2.Both    Lomu     222    237.9 313.70   212.35    305.83
## 29    14     1.Self    Brho     326    275.2 265.93   260.40    305.83
## 30    14     1.Self    Lomu     190    245.6 313.70   260.40    305.83
## 31     2     3.None    Brho     340    335.8 265.93   396.70    282.00
## 32     2     2.Both    Brho     221    186.8 265.93   212.35    282.00
## 33     2     1.Self    Brho     268    275.2 265.93   260.40    282.00
## 34     2     2.Both    Lomu     226    237.9 313.70   212.35    282.00
## 35     2     3.None    Lomu     268    457.6 313.70   396.70    282.00
## 36     2     1.Self    Lomu     369    245.6 313.70   260.40    282.00
## 37     4     1.Self    Brho     413    275.2 265.93   260.40    412.67
## 38     4     2.Both    Brho     317    186.8 265.93   212.35    412.67
## 39     4     3.None    Lomu     649    457.6 313.70   396.70    412.67
## 40     4     2.Both    Lomu     453    237.9 313.70   212.35    412.67
## 41     4     3.None    Brho     279    335.8 265.93   396.70    412.67
## 42     4     1.Self    Lomu     365    245.6 313.70   260.40    412.67
## 43     5     1.Self    Brho     346    275.2 265.93   260.40    300.17
## 44     5     3.None    Brho     248    335.8 265.93   396.70    300.17
## 45     5     1.Self    Lomu     240    245.6 313.70   260.40    300.17
## 46     5     2.Both    Brho     287    186.8 265.93   212.35    300.17
## 47     5     2.Both    Lomu     205    237.9 313.70   212.35    300.17
## 48     5     3.None    Lomu     475    457.6 313.70   396.70    300.17
## 49     7     1.Self    Brho     136    275.2 265.93   260.40    259.17
## 50     7     2.Both    Lomu     181    237.9 313.70   212.35    259.17
## 51     7     3.None    Brho     427    335.8 265.93   396.70    259.17
## 52     7     3.None    Lomu     425    457.6 313.70   396.70    259.17
## 53     7     2.Both    Brho     132    186.8 265.93   212.35    259.17
## 54     7     1.Self    Lomu     254    245.6 313.70   260.40    259.17
## 55     8     3.None    Brho     348    335.8 265.93   396.70    245.83
## 56     8     1.Self    Brho     212    275.2 265.93   260.40    245.83
## 57     8     2.Both    Lomu     207    237.9 313.70   212.35    245.83
## 58     8     1.Self    Lomu     252    245.6 313.70   260.40    245.83
## 59     8     2.Both    Brho     109    186.8 265.93   212.35    245.83
## 60     8     3.None    Lomu     347    457.6 313.70   396.70    245.83</code></pre>
<p><br></p>
<span class="math display" id="eq:FactBlockAvg">\[\begin{equation}
\hat{\mu}_{..h} = \bar{Y}_{..h} = \frac{1}{k_a k_b} \sum^{i=k_a}_{i=1}\sum^{j=k_b}_{j=1}Y_{ijh}
\tag{1.4}
\end{equation}\]</span>
<p><br></p>
<span class="math display" id="eq:FactAllAvg">\[\begin{equation}
\hat{\mu}_{...} = \frac{1}{k_a k_b} \sum^{i=k_a}_{i=1}\sum^{j=k_b}_{j=1}\hat{\mu}_{ij.}
\tag{1.5}
\end{equation}\]</span>
<p><br></p>
<p><strong>Sums of Squares</strong> Now that we have all averages we can calculate sums of squares. Sums of squares (SS) correspond to the effects in the model. Sums of squares are</p>
<ul>
<li><p>TSS or total sum of squares that is the sum of squares of total differences between observed value (<span class="math inline">\(Y_{ijh}\)</span>) and overall average (<span class="math inline">\(\hat{\mu}_{...}\)</span>).</p></li>
<li><p>SST or treatment sum of squares is the sum of squared differences between treatment (cell) averages<span class="math inline">\(\hat{\mu}_{ij.}\)</span> and overall average (<span class="math inline">\(\hat{\mu}_{...}\)</span>).</p></li>
<li><p>SSB or block sum of squares is the sum of squared differences between block average (<span class="math inline">\(\hat{\mu}_{..h}\)</span>) and overall average (<span class="math inline">\(\hat{\mu}_{...}\)</span>).</p></li>
<li><p>SSE or residual (error) sum of squares of differences between observed value (<span class="math inline">\(Y_{ijh}\)</span>) and predicted value (<span class="math inline">\(\hat{Y}_{ijh}\)</span>), where predicted value is the sum of overall average and all effects.</p></li>
</ul>
<p>Because the treatments have a factorial structure and each treatment effect <span class="math inline">\(\tau_{ij}\)</span> is partitioned into its components <span class="math inline">\(\alpha_i\)</span>, <span class="math inline">\(\beta_j\)</span> and <span class="math inline">\(\alpha\beta_{ij}\)</span>.Accordingly, SST is partitioned into SSA, SSB and SSAxB.</p>
<p><em>Total sum of squares</em></p>
<p>We use R to implement the equations that define each of the effects and corresponding sum of squares. First we calculate the overall average and use it to compute TSS. In the code below <code>all.avg</code> = <span class="math inline">\(\mu_{...}\)</span> and the column <code>lb.compDat$mass.mg</code> is the set of all <span class="math inline">\(Y_{ijh}\)</span>. Thus, <code>sum((lb.compDat\$mass.mg - all.avg) ^ 2)</code>= <span class="math inline">\(\sum_{i=1}^{k_a}\sum_{j=1}^{k_b}\sum_{h=1}^{r}(Y_{ijh} - \hat{\mu}_{...})^2\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(all.avg &lt;-<span class="st"> </span><span class="kw">mean</span>(cell.avgs<span class="op">$</span>cell.avg)) <span class="co"># get overall average</span></code></pre></div>
<pre><code>## [1] 289.8166667</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Total sum of squares</span>
(TSS &lt;-<span class="st"> </span><span class="kw">sum</span>((lb.compDat<span class="op">$</span>mass.mg <span class="op">-</span><span class="st"> </span>all.avg) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))</code></pre></div>
<pre><code>## [1] 845076.9833</code></pre>
<p><em>Sum of squares of Blocks</em></p>
<p>Now we compute SSB. In the code below, <code>lb.compDat\$block.avg</code> is <span class="math inline">\(\hat{\mu}_{..h}\)</span>, thus, <code>sum((lb.compDat\$block.avg - all.avg) ^ 2)</code> = <span class="math inline">\(\sum_{i=1}^{k_a}\sum_{j=1}^{k_b}\sum_{h=1}^{r}(\hat{\mu}_{..h} - \hat{\mu}_{...})^2 = k_a k_b \sum_{h=1}^{r}(\hat{\mu}_{..h} - \hat{\mu}_{...})^2\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Sum of squares of blocks</span>
(SSB &lt;-<span class="st"> </span><span class="kw">sum</span>((lb.compDat<span class="op">$</span>block.avg <span class="op">-</span><span class="st"> </span>all.avg) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))</code></pre></div>
<pre><code>## [1] 147638.8167</code></pre>
<p><em>Sum of squares of Treatments</em></p>
<p>For the SST we use the column <code>lb.compDat$cell.avg</code>, which contains the estimated mean for each combination of target species and competitor assigned to each observation.</p>
<div class="stattip">
<p>
Keep in mind that each observation is partitioned into an estimate of the overall mean plus all effects: block, factor A, factor B, interactions AxB and residual. All sums for SS are over all observations, although some estimates are repeated. For example, the estimated effect of Brho is the same for all plots where Brho was the target species.
</p>
</div>
</div>
</div>
<div id="advantages-of-factorials" class="section level3">
<h3><span class="header-section-number">1.3.4</span> Advantages of factorials</h3>
<p>Consider that you have to study the effects of irrigation and fertilization with N on corn yield. You could take a simple approach and do one experiment for irrigation and another for nitrogen, or you could study both factor at the same time in a factorial experiment. Note that “factorial” refers to the way treatments are organized and it says nothing about the experimental design in terms of how treatments are assigned to experimental units.</p>
<p>Here we demonstrate two main advantages of factorials:</p>
<ul>
<li>abiliyt to detect interactions between factors, and</li>
<li>much greater efficiency than separate experiments.</li>
</ul>
<p>To show the advantage of a factorial, we first simulate two separate experiments and then a single combined experiment with both factors. By comparing the results we will be able to see that the factorial approach has advantages.</p>
<p><br></p>
<div id="effects-of-irrigation-alone" class="section level4">
<h4><span class="header-section-number">1.3.4.1</span> Effects of Irrigation alone</h4>
<p>Using the simple approach, the experiment for irrigation includes two treatments: one or two irrigations. For this experiment, a moderate level of nitrogen of 160 lb/ac is selected. Treatments are repeated three times in each of two blocks (Table <a href="#tab:tblIrrigDat">1.5</a>). In this case we include replicates of treatments within blocks to have a total number of observations that will be comparable to case when we test both factors at once. The original data set has 20 observations, so we will simulate 12 observations <a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a> for the irrigation experiment and 10 observations for the nitrogen experiment.</p>
<p><br></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:tblIrrigDat">Table 1.5: </span>Simulated data for a simple experiment to test the effect of irrigation on wheat yield.
</caption>
<thead>
<tr>
<th style="text-align:left;">
Block
</th>
<th style="text-align:left;">
Irrigation
</th>
<th style="text-align:left;">
Nitrogen
</th>
<th style="text-align:right;">
rep
</th>
<th style="text-align:right;">
Yield
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
160
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
56.82849058
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
160
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
58.28407460
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
160
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
71.85949159
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
160
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
68.05398749
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
160
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
58.82404173
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
160
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
63.91184633
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
160
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
68.68347448
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
160
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
64.19005738
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
160
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
56.46286929
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
160
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
57.66065748
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
160
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
70.89138521
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
160
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
68.89097567
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>We analyze these data using the following model (Equation <a href="#eq:irrigMod1">(1.6)</a>), which is known to have the correct form because the data were simulated based on the same model. Note that the model does not mention the effect of nitrogen because the same dose of nitrogen was applied to all plots. <br></p>
<span class="math display" id="eq:irrigMod1">\[\begin{equation}
Y_{ijh} = \mu_{...} + \tau_i + B_j +  \epsilon_{ijh} \\[20pt]
\tau_i = \text{ effect of irrigation treatment with level i} \\
B_j = \text{ effect of block j} \\
\epsilon_{ijh} = \text{ random error in treatment i, block j and replicate h}
\tag{1.6}
\end{equation}\]</span>
<p><br></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:IrrigAnova">Table 1.6: </span>ANOVA table for irrigation effects on yield.
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Df
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
Mean Sq
</th>
<th style="text-align:right;">
F value
</th>
<th style="text-align:right;">
Pr(&gt;F)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Irrigation
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
306.0
</td>
<td style="text-align:right;">
306.0
</td>
<td style="text-align:right;">
38.28
</td>
<td style="text-align:right;">
0.00016
</td>
</tr>
<tr>
<td style="text-align:left;">
Block
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.79982
</td>
</tr>
<tr>
<td style="text-align:left;">
Residuals
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
71.9
</td>
<td style="text-align:right;">
8.0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<p><br></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:IrrigEmmeans">Table 1.7: </span>Effect of irrigation on wheat yield
</caption>
<thead>
<tr>
<th style="text-align:left;">
Irrigation
</th>
<th style="text-align:right;">
emmean
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
58.7
</td>
<td style="text-align:right;">
1.15
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
56.05
</td>
<td style="text-align:right;">
61.27
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
68.8
</td>
<td style="text-align:right;">
1.15
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
66.15
</td>
<td style="text-align:right;">
71.37
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>The ANOVA table shows that there is a significant difference in yield between treatments. Table <a href="#tab:IrrigEmmeans">1.7</a> contains the estimated means for both irrigations and shows that yield is significantly greater with two than with a single irrigation. The precision of the estimates is reflected in both the MSE in the ANOVA table and in the width of the confidence intervals of the table of means, which is about 5.22 bushels/ac (1 bushel of wheat is equivalent to 60 lb). The width of the confidence interval is calculated as twice the product of the critical t value, which depends on the degrees of freedom of the residuals (dfe = 9), and the standard error, which is the square root of the MSE divided by the square root of the number of experimental units averaged to get each estimated mean. There were 12 experimental units equally divided between the two treatments in the experiment, so six experimental units were used for the average of each treatment.</p>
<span class="math display">\[\begin{equation}
\text{CI width } = 2 \ t_{dfe, \alpha} \ \sqrt{\frac{MSE}{r}} \\[20pt]
\text{where the number of plots averaged per treatment is } r = 6 \\[20pt]
dfe = 9 \\[20pt]
t_{dfe, \alpha} = 2.2622 \\[20pt]
\text{therefore, CI width } = 2 \times 2.2622 \times 1.154 = 5.222
\end{equation}\]</span>
<p><br></p>
</div>
<div id="effects-of-nitrogen-alone" class="section level4">
<h4><span class="header-section-number">1.3.4.2</span> Effects of Nitrogen alone</h4>
<p>Following with the simple approach of one factor at a time, we do a second experiment to determine the effect of nitrogen fertilization on wheat yield. Five equally-spaced doses of nitrogen (0, 80, 160, 240 and 320 lb/ac) are selected. For this experiment, one irrigation is used for all plots. The five treatments are replicated in each of two blocks, such that each treatment appears in a single experimental unit per block.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:tblNitroDat">Table 1.8: </span>Simulated data for a simple experiment to test the effect of nitrogen on wheat yield.
</caption>
<thead>
<tr>
<th style="text-align:left;">
Block
</th>
<th style="text-align:left;">
Irrigation
</th>
<th style="text-align:left;">
Nitrogen
</th>
<th style="text-align:right;">
Yield
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
33.52849058
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
34.98407460
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
80
</td>
<td style="text-align:right;">
53.55949159
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
80
</td>
<td style="text-align:right;">
49.75398749
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
160
</td>
<td style="text-align:right;">
58.82404173
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
160
</td>
<td style="text-align:right;">
63.91184633
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
240
</td>
<td style="text-align:right;">
59.43347448
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
240
</td>
<td style="text-align:right;">
54.94005738
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
320
</td>
<td style="text-align:right;">
51.36286929
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
320
</td>
<td style="text-align:right;">
52.56065748
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>We analyze these data using the following model (Equation <a href="#eq:NitroMod1">(1.7)</a>), which is known to have the correct form because the data were simulated based on the same model. Note that the model does not mention the effect of irrigation because the same single irrigation was applied to all plots.</p>
<p><br></p>
<span class="math display" id="eq:NitroMod1">\[\begin{equation}
\begin{aligned}
Y_{ij} &amp;= \mu_{...} + \tau_i + B_j + \epsilon_{ij} \\[20pt]
\tau_i &amp;= \text{ effect of nitrogen treatment with level i} \\
B_j &amp;= \text{ effect of block j} \\
\epsilon_{ij} &amp;= \text{ random error in treatment i, block j}
\end{aligned}
\tag{1.7}
\end{equation}\]</span>
<p><br></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:NitroAnova">Table 1.9: </span>ANOVA table for nitrogen effects on yield.
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Df
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
Mean Sq
</th>
<th style="text-align:right;">
F value
</th>
<th style="text-align:right;">
Pr(&gt;F)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Nitrogen
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
854.1
</td>
<td style="text-align:right;">
213.5
</td>
<td style="text-align:right;">
26.67
</td>
<td style="text-align:right;">
0.00382
</td>
</tr>
<tr>
<td style="text-align:left;">
Block
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.95329
</td>
</tr>
<tr>
<td style="text-align:left;">
Residuals
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
32.0
</td>
<td style="text-align:right;">
8.0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<p><br></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:NitroEmmeans">Table 1.10: </span>Effect of nitrogen on wheat yield
</caption>
<thead>
<tr>
<th style="text-align:left;">
Nitrogen
</th>
<th style="text-align:right;">
emmean
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
34.3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
28.70
</td>
<td style="text-align:right;">
39.81
</td>
</tr>
<tr>
<td style="text-align:left;">
80
</td>
<td style="text-align:right;">
51.7
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
46.10
</td>
<td style="text-align:right;">
57.21
</td>
</tr>
<tr>
<td style="text-align:left;">
160
</td>
<td style="text-align:right;">
61.4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
55.81
</td>
<td style="text-align:right;">
66.92
</td>
</tr>
<tr>
<td style="text-align:left;">
240
</td>
<td style="text-align:right;">
57.2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
51.63
</td>
<td style="text-align:right;">
62.74
</td>
</tr>
<tr>
<td style="text-align:left;">
320
</td>
<td style="text-align:right;">
52.0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
46.41
</td>
<td style="text-align:right;">
57.52
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>The ANOVA table for the nitrogen experiment shows that there is a significant difference in yield between treatments. Table <a href="#tab:NitroEmmeans">1.10</a> contains the estimated means for nitrogen doses and shows that yield is highest when a dose of 160 lb N/ac is applied. Note that the reponse to nitrogen in not a straight line, and that the effect of adding 80 lb N/ac depends on how much was added already. An important part of this result is that more is not always better when it comes to nitrogen and plants. Too much nitrogen has a negative effect on plant growth, and in wheat it is known to be detrimental to the metabolism necessary for grain filling. Too much nitrogen results in reduced antioxidant ability, which lead to increased lipied peroxidation [KongEtAl2017]. Moreover, wheat is unable to absorb all the applied nitrogen, which leads to nitrogen percolating into deeper soil layers and water contamination [DongEtAl2011]. A graph of the response to nitrogen levels reveals the non-linearity of the response and the reduction of yield for high N doses (Figure <a href="#fig:nitroFig1">1.10</a>).</p>
<p><br><br></p>
<div class="figure" style="text-align: center"><span id="fig:nitroFig1"></span>
<img src="12.0_TrtStructure_files/figure-html/nitroFig1-1.png" alt="Effects of nitrogen fertilization level on wheat yield. Vertical error bars are confidence intervals." width="80%" />
<p class="caption">
Figure 1.10: Effects of nitrogen fertilization level on wheat yield. Vertical error bars are confidence intervals.
</p>
</div>
<p><br><br></p>
<p>Precision of mean estimates is reflected in both the MSE in the ANOVA table and in the width of the confidence intervals of the table of means, which is about 11.11 bushels/ac. Again, confidence interval width is calculated as twice the product of the critical t value, which depends on the degrees of freedom of the residuals (in this case dfe = 4), and the standard error, which is the square root of the MSE divided by the square root of the number of experimental units averaged to get each estimated mean. There were 10 experimental units equally divided between the 5 treatments in the experiment, so 2 experimental units were used for the average of each nitrogen treatment.</p>
<p><br></p>
<span class="math display">\[\begin{equation}
\text{CI width } = 2 \ t_{dfe, \alpha} \ \sqrt{\frac{MSE}{r}} \\[20pt]
\text{where the number of plots averaged per treatment is } r = 2 \\[20pt]
dfe = 4 \\[20pt]
t_{dfe, \alpha} = 2.7764 \\[20pt]
\text{therefore, CI width } = 2 \times 2.7764 \times 2.001 = 11.11
\end{equation}\]</span>
<p>If we base our irrigation and fertilization decisions in these two experiments we would decide to irrigate twice and apply 160 lb N/ac. As we will see below, it turns out that this is not the best decision possible, and that only a factorial experiment can reveal the optimal combination of irrigation and nitrogen because those two factors interact biologically and statistically.</p>
<p><br></p>
</div>
<div id="combined-effects-of-irrigation-and-nitrogen" class="section level4">
<h4><span class="header-section-number">1.3.4.3</span> Combined Effects of Irrigation and Nitrogen</h4>
<p>Instead of two experiments, we could do a single one where all levels of irrigation are combined with all levels of nitrogen in a factorial treatment structure. Each treatment is replicated once in each of two blocks. The experiment has 5 levels of nitrogen x 2 levels of irrigation x 2 blocks = 20 plots or experimental units. This is 2 fewer than the two individuial experiments together.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:tblIxNDat">Table 1.11: </span>Wheat yield (bu/ac) in an experiment to test the joint effects of nitrogen (lb/ac) and irrigation (times).
</caption>
<thead>
<tr>
<th style="text-align:left;">
Irrig
</th>
<th style="text-align:left;">
Nitro
</th>
<th style="text-align:right;">
Block 1
</th>
<th style="text-align:right;">
Block 2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
31.7
</td>
<td style="text-align:right;">
39.1
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
80
</td>
<td style="text-align:right;">
50.0
</td>
<td style="text-align:right;">
48.6
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
160
</td>
<td style="text-align:right;">
56.8
</td>
<td style="text-align:right;">
60.6
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
240
</td>
<td style="text-align:right;">
57.3
</td>
<td style="text-align:right;">
59.4
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
320
</td>
<td style="text-align:right;">
53.1
</td>
<td style="text-align:right;">
54.1
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
38.9
</td>
<td style="text-align:right;">
40.0
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
80
</td>
<td style="text-align:right;">
61.4
</td>
<td style="text-align:right;">
53.1
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
160
</td>
<td style="text-align:right;">
68.5
</td>
<td style="text-align:right;">
66.7
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
240
</td>
<td style="text-align:right;">
73.5
</td>
<td style="text-align:right;">
72.9
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
320
</td>
<td style="text-align:right;">
70.6
</td>
<td style="text-align:right;">
72.3
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Data from the factorial experiment are analyzed using the model in Equation <a href="#eq:IxnMod1">(1.8)</a>. The equation shows that each treatment effect is partitioned into nitrogen effect, irrigation effect and nitrogen by irrigation interaction. The interaction reflects the part of the response that is not explained by simply adding the individual effects of each factor.</p>
<p><br></p>
<span class="math display" id="eq:IxnMod1">\[\begin{equation}
\begin{aligned}
Y_{ijh} &amp;= \mu_{...} + \tau_{ij} + B_j + \epsilon_{ij} \\[20pt]
\tau_{ij} &amp;= \text{ effect of treatment with level i of nitrogen and level j of irrigation} \\
&amp;= N_i + I_j + NI_{ij} \\
N_i &amp;= \text{ effect of level i of nitrogen} \\
I_j &amp;= \text{ effect of level j of irrigation} \\
IN_{ij} &amp;= \text{ interaction effect of levels i and j} \\
B_j &amp;= \text{ effect of block j} \\
\epsilon_{ij} &amp;= \text{ random error in treatment i, block j}
\end{aligned}
\tag{1.8}
\end{equation}\]</span>
<p><br></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:IxNAnova">Table 1.12: </span>ANOVA table for nitrogen x irrigation factorial effects on yield.
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Df
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
Mean Sq
</th>
<th style="text-align:right;">
F value
</th>
<th style="text-align:right;">
Pr(&gt;F)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Irrigation
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
574.6
</td>
<td style="text-align:right;">
574.6
</td>
<td style="text-align:right;">
68.65
</td>
<td style="text-align:right;">
0.00002
</td>
</tr>
<tr>
<td style="text-align:left;">
Nitrogen
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2163.1
</td>
<td style="text-align:right;">
540.8
</td>
<td style="text-align:right;">
64.61
</td>
<td style="text-align:right;">
0.00000
</td>
</tr>
<tr>
<td style="text-align:left;">
Block
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.2
</td>
<td style="text-align:right;">
1.2
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.70814
</td>
</tr>
<tr>
<td style="text-align:left;">
Irrigation:Nitrogen
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
123.4
</td>
<td style="text-align:right;">
30.8
</td>
<td style="text-align:right;">
3.68
</td>
<td style="text-align:right;">
0.04826
</td>
</tr>
<tr>
<td style="text-align:left;">
Residuals
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
75.3
</td>
<td style="text-align:right;">
8.4
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Because we did the experiment using a factorial arrangewment of treatments, we have three types of comparisons we can do:</p>
<ul>
<li>compare average yield for levels of irrigation averaged over levels of nitrogen,</li>
<li>compare average yield for levels of nitrogen averaged over levels of irrigation, and</li>
<li>compare averages of individual treatments resulting from any two combinations of irrigation and nitrogen.</li>
</ul>
<p>The estimated means for irrigation levels and the estimated means for nitrogen levels are called <strong>marginal means</strong> because they are at the margins of the table and are the averages over all levels of the other factors. The estimated means for individual treatments or combinations of the factors are frequently called <strong>cell means</strong>.</p>
<p>Compare tables <a href="#tab:NitroEmmeans">1.10</a> vs. <a href="#tab:NmargMeans">1.13</a> and <a href="#tab:IrrigEmmeans">1.7</a> vs. <a href="#tab:ImargMeans">1.14</a> to see the advantages of the factorial. In the case of nitrogen, the factorial experiment has larger dfe than the nitrogen experiment. In both cases the standard error (SE) is smaller in the factorial, mostly because estimated means come from averaging more observations than in the separate experiments, although the separate experiments had more observations in total. By combining the treatments in a factorial we increase the degrees of freedom in the residuals, which results in a smaller critical t value, and we increase the total number of observations averaged to get the estimated marginal means.</p>
<p><br></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:NmargMeans">Table 1.13: </span>Marginal effects of nitrogen on wheat yield
</caption>
<thead>
<tr>
<th style="text-align:left;">
Nitrogen
</th>
<th style="text-align:right;">
emmean
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
37.4
</td>
<td style="text-align:right;">
1.45
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
34.15
</td>
<td style="text-align:right;">
40.70
</td>
</tr>
<tr>
<td style="text-align:left;">
80
</td>
<td style="text-align:right;">
53.3
</td>
<td style="text-align:right;">
1.45
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
50.00
</td>
<td style="text-align:right;">
56.55
</td>
</tr>
<tr>
<td style="text-align:left;">
160
</td>
<td style="text-align:right;">
63.2
</td>
<td style="text-align:right;">
1.45
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
59.88
</td>
<td style="text-align:right;">
66.42
</td>
</tr>
<tr>
<td style="text-align:left;">
240
</td>
<td style="text-align:right;">
65.8
</td>
<td style="text-align:right;">
1.45
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
62.50
</td>
<td style="text-align:right;">
69.05
</td>
</tr>
<tr>
<td style="text-align:left;">
320
</td>
<td style="text-align:right;">
62.5
</td>
<td style="text-align:right;">
1.45
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
59.25
</td>
<td style="text-align:right;">
65.80
</td>
</tr>
</tbody>
</table>
<p><br></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:ImargMeans">Table 1.14: </span>Marginal effects of irrigation on wheat yield
</caption>
<thead>
<tr>
<th style="text-align:left;">
Irrigation
</th>
<th style="text-align:right;">
emmean
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
51.1
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
49.00
</td>
<td style="text-align:right;">
53.14
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
61.8
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
59.72
</td>
<td style="text-align:right;">
63.86
</td>
</tr>
</tbody>
</table>
<p><br></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:IxNcellMeans">Table 1.15: </span>Joint effects of nitrogen and irrigation on wheat yield
</caption>
<thead>
<tr>
<th style="text-align:left;">
Nitrogen
</th>
<th style="text-align:left;">
Irrigation
</th>
<th style="text-align:right;">
emmean
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
35.4
</td>
<td style="text-align:right;">
2.05
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
30.8
</td>
<td style="text-align:right;">
40.0
</td>
</tr>
<tr>
<td style="text-align:left;">
80
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
49.3
</td>
<td style="text-align:right;">
2.05
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
44.7
</td>
<td style="text-align:right;">
53.9
</td>
</tr>
<tr>
<td style="text-align:left;">
160
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
58.7
</td>
<td style="text-align:right;">
2.05
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
54.1
</td>
<td style="text-align:right;">
63.3
</td>
</tr>
<tr>
<td style="text-align:left;">
240
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
58.4
</td>
<td style="text-align:right;">
2.05
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
53.7
</td>
<td style="text-align:right;">
63.0
</td>
</tr>
<tr>
<td style="text-align:left;">
320
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
53.6
</td>
<td style="text-align:right;">
2.05
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
49.0
</td>
<td style="text-align:right;">
58.2
</td>
</tr>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
39.5
</td>
<td style="text-align:right;">
2.05
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
34.8
</td>
<td style="text-align:right;">
44.1
</td>
</tr>
<tr>
<td style="text-align:left;">
80
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
57.3
</td>
<td style="text-align:right;">
2.05
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
52.6
</td>
<td style="text-align:right;">
61.9
</td>
</tr>
<tr>
<td style="text-align:left;">
160
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
67.6
</td>
<td style="text-align:right;">
2.05
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
63.0
</td>
<td style="text-align:right;">
72.2
</td>
</tr>
<tr>
<td style="text-align:left;">
240
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
73.2
</td>
<td style="text-align:right;">
2.05
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
68.6
</td>
<td style="text-align:right;">
77.8
</td>
</tr>
<tr>
<td style="text-align:left;">
320
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
71.5
</td>
<td style="text-align:right;">
2.05
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
66.8
</td>
<td style="text-align:right;">
76.1
</td>
</tr>
</tbody>
</table>
<p><br> <br></p>
<table>
<caption><span id="tab:ixnTable">Table 1.16: </span> Estimated marginal and cell means for the irrigation by nitrogen factorial experiment. Nitrogen levels are in lb/ac, estimated mean yields are in bu/ac.</caption>
<thead>
<tr class="header">
<th align="right"></th>
<th align="center">Irrigation levels</th>
<th align="center"></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">**N levels*</td>
<td align="center"><strong>1 Irrigation</strong></td>
<td align="center"><strong>2 Irrigations</strong></td>
<td><strong>N means</strong></td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="center">35.4</td>
<td align="center">39.5</td>
<td>37.4</td>
</tr>
<tr class="odd">
<td align="right">80</td>
<td align="center">49.3</td>
<td align="center">57.3</td>
<td>53.3</td>
</tr>
<tr class="even">
<td align="right">160</td>
<td align="center">58.7</td>
<td align="center">67.6</td>
<td>63.2</td>
</tr>
<tr class="odd">
<td align="right">240</td>
<td align="center">58.4</td>
<td align="center">73.2</td>
<td>65.8</td>
</tr>
<tr class="even">
<td align="right">320</td>
<td align="center">53.6</td>
<td align="center">71.5</td>
<td>62.5</td>
</tr>
<tr class="odd">
<td align="right"><strong>Irrig. means</strong></td>
<td align="center">51.1</td>
<td align="center">61.8</td>
<td></td>
</tr>
</tbody>
</table>
<p><br></p>
<p>High precision, reflected in narrow confidence intervals and small LSD’s are desirable because it means we have more certaint about the results of the experiment. Both the LSD and the width of confidence intervals have a factor that is the product of the critical t and the square root of the MSE divided by the number of observations averaged. Both the LSD and the CI width become smaller due of the joint effects of increased dfe and increased number of observations averaged for the marginal means.</p>
<p><br></p>
<p><span class="math display">\[LSD = t_{dfe, \alpha} \ \sqrt{\frac{2 \ MSE}{n_{obs}}}\]</span></p>
<p><br></p>
<p><span class="math display">\[CI_{width} = 2 \ t_{dfe, \alpha}\sqrt{\frac{MSE}{n_{obs}}}\]</span></p>
<p><br></p>
<p>A second and perhaps more important advantage of the factorial approach is that it reveals the potential interaction between factors. If there is an interaction, the effect of one factor depends on the level of the other factor. In the case of nitrogen and irrigation, there is a typical <em>positive interaction</em>, for example, because the effect of adding an extra 80 lb N/ac, from 160 to 240 lb N/ac, is greater with two than with a single irrigation (Figure <a href="#fig:ixnFig">1.11</a>). The value of the difference in effects can be calculated using a linear combination of treatment averages that is also a contrast:</p>
<p><br></p>
<span class="math display">\[(\hat{\mu}_{240,2} - \hat{\mu}_{160,2}) - (\hat{\mu}_{240,1} - \hat{\mu}_{160,1}) = \]</span>
<div style="text-align: center">
73.2 - 67.6 - (58.4 - 58.7) = 5.9
</div>
<p><br></p>
<div class="figure"><span id="fig:ixnFig"></span>
<img src="12.0_TrtStructure_files/figure-html/ixnFig-1.png" alt="Effects of nitrogen fertilization and irrigation on wheat yield. Vertical error bars are confidence intervals." width="672" />
<p class="caption">
Figure 1.11: Effects of nitrogen fertilization and irrigation on wheat yield. Vertical error bars are confidence intervals.
</p>
</div>
</div>
</div>
</div>
<div id="Contrasts" class="section level2">
<h2><span class="header-section-number">1.4</span> Contrasts</h2>
<p>The Lomu Brho experiment (Figure <a href="#fig:LomuBrhoTrtFig">1.7</a>) was done because we wanted to answer specfic questions about how plants compete with each other. Based on previous observations, it looked like Lomu was a stronger competitor than Brho. This should result in an asymmetry of the interaction between species. First, we wanted to check that competition within 10 cm of a plant did have an impact on plant size, so a “control” treatment where plants were grown without competitors was included. We also wanted to test the hypothesis that intraspecific competition was greater in Lomu than in Brho, and that having half of the surrounding plants being of the other species (“2.Both” level of comptetitor) was sufficient for Lomu to experience reduced and Brho to experience increased competition relative to having only conspecifics. If indeed Brho is the weaker competitor, then Brho-1.Self should be larger than Brho-2.Both, and Lomu-1.Self should be smaller than Lomu-2.Both. These questions translate directly in contrasts that are special linear combinations of treatment means.</p>
<p>Recall that a linear combination of means (“ingredients”) is like a recipe: each ingredient is multiplied by a known constant (coefficient) and added together. Contrasts are linear combinations of parameters in which the sum of the coefficients is zero.</p>
<p><span class="math display">\[Linear \ combination \ of \ estimated \ means = \sum_{i=1}^k c_i \ \hat{\mu}_{i} \\[20pt]
\text{where } c_i \text{ are known constants}\]</span></p>
<div class="mydef">
<ul>
<li>
A contrast is a linear combination of estimated parameters whose coefficients add up to zero.
</li>
<li>
Two contrasts, <span class="math inline"><span class="math inline">\(C_1\)</span></span> and <span class="math inline"><span class="math inline">\(C_2\)</span></span>, are orthogonal if the sum of the products of corresponding coefficients equals zero.
</li>
</ul>
</div>
<p><span class="math display">\[Contrast \ C \ = \sum_{i=1}^k c_i \ \hat{\mu}_{i} \\[20pt]
\text{where } c_i \text{ are known constants and }\sum_{i=1}^k c_i = 0\]</span></p>
<p><br></p>
<span class="math display" id="eq:orthoContr">\[\begin{equation}
C_1 = \sum_{i=1}^kc_{1i}\hat{\mu}_{i} \ \text{ and } \ C_2 = \sum_{i=1}^k c_{2i}\hat{\mu}_{i} \ \text{ are orthogonal if }\\[20pt]
\sum_{i=1}^kc_{1i}c_{2i} = 0
\tag{1.9}
\end{equation}\]</span>
<p><br></p>
<ul>
<li><p>Contrasts are useful to test hypotheses because they have an expected value of 0 if the corresponding null hypothesis is true. Therefore, a contrast whose value is significantly diferent from zero leads to rejection of the null nypothesis.</p></li>
<li><p>Each contrast has an associated sum of squares and one degree of freedom.</p></li>
<li><p>Sums of squares of treatments, factors and interactions can be partitioned into as many orthogonal contrasts as their degrees of freedom.</p></li>
<li><p>If the null hypothesis that the contrast of true parameter values is zero is true, the mean square of a contrast has an F distribution with 1 degree of freedom in the numerator and dfe degrees of freedom in the denominator.</p></li>
<li><p>If the null hypothesis that the contrast of true parameter values is zero is true, the quotient of the estimated contrast and its standard error has a t distribution with dfe degrees of freedom.</p></li>
</ul>
<div class="stattip">
<ul>
<li>
All testable hypothesis can be expressed as linear combinations of estimated parameters.
</li>
</ul>
</div>
<p>Contrasts can be classified as <strong>Class comparisons</strong> or <strong>Trends</strong>.</p>
<ul>
<li><p><strong>Class comparisons</strong> are comparisons among treatments that have categorical factor levels. For example, the competition experiment involved class comparisons.</p></li>
<li><p><strong>Trends</strong> are comparisons among treatments that have quantitative levels. For example, in the irrigation by nitrogen experiment we can determine if the shape of the response to N was linear, quadratic, etc.</p></li>
</ul>
<p><br></p>
<p><strong>Class Comparisons</strong></p>
<p>Treatments can have structures other than factorials. A pair of typical classes of treatment is what is called “control” and “placebo.” The control usually is a “treatment” for which experimental units receive no manipulation at all, whereas the placebo receives the same manipulation required to deliver an active principle, treatment of medicine, without actually including the compound or procedure that is being tested. This “controls” for the potential effects of the procedure that are not caused by the compound or procedure of interest. The use of placebos in medical experimentation is well established and it is generally understood. Patients can respond not only to the chemical compound in a medications but also to the idea of being cared for and to the process of ingesting a pill that might help them.</p>
<p>In agricultural sciences, controls are also necessary in some experiments. In order to study the effect of a dietary additive on animal production, we would want to have a control treatment that adds the same amount of energy and nutrients, but without the specific chemical compounds whose effect we want to test. To test the effect of a chemical in a pesticide application, a control treatment should involve the application of water and other additives as in the main treatment, but without the active principle to be tested.</p>
<p>One interesting example of necessary control is in the study of conditioned flavor aversions in animals. To test if sheep can be conditioned to avoid eating grape leaves to use them to graze between rows in vineyards, we dosed sheep with lithium chloride (Laca, unpublished work), which causes digestive discomfort. Sheep were given grape leaves and then dosed with LiCl delivered directly to the rumen with a tube. To determine if the LiCL was the cause of the aversion instead of the intubation procedure used to deliver it, we had a treatment in which sheep were intubated and given an equivalent amount of tapwater without LiCl.</p>
<div class="stattip">
<p>
The design of proper controls is an art beyond statistics. It involves concepts and interpretations that can be highly creative. Correct experimentation and interpretation of results requires much more than formally correct statistical methods.
</p>
</div>
<p>In addition to controls and placebos, treatments may have natural classes that can be compared as such. For example, we may want to test the effects of several methods to control weeds on crop yield (fictitious example). We are not interested in isolating the effect of the chemicals’ active principles, because those are already knonw to exist. The seven treatments are:</p>
<ul>
<li>Control: Undisturbed control</li>
<li>chemA: Spraying chemical A</li>
<li>chemB: Spraying chemical B</li>
<li>Flame: Flaming</li>
<li>Steam: Covered steaming</li>
<li>Hoe: Rotary hoe</li>
<li>Blast: Abrassive blasting</li>
</ul>
<p>The effects of the chemical sprays can be determined with the following contrasts:</p>
<ul>
<li>Effect of spraying chemical A: chemA - Control</li>
<li>Effect of spraying chemical B: chemB - Control</li>
<li>Difference between effects of spraying A or B = (chemA - Control) - (chemB - Control) = chemA - chemB</li>
</ul>
<p>Weed control methods tested can also be seen as being in two <strong>classes</strong>: chemical and non-chemical. Furthermore, non-chemical treatments can be classified as thermal or non-thermal. These classes offer a natural (but not unique) way to design contrasts. The difference between chemical and non-chemical treatments is calculated as the following contrast:</p>
<ul>
<li>Difference between chemical and non-chemical treatments = 2 (chemA + chemB) - (Flame + Steam + Hoe + Blast)</li>
</ul>
<p>If we are interested in the difference between thermal and non-termal treatments, we can use the following contrast:</p>
<ul>
<li>Difference between thermal and non-thermal methods = (Flame + Steam) - (Hoe + Blast)</li>
</ul>
<p>Finally, we want to test if Flame method is different from Blast<a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a></p>
<p>However, these comparisons (contrasts) may not be all orthogonal to each other.</p>
<p>In order to check for orthogonality we need to specify all coefficients for all treatment averages, including the coefficients that are zero. Coefficients for treatment averages are organized in a vector with 7 columns to make a table of coefficients with 6 rows (contrasts) and 7 columns, one for each treatment mean. For the tests of hypotheses, the corresponding contrast is calculated by multiplying the row of the table times the vector of treatment averages:</p>
<p><br></p>
<span class="math display">\[\begin{equation}
\text{Vector with 7 columns, one for each estimated treatment mean} \\[10pt]
\hat{\vec{\mu}} = (\hat{\mu}_{Control}, \ \hat{\mu}_{chemA}, \ \hat{\mu}_{chemB}, \ \hat{\mu}_{Flame}, \ \hat{\mu}_{Steam}, \ \hat{\mu}_{Hoe}, \ \hat{\mu}_{Blast}) \\[20pt] \\
\text{Vector of contrast coefficients to estimate} \\
\text{the effect of chemical A relative to the control} \\[10pt]
\vec{c}_{chemA} = (-1, \ 1, \ 0, \ 0, \ 0, \ 0, \ 0) \\[20pt] \\
\text{Contrast chemA is obtained by summing the products of each} \\
\text{coefficient with the corresponding estimated mean: }\\[10pt]
chemA = \vec{c}_{chemA} . \hat{\vec{\mu}} = \\[10pt]
= -1 \ \hat{\mu}_{Control} + 1 \ \hat{\mu}_{chemA} + 0 \ \hat{\mu}_{chemB} + 0 \ \hat{\mu}_{Flame} + 0 \ \hat{\mu}_{Steam} + 0 \ \hat{\mu}_{Hoe} + 0 \ \hat{\mu}_{Blast} \\[10pt]
= \hat{\mu}_{chemA} - \hat{\mu}_{Control}\\[20pt]
\text{Vector of contrast coefficients to estimate} \\
\text{the effect of chemical B relative to the control} \\[10pt]
\vec{c}_{chemB} = (-1, \ 0, \ 1, \ 0, \ 0, \ 0, \ 0) \\[20pt] \\
\vec{c}_{chemA} \text{ and } \vec{c}_{chemB} \text{ are not orthogonal because } \ \vec{c}_{chemA} . \vec{c}_{chemB} = 1 \ne 0
\end{equation}\]</span>
<p><br></p>
<p>In the following R chunk we us R functions to facilitate the calculations and determine which pairs of contrasts are orthogonal and wich ones are not. First we create a vector of coefficients for each contrast and give it a name that helps us remember what it is. Then, the vectors are joined into a matrix using <code>rbind</code> and the columns are given names that indicate the average that is multiplied by each coefficient. A few pairs are tested individually and finally the matrix is used to calculate the sum of products for all possible pairs at once.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Name the estimated treatment means</span>
avg.names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, <span class="st">&quot;chemA&quot;</span>, <span class="st">&quot;chemB&quot;</span>, <span class="st">&quot;Flame&quot;</span>, <span class="st">&quot;Steam&quot;</span>, <span class="st">&quot;Hoe&quot;</span>, <span class="st">&quot;Blast&quot;</span>)

chemAC &lt;-<span class="st">     </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>)
chemBC &lt;-<span class="st">     </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>,  <span class="dv">1</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>)
chemAB &lt;-<span class="st">     </span><span class="kw">c</span>( <span class="dv">0</span>, <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>)
ch.nch &lt;-<span class="st">     </span><span class="kw">c</span>( <span class="dv">0</span>, <span class="dv">2</span>,  <span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>)
th.nth &lt;-<span class="st">     </span><span class="kw">c</span>( <span class="dv">0</span>, <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>,  <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>)
FlameBlast &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="dv">0</span>, <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">1</span>,  <span class="dv">0</span>,  <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>)

contr.mat &lt;-<span class="st"> </span><span class="kw">rbind</span>(chemAC, 
                   chemBC, 
                   chemAB, 
                   ch.nch, 
                   th.nth,
                   FlameBlast)

<span class="kw">colnames</span>(contr.mat) &lt;-<span class="st"> </span>avg.names

<span class="co"># Are chemA and chemB orthogonal? NO</span>
<span class="kw">sum</span>(chemAC <span class="op">*</span><span class="st"> </span>chemBC)</code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Are chemA and chemAB orthogonal? NO</span>
<span class="kw">sum</span>(chemBC <span class="op">*</span><span class="st"> </span>chemAB)</code></pre></div>
<pre><code>## [1] -1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Are A and ch.nch orthogonal? NO</span>
<span class="kw">sum</span>(chemAC <span class="op">*</span><span class="st"> </span>ch.nch)</code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Are A and th.nth orthogonal? YES</span>
<span class="kw">sum</span>(chemAC <span class="op">*</span><span class="st"> </span>th.nth)</code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># A table of all possible pairs is easily constructed by using matrix multiplication:</span>
orth.mat &lt;-<span class="st"> </span>contr.mat <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(contr.mat)</code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:OrthoContr1">Table 1.17: </span>Top: Coefficients for each treatment average (columns) for each of seven contrasts (rows) comparing weed control methods (chemA is effect of chemical A, chemB is effect of chemical BA, chemAB is their difference, ch.nch is chemical vs. non-chemical, th.nth is thermal vs. non-thermal, and FlameBlast is the difference between flaming and abrasive blasting. The coefficients in this table are created to reflect specific null hyotheses. Bottom: sum of products of corresponding coefficients for all pairs of contrasts (row in the left table). This is a symmetric matrix (the lower left triangle below the diagonal is the same as the upper right) because A is orthogonal to B if, and only if, B is orthogonal to A.
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Control
</th>
<th style="text-align:right;">
chemA
</th>
<th style="text-align:right;">
chemB
</th>
<th style="text-align:right;">
Flame
</th>
<th style="text-align:right;">
Steam
</th>
<th style="text-align:right;">
Hoe
</th>
<th style="text-align:right;">
Blast
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
chemAC
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
chemBC
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
chemAB
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ch.nch
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
-1
</td>
</tr>
<tr>
<td style="text-align:left;">
th.nth
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-1
</td>
</tr>
<tr>
<td style="text-align:left;">
FlameBlast
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-1
</td>
</tr>
</tbody>
</table>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
chemAC
</th>
<th style="text-align:right;">
chemBC
</th>
<th style="text-align:right;">
chemAB
</th>
<th style="text-align:right;">
ch.nch
</th>
<th style="text-align:right;">
th.nth
</th>
<th style="text-align:right;">
FlameBlast
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
chemAC
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
chemBC
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
chemAB
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
ch.nch
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
th.nth
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
FlameBlast
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Table <a href="#tab:OrthoContr1">1.17</a> shows that 6 out of the 15 pairs of contrasts are not orthogonal. For example, the number 2 in row 1 (chemA) and column 4 (ch.nch) of the table in the right results from the sum of the products of coefficients in rows 1 and 4 of the table on the left:</p>
<p><br></p>
<span class="math display">\[\begin{aligned}
2 = (-1)&amp;\times0 \\
+ 1 &amp;\times 2 \\
+ 0 &amp;\times 2 \\
+ 0 &amp;\times (-1) \\
+ 0 &amp;\times (-1) \\
+ 0 &amp;\times (-1) \\
+ 0 &amp;\times (-1) \\
= \vec{c}_{chemA} &amp;. \vec{c}_{ch.nch}
\end{aligned}\]</span>
<p><br></p>
<p>Although not mandatory, orthogonal contrasts are generally considered desirable particularly if they are posed before the data are collected. These so-called <strong>a priori</strong> sets of hypothesis are independent form each other and account for all the variation due to experimental treatments. Because they are <em>a priori</em>, it is accepted that no corerctions are needed to account for inflation of experimentwise error rate.</p>
<p>A complete set of orthogonal contrasts for the weed control example can be created as follows by taking a class-comparisons approach. The set has to have 6 contrasts because there are 7 treatments, and there is one orthogonal contrast per degree of freedom. This is not the only set of orthogonal contrasts possible; in fact there are 15 different possible sets of orthogonal contrasts for 7 treatment levels. The number of sets gets large very quickly as the <a href="http://www.southampton.ac.uk/~cpd/anovas/datasets/Contrast%20sets.htm" target="_blank">number of levels</a> increases.</p>
<p><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">TvsC &lt;-<span class="st">    </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">6</span>,  <span class="dv">1</span>,  <span class="dv">1</span>,  <span class="dv">1</span>,  <span class="dv">1</span>,  <span class="dv">1</span>,  <span class="dv">1</span>) <span class="co"># Average treatment effect.</span>
CvsNC &lt;-<span class="st">   </span><span class="kw">c</span>( <span class="dv">0</span>, <span class="op">-</span><span class="dv">2</span>, <span class="op">-</span><span class="dv">2</span>,  <span class="dv">1</span>,  <span class="dv">1</span>,  <span class="dv">1</span>,  <span class="dv">1</span>) <span class="co"># Chemical vs. non-chemical</span>
AvsB &lt;-<span class="st">    </span><span class="kw">c</span>( <span class="dv">0</span>,  <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>) <span class="co"># Do chemical treatments differ?</span>
THvsNTH &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">1</span>,  <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>) <span class="co"># Thermal vs. non-thermal</span>
CSvsFF &lt;-<span class="st">  </span><span class="kw">c</span>( <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>,  <span class="dv">1</span>,  <span class="dv">0</span>,  <span class="dv">0</span>) <span class="co"># Does Steam differ from Flame?</span>
RHvsAB &lt;-<span class="st">  </span><span class="kw">c</span>( <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>,  <span class="dv">1</span>) <span class="co"># Does Hoe differ from Blast?</span>

Cmat &lt;-<span class="st"> </span><span class="kw">rbind</span>(TvsC, 
              CvsNC, 
              AvsB, 
              THvsNTH, 
              CSvsFF, 
              RHvsAB)

(orth.mat &lt;-<span class="st"> </span>Cmat <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(Cmat)) <span class="co"># All othtogonal!!</span></code></pre></div>
<pre><code>##         TvsC CvsNC AvsB THvsNTH CSvsFF RHvsAB
## TvsC      42     0    0       0      0      0
## CvsNC      0    12    0       0      0      0
## AvsB       0     0    2       0      0      0
## THvsNTH    0     0    0       4      0      0
## CSvsFF     0     0    0       0      2      0
## RHvsAB     0     0    0       0      0      2</code></pre>
<p><br></p>
<p>In the first contrast we compare all treatments against the control. In the second one we compare the chemical vs. non chemical treatments. The rationale behind the contrasts is that we compare the average of one class vs. the averge of another class. Although not strictly necessary, the coefficients are mltiplied by the largest denominator to make them all integers. For example, the average of chemical treatments is <span class="math display">\[\frac{1}{2}\hat{\mu}_{chemA} + \frac{1}{2}\hat{\mu}_{chemB}\]</span> and the average of non-chemical treatments is <span class="math display">\[\frac{1}{4}\hat{\mu}_{Flame} + \frac{1}{4}\hat{\mu}_{Steam} + \frac{1}{4}\hat{\mu}_{Hoe} + \frac{1}{4}\hat{\mu}_{Blast}\]</span> so we multiply all coefficients times 4 to obtain the set of integers that make the contrast coefficients.</p>
<p>Now that we have a meaningful set of orthogonal contrasts we can proceed with data analysis. Because contrasts are a priori, no correction for multiple comparisons will be applied.</p>
<p><strong>Caution:</strong> - Some authors recommend applying corrections, even if comparisons were posed <em>a priori</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Give treatments the same order used in the text:</span>
weed.ctl.dat<span class="op">$</span>trt &lt;-<span class="st"> </span><span class="kw">factor</span>(weed.ctl.dat<span class="op">$</span>trt, 
                           <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, 
                                      <span class="st">&quot;chemA&quot;</span>, 
                                      <span class="st">&quot;chemB&quot;</span>, 
                                      <span class="st">&quot;Flame&quot;</span>, 
                                      <span class="st">&quot;Steam&quot;</span>, 
                                      <span class="st">&quot;Hoe&quot;</span>, 
                                      <span class="st">&quot;Blast&quot;</span>))

<span class="co"># Create a column for treatments with defined contrasts.</span>
weed.ctl.dat<span class="op">$</span>Ctrt &lt;-<span class="st"> </span>weed.ctl.dat<span class="op">$</span>trt

<span class="co"># Assign contrast structure to treatments.</span>
<span class="co"># Cmat has to be transposed because R takes the contrasts as columns.</span>
<span class="kw">contrasts</span>(weed.ctl.dat<span class="op">$</span>Ctrt) &lt;-<span class="st"> </span><span class="kw">t</span>(Cmat)

<span class="co"># Second, run the model with orthogonal contrasts.</span>
wc.m2 &lt;-<span class="st"> </span><span class="kw">lm</span>(weed.mass <span class="op">~</span><span class="st"> </span>Ctrt, <span class="dt">data =</span> weed.ctl.dat)

<span class="co"># The summary of an lm model gives us the t-tests for the contrasts.</span>
<span class="co"># Where Ho is that the contrast equals zero.</span>
<span class="kw">summary</span>(wc.m2)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weed.mass ~ Ctrt, data = weed.ctl.dat)
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -318.48372  -99.72823   44.47685  104.27446  226.27340 
## 
## Coefficients:
##               Estimate Std. Error  t value   Pr(&gt;|t|)    
## (Intercept) 1470.05059   28.64963 51.31133 &lt; 2.22e-16 ***
## CtrtTvsC    -106.47088   11.69616 -9.10306 7.3447e-10 ***
## CtrtCvsNC     73.31724   21.88152  3.35065 0.00231915 ** 
## CtrtAvsB     213.67098   53.59855  3.98651 0.00043568 ***
## CtrtTHvsNTH  157.43191   37.89990  4.15389 0.00027778 ***
## CtrtCSvsFF   -42.39589   53.59855 -0.79099 0.43559938    
## CtrtRHvsAB    33.80725   53.59855  0.63075 0.53331950    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 169.4935 on 28 degrees of freedom
## Multiple R-squared:  0.820815,   Adjusted R-squared:  0.7824182 
## F-statistic: 21.37718 on 6 and 28 DF,  p-value: 2.927676e-09</code></pre>
<p>When we run an <code>lm</code> it uses the contrasts specified for the treatment column, assuming that the contrast coefficients were given in the order of the levels of the factor column. The contrasts of the contrast matrix had names, and the program is able to read those and prints the tests with the corresponding names. The output of <code>summary(wc.m2)</code> shows the model call at the top, followed by summary statistics for the residuals. By definition, the average of residuals is zero. The median is greater than zero, indicating a bit of skewness. Under the heading <code>coefficients</code> we find a list of contrasts, their estimated value, standard error and calculated t (<code>t value</code>) with the corresponding probabilities for two-tailed tests; <code>t value = Estimate / Std. Error</code>. The estimated value of each contrast is simply the sum of the products of each mean and the corresponding contrast coefficient, for example,</p>
<p><span class="math inline">\(AvsB = -1 \ \hat{\mu}_{Control} + 1 \ \hat{\mu}_{chemA} + 0 \ \hat{\mu}_{chemB} + 0 \ \hat{\mu}_{Flame} + 0 \ \hat{\mu}_{Steam} + 0 \ \hat{\mu}_{Hoe} + 0 \ \hat{\mu}_{Blast} = \hat{\mu}_{chemA} - \hat{\mu}_{Control}\)</span></p>
<p>The first row of effects is an estimate of the overall mean, called <code>(Intercept)</code>, which is calculated based on a linear combination that is not a contrast. This line is usually not relevant for the analyses, as it tests that the overall mean is zero. Below the overall average there are lines for each contrast. On average, treatments reduced weed mass by <code>r round(summary(wc.m2)$coefficients[2, 1], 1)</code> kg/ha, a value that was significantly different from 0. Non-chemical methods were slightly but significantly worse than chemical ones because the had <code>r round(summary(wc.m2)$coefficients[3, 1], 1)</code> kg/ha more of weed mass. Interpretation of the rest of the contrasts is left as an exercise. Keep in mind that the sign of the estimated contrast and its meaning depends on which class was given the negative coefficients, which is arbitrary (i.e., we can choose).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The summary of the analysis of variance shows the</span>
<span class="co"># complete partition of total SS into contrasts.</span>

(wc.aov.tbl &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">aov</span>(weed.mass <span class="op">~</span><span class="st"> </span>Ctrt, <span class="dt">data =</span> weed.ctl.dat), 
        <span class="dt">split =</span> <span class="kw">list</span>(<span class="dt">Ctrt =</span> <span class="kw">list</span>(<span class="st">&quot;TvsC&quot;</span> =<span class="st"> </span><span class="dv">1</span>, 
                                <span class="st">&quot;CvsNC&quot;</span> =<span class="st"> </span><span class="dv">2</span>, 
                                <span class="st">&quot;AvsB&quot;</span> =<span class="st"> </span><span class="dv">3</span>, 
                                <span class="st">&quot;THvsNTH&quot;</span> =<span class="st"> </span><span class="dv">4</span>, 
                                <span class="st">&quot;CSvsFF&quot;</span> =<span class="st"> </span><span class="dv">5</span>, 
                                <span class="st">&quot;RHvsAB&quot;</span> =<span class="st"> </span><span class="dv">6</span>))))</code></pre></div>
<pre><code>##                 Df  Sum Sq   Mean Sq  F value     Pr(&gt;F)    
## Ctrt             6 3684748  614124.6 21.37718 2.9277e-09 ***
##   Ctrt: TvsC     1 2380570 2380570.3 82.86572 7.3447e-10 ***
##   Ctrt: CvsNC    1  322525  322525.0 11.22683 0.00231915 ** 
##   Ctrt: AvsB     1  456553  456552.9 15.89224 0.00043568 ***
##   Ctrt: THvsNTH  1  495696  495696.1 17.25478 0.00027778 ***
##   Ctrt: CSvsFF   1   17974   17974.1  0.62566 0.43559938    
##   Ctrt: RHvsAB   1   11429   11429.3  0.39784 0.53331950    
## Residuals       28  804385   28728.0                        
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(wc.aov.tbl[[<span class="dv">1</span>]], 
      <span class="dt">caption =</span> <span class="st">&quot;Partition of SS into contrasts for weed control example. Meaning of contrasts are defined in R object Cmat above.&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">full_width =</span> <span class="ot">FALSE</span>)</code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:OrthoContr4">Table 1.18: </span>Partition of SS into contrasts for weed control example. Meaning of contrasts are defined in R object Cmat above.
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Df
</th>
<th style="text-align:right;">
Sum Sq
</th>
<th style="text-align:right;">
Mean Sq
</th>
<th style="text-align:right;">
F value
</th>
<th style="text-align:right;">
Pr(&gt;F)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Ctrt
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3684747.77831
</td>
<td style="text-align:right;">
614124.62972
</td>
<td style="text-align:right;">
21.3771799647
</td>
<td style="text-align:right;">
0.0000000029
</td>
</tr>
<tr>
<td style="text-align:left;">
Ctrt: TvsC
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2380570.33975
</td>
<td style="text-align:right;">
2380570.33975
</td>
<td style="text-align:right;">
82.8657215630
</td>
<td style="text-align:right;">
0.0000000007
</td>
</tr>
<tr>
<td style="text-align:left;">
Ctrt: CvsNC
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
322525.03346
</td>
<td style="text-align:right;">
322525.03346
</td>
<td style="text-align:right;">
11.2268346681
</td>
<td style="text-align:right;">
0.0023191459
</td>
</tr>
<tr>
<td style="text-align:left;">
Ctrt: AvsB
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
456552.88868
</td>
<td style="text-align:right;">
456552.88868
</td>
<td style="text-align:right;">
15.8922355373
</td>
<td style="text-align:right;">
0.0004356827
</td>
</tr>
<tr>
<td style="text-align:left;">
Ctrt: THvsNTH
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
495696.10324
</td>
<td style="text-align:right;">
495696.10324
</td>
<td style="text-align:right;">
17.2547790692
</td>
<td style="text-align:right;">
0.0002777760
</td>
</tr>
<tr>
<td style="text-align:left;">
Ctrt: CSvsFF
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
17974.11409
</td>
<td style="text-align:right;">
17974.11409
</td>
<td style="text-align:right;">
0.6256643245
</td>
<td style="text-align:right;">
0.4355993825
</td>
</tr>
<tr>
<td style="text-align:left;">
Ctrt: RHvsAB
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
11429.29909
</td>
<td style="text-align:right;">
11429.29909
</td>
<td style="text-align:right;">
0.3978446258
</td>
<td style="text-align:right;">
0.5333194985
</td>
</tr>
<tr>
<td style="text-align:left;">
Residuals
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
804385.31465
</td>
<td style="text-align:right;">
28728.04695
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Show treatment means and confidence intervals.</span>
<span class="kw">emmeans</span>(wc.m2, <span class="st">&quot;Ctrt&quot;</span>)</code></pre></div>
<pre><code>##  Ctrt         emmean          SE df     lower.CL    upper.CL
##  Control 2108.875898 75.79979809 28 1953.6070505 2264.144746
##  chemA   1430.616216 75.79979809 28 1275.3473683 1585.885064
##  chemB   1003.274251 75.79979809 28  848.0054028 1158.543098
##  Flame   1636.724739 75.79979809 28 1481.4558917 1791.993587
##  Steam   1551.932961 75.79979809 28 1396.6641136 1707.201809
##  Hoe     1245.657791 75.79979809 28 1090.3889434 1400.926639
##  Blast   1313.272284 75.79979809 28 1158.0034362 1468.541132
## 
## Confidence level used: 0.95</code></pre>
<p>Each contrast has <strong>1 df</strong> and an associated <strong>SS contrast</strong>. The SS associated with each contrast in Table <a href="#tab:OrthoContr4">1.18</a> is calculated as follows:</p>
<p><br></p>
<p><span class="math display" id="eq:SScontr">\[\begin{aligned}
&amp;\text{let } C_h \text{ be a row of coefficients for contrast } h \\[15pt]
&amp;\text{and } \mathbf{C} = \begin{Bmatrix}c_{hi}\end{Bmatrix} \text{be a }(k-1) \times k \text{ matrix of orthogonal contrasts} \\[15pt]
&amp;\text{for a set of k treatments in a balanced experiment with r replicates;} \\[15pt]
&amp;\text{the sum of squares associated with each row of } \mathbf{C} \text{ is: } \\[15pt]
&amp;SSC_h = \frac{r \sum_{i=1}^k \left( c_{hi}\bar{Y}_{i.} \right)^2 }{\sum_{i=1}^kc_{hi}^2}
\tag{1.10}
\end{aligned}\]</span></p>
<p><br></p>
<p>Let’s calculate the SSC for the first two contrasts in the weed control experiment “by hand” using basic R functions. Note that <span class="math inline">\(\mathbf{C}\)</span> in Equation <a href="#eq:SScontr">(1.10)</a> is the matrix called <code>Cmat</code> in the previous code. Recall that the first set of contrast coefficients, which is the first row of <code>Cmat</code>, is called <code>TvsC</code> and compares all weed control methods against the undisturbed control.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Make a vector with the estimated means for each treatment in the weed control experiment.</span>
<span class="co"># We extract them from the estimated marginal means to avoid problems if the</span>
<span class="co"># experiment were unbalanced.</span>
mu.hat &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">emmeans</span>(wc.m2, <span class="st">&quot;Ctrt&quot;</span>))<span class="op">$</span>emmean

<span class="kw">names</span>(mu.hat) &lt;-<span class="st"> </span><span class="kw">summary</span>(<span class="kw">emmeans</span>(wc.m2, <span class="st">&quot;Ctrt&quot;</span>))<span class="op">$</span>Ctrt

<span class="kw">cbind</span>(<span class="kw">names</span>(mu.hat), mu.hat)</code></pre></div>
<pre><code>##                   mu.hat            
## Control &quot;Control&quot; &quot;2108.87589826802&quot;
## chemA   &quot;chemA&quot;   &quot;1430.61621605275&quot;
## chemB   &quot;chemB&quot;   &quot;1003.27425055837&quot;
## Flame   &quot;Flame&quot;   &quot;1636.72473944646&quot;
## Steam   &quot;Steam&quot;   &quot;1551.9329613307&quot; 
## Hoe     &quot;Hoe&quot;     &quot;1245.65779113132&quot;
## Blast   &quot;Blast&quot;   &quot;1313.27228392747&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># In this balanced case, aggregate also works:</span>
<span class="kw">aggregate</span>(weed.mass <span class="op">~</span><span class="st"> </span>Ctrt, <span class="dt">data =</span> weed.ctl.dat, <span class="dt">FUN =</span> mean)</code></pre></div>
<pre><code>##      Ctrt   weed.mass
## 1 Control 2108.875898
## 2   chemA 1430.616216
## 3   chemB 1003.274251
## 4   Flame 1636.724739
## 5   Steam 1551.932961
## 6     Hoe 1245.657791
## 7   Blast 1313.272284</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">r &lt;-<span class="st"> </span><span class="kw">max</span>(weed.ctl.dat<span class="op">$</span>rep)

(SS.TvsC &lt;-<span class="st"> </span>r <span class="op">*</span><span class="st"> </span>(<span class="kw">sum</span>(TvsC <span class="op">*</span><span class="st"> </span>mu.hat)) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(TvsC <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))</code></pre></div>
<pre><code>## [1] 2380570.34</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># If we use a small number of digits in the &#39;hand&#39; calculations </span>
<span class="co"># we obtain a similar result, but not exactly the same due to rounding.</span>
<span class="co"># Let this be a warning for the corroboration of formula results</span>
<span class="co"># by actually typing in rounded numbers. (It does not always work!)</span>

<span class="dv">5</span> <span class="op">*</span><span class="st"> </span>((<span class="op">-</span><span class="dv">6</span>) <span class="op">*</span><span class="st"> </span><span class="fl">2108.876</span> <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="fl">1430.616</span> <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="fl">1003.274</span> <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="fl">1636.725</span> <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="fl">1551.933</span> <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="fl">1245.658</span> <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="fl">1313.272</span> ) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>
<span class="st">   </span>((<span class="op">-</span><span class="dv">6</span>) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>
<span class="st">       </span><span class="dv">1</span> <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>
<span class="st">       </span><span class="dv">1</span> <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>
<span class="st">       </span><span class="dv">1</span> <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>
<span class="st">       </span><span class="dv">1</span> <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>
<span class="st">       </span><span class="dv">1</span> <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>
<span class="st">       </span><span class="dv">1</span> <span class="op">^</span><span class="st"> </span><span class="dv">2</span>) </code></pre></div>
<pre><code>## [1] 2380571.248</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(SS.CvsNC &lt;-<span class="st"> </span>r <span class="op">*</span><span class="st"> </span>(<span class="kw">sum</span>(CvsNC <span class="op">*</span><span class="st"> </span>mu.hat)) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(CvsNC <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))</code></pre></div>
<pre><code>## [1] 322525.0335</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">5</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">*</span><span class="st"> </span><span class="fl">2108.876</span> <span class="op">+</span><span class="st"> </span>
<span class="st">        </span>(<span class="op">-</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span><span class="fl">1430.616</span> <span class="op">+</span><span class="st"> </span>
<span class="st">        </span>(<span class="op">-</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span><span class="fl">1003.274</span> <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="fl">1636.725</span> <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="fl">1551.933</span> <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="fl">1245.658</span> <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="fl">1313.272</span> ) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>
<span class="st">   </span>(<span class="dv">0</span> <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>
<span class="st">       </span>(<span class="op">-</span><span class="dv">2</span>) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>
<span class="st">       </span>(<span class="op">-</span><span class="dv">2</span>) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>
<span class="st">       </span><span class="dv">1</span> <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>
<span class="st">       </span><span class="dv">1</span> <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>
<span class="st">       </span><span class="dv">1</span> <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>
<span class="st">       </span><span class="dv">1</span> <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] 322525.882</code></pre>
<p>Treatment SS (first row in Table <a href="#tab:OrthoContr4">1.18</a>) is the sum of all 6 contrast SS, because we used a complete set of orthogonal contrasts. Residual SS can be calculated by subtracting the treatment average from each observation, squaring and adding all results. MSE is SSE/dfe, where dfe = number of observations minus number of treatments, or we can get it directly from the <code>anova</code> in R using <code>anova(wc.m2)$'Mean Sq'[2]</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(MSE &lt;-<span class="st"> </span><span class="kw">anova</span>(wc.m2)<span class="op">$</span><span class="st">&#39;Mean Sq&#39;</span>[<span class="dv">2</span>])</code></pre></div>
<pre><code>## [1] 28728.04695</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculated F for treatments vs control.</span>
(Fcalc.TvsC &lt;-<span class="st"> </span>SS.TvsC <span class="op">/</span><span class="st"> </span>MSE)</code></pre></div>
<pre><code>## [1] 82.86572156</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df.num &lt;-<span class="st"> </span><span class="dv">1</span>
(df.den &lt;-<span class="st"> </span><span class="kw">length</span>(weed.ctl.dat<span class="op">$</span>weed.mass) <span class="op">-</span><span class="st"> </span><span class="kw">length</span>(<span class="kw">levels</span>(weed.ctl.dat<span class="op">$</span>Ctrt)))</code></pre></div>
<pre><code>## [1] 28</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Probability of obtaining an F this large or larger is Ho is true.</span>
(Prob.TvsC &lt;-<span class="st"> </span><span class="kw">pf</span>(Fcalc.TvsC, 
                 <span class="dt">df1 =</span> df.num, 
                 <span class="dt">df2 =</span> df.den, 
                 <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>))</code></pre></div>
<pre><code>## [1] 7.34473127e-10</code></pre>
<div class="rtip">
<ul>
<li>
Output of analyses in R typically are lists or other structures with components that can be extracted or even modified. Use the <code>str</code> function to see what parts are there and to figure out how to “bring them out.”
</li>
</ul>
</div>
<p><strong>Trends</strong></p>
<p>In the nitrogen by irrigation fertilization experiment (Table <a href="#tab:IxNAnova">1.12</a>) there are 9 df for treatments that are partitioned into 1 df for irrigation, 4 df for nitrogen and 4 df for the irrigation x nitrogen interaction. Thus, the corresponding SS can be partitioned into a total of 9 orthogonal contrasts: 1 for irrigation, 4 for nitrogen and 4 for the interaction. The specific contrasts are not unique, and we can design them to answer specific biological questions. A natural way to partition SS and df in the nitrogen by irrigation factorial is as follows:</p>
<ol style="list-style-type: decimal">
<li>Does one extra irrigation increase wheat yield, averaging across levels of nitrogen?</li>
<li>What is the simplest curve we can use to summarize the effect of nitrogen on wheat yield? Is the reponse linear, quadratic, cubic or quartic?</li>
<li>Does the shape of the response to nitrogen depend on the number of irrigations? How does it differ?</li>
</ol>
<p>Because the levels of nitrogen are quantitative, we can create contrasts that test for the significance of increasingly complex shapes of the relationship between yield and nitrogen. The fact that N levels are equally spaced greatly facilitates the calculations because we can use the following standard formulas for contrast coefficients (Equation <a href="#eq:orthopoly">(1.11)</a>): <br></p>
<span class="math display" id="eq:orthopoly">\[\begin{aligned}
Linear: C_1&amp;=\gamma_1 \left[ \frac{X-\bar{X}}{\Delta}\right] \\[15pt]
Quadratic: C_2 &amp;= \gamma_2 \left[ \left(\frac{X-\bar{X}}{\Delta}\right)^2-\left( \frac{k_f^2-1}{12} \right)\right] \\[15pt]
Cubic: C_3 &amp;= \gamma_3 \left[ \left(\frac{X-\bar{X}}{\Delta}\right)^3- \left(\frac{X-\bar{X}}{\Delta}\right)\left( \frac{3k_f^2-7}{20} \right)\right] \\[15pt]
Quartic: C_4&amp; = \gamma_4 \left[ \left( \frac{X - \bar{X}}{\Delta} \right)^4 - \left( \frac{X - \bar{X}}{\Delta} \right)^2 \left( \frac{3k_f^2 - 13}{14} \right)+ \frac{3 \left(k_f^2 - 1\right) \left(k_f^2 - 9 \right)}{560} \right]
\tag{1.11}
\end{aligned}\]</span>
<p><br></p>
<p>where <span class="math inline">\(X\)</span> are the levels of the quantitative factor, <span class="math inline">\(\bar{X}\)</span> is the average of all factor levels, <span class="math inline">\(\Delta\)</span> is the distance between levels, <span class="math inline">\(k_f\)</span> is the number of levels in the factor and <span class="math inline">\(\gamma_i\)</span> are arbitrary values used to make all contrast coefficients into integers for simplicity. In this section we will use these equations to create a complete set of orthogonal constrasts to test for trends in the irrigation by nitrogen experiment. Then we apply the contrasts and interpret the results.</p>
<p>There are 5 levels of nitrogen in the experiment: 0, 80, 160, 240, 320. The distance between levels is 80, and the average of levels is 160.</p>
<p><br></p>
<ul>
<li>Linear coefficients for N:</li>
</ul>
<span class="math display" id="eq:orthoNL">\[\begin{aligned}
X &amp;= 0\\[15pt]
\bar{X} &amp;= 160\\[15pt]
\Delta &amp;= 80\\[15pt]
c_{L,0} &amp;= \gamma_1 \left[ \frac{0-160}{80}\right] = -2 \gamma_1 \\[15pt]
c_{L,80} &amp;= \gamma_1 \left[ \frac{80-160}{80}\right] = -1 \gamma_1 \\[15pt]
c_{L,160} &amp;= \gamma_1 \left[ \frac{160-160}{80}\right] = 0 \gamma_1 \\[15pt]
c_{L,240} &amp;= \gamma_1 \left[ \frac{240-160}{80}\right] = 1 \gamma_1 \\[15pt]
c_{L,320} &amp;= \gamma_1 \left[ \frac{320-160}{80}\right] = 2 \gamma_1 \\[15pt]
\text{Choose } \gamma_1 &amp;= 1 \\[15pt]
C_L &amp;= (-2, -1, 0, 1, 2)
\tag{1.12}
\end{aligned}\]</span>
<p><br></p>
<ul>
<li>Quadratic coefficients for N:</li>
</ul>
<span class="math display" id="eq:orthoNQ">\[\begin{aligned}
k_f &amp;= 5 \\[15pt] 
\left(\frac{k_f^2-1}{12} \right) &amp;= \left( \frac{5^2-1}{12} \right) = 2 \\[15pt]
c_{Q,0} &amp;= \gamma_2 \left[ \left( \frac{0-160}{80} \right) ^2-2 \right] = 2 \gamma_2 \\[15pt]
c_{Q,80} &amp;= \gamma_2 \left[ \left( \frac{80-160}{80} \right) ^2-2 \right] = -1 \gamma_2 \\[15pt]
c_{Q,160} &amp;= \gamma_2 \left[ \left( \frac{160-160}{80} \right) ^2-2 \right] = -2 \gamma_2 \\[15pt]
c_{Q,240} &amp;= \gamma_2 \left[ \left( \frac{240-160}{80} \right) ^2-2 \right] = -1 \gamma_2 \\[15pt]
c_{Q,320} &amp;= \gamma_2 \left[ \left( \frac{320-160}{80} \right) ^2-2 \right] = 2 \gamma_2 \\[15pt]
\text{Choose } \gamma_2 &amp;= 1 \\[15pt]
C_Q &amp;= (2, -1, -2, -1, 2)
\tag{1.13}
\end{aligned}\]</span>
<p><br></p>
<ul>
<li>Cubic coefficients for N:</li>
</ul>
<span class="math display" id="eq:orthoNC">\[\begin{aligned}
k_f &amp;= 5 \\[15pt] 
\left(\frac{3 \times k_f^2-7}{20} \right) &amp;= \left(\frac{3 \times 5^2-7}{20} \right) = 3.4\\[15pt]
c_{C,0} &amp;= \gamma_3 \left[ \left(\frac{0-160}{80}\right)^3- \left(\frac{0-160}{80}\right) \times  3.4\right] = -1.2 \gamma_3 \\[15pt]
c_{C,80} &amp;= \gamma_3 \left[ \left(\frac{80-160}{80}\right)^3- \left(\frac{80-160}{80}\right) \times  3.4\right] = 2.4 \gamma_3 \\[15pt]
c_{C,160} &amp;= \gamma_3 \left[ \left(\frac{160-160}{80}\right)^3- \left(\frac{160-160}{80}\right) \times  3.4\right] = 0 \gamma_3 \\[15pt]
c_{C,240} &amp;= \gamma_3 \left[ \left(\frac{240-160}{80}\right)^3- \left(\frac{240-160}{80}\right) \times  3.4\right] = -2.4 \gamma_3 \\[15pt]
c_{C,320} &amp;= \gamma_3 \left[ \left(\frac{380-160}{80}\right)^3- \left(\frac{380-160}{80}\right) \times  3.4\right] = 1.2 \gamma_3 \\[15pt]
\text{Choose } \gamma_3 &amp;= 5/6 \\[15pt]
C_C &amp;= (-1, 2, 0, -2, 1)
\tag{1.14}
\end{aligned}\]</span>
<p><br></p>
<ul>
<li>Quartic coefficients for N:</li>
</ul>
<span class="math display" id="eq:orthoNQt">\[\begin{aligned}
k_f &amp;= 5 \\[15pt] 
\left( \frac{3k_f^2 - 13}{14} \right) &amp;= \left( \frac{3 \times 5^2 - 13}{14} \right) = 31/7 \\[15pt]
\frac{3 \left(k_f^2 - 1\right) \left(k_f^2 - 9 \right)}{560} &amp;= \frac{3 \left(5^2 - 1\right) \left(5^2 - 9 \right)}{560} = 72/35\\[15pt]
c_{Qt,0} &amp;= \gamma_4 \left[ \left( \frac{X - 160}{80} \right)^4 - \left( \frac{X - 160}{80} \right)^2 \frac{31}{7} + \frac{72}{35} \right] = \frac{12}{35} \gamma_4 \\[15pt]
c_{Qt,0} &amp;= \gamma_4 \left[ \left( \frac{X - 160}{80} \right)^4 - \left( \frac{X - 160}{80} \right)^2 \frac{31}{7} + \frac{72}{35} \right] = \frac{-48}{35} \gamma_4 \\[15pt]
c_{Qt,0} &amp;= \gamma_4 \left[ \left( \frac{X - 160}{80} \right)^4 - \left( \frac{X - 160}{80} \right)^2 \frac{31}{7} + \frac{72}{35} \right] = \frac{70}{35} \gamma_4 \\[15pt]
c_{Qt,0} &amp;= \gamma_4 \left[ \left( \frac{X - 160}{80} \right)^4 - \left( \frac{X - 160}{80} \right)^2 \frac{31}{7} + \frac{72}{35} \right] = \frac{-48}{35} \gamma_4 \\[15pt]
c_{Qt,0} &amp;= \gamma_4 \left[ \left( \frac{X - 160}{80} \right)^4 - \left( \frac{X - 160}{80} \right)^2 \frac{31}{7} + \frac{72}{35} \right] = \frac{12}{35} \gamma_4 \\[15pt]
\text{Choose } \gamma_4 &amp;= 35/12 \\[15pt]
C_Qt &amp;= (1, -4, 6, -4, 1)
\tag{1.15}
\end{aligned}\]</span>
<p><br></p>
</div>
<div id="LinCombo" class="section level2">
<h2><span class="header-section-number">1.5</span> Linear Combinations</h2>
<p>From a very practical point of view we may also interested in determining if linear combinations of parameters are different from known fixed values. These linear combinations do not have to be contrasts. For example, a producer who needs to choose the level of fertilization of wheat may be interested in the probability that gross income per ac of applying two irrigations and 240 lb N/ac is at least $100 more than the gross income form applying 1 irrigation and 160 lb N/ac, because the difference in costs is $100/ac. The difference in question is a linear combination of wheat yield in the two treatments, where the coefficients are determined by the price of wheat.</p>
<p><span class="math display">\[ I_{ij} \ \text{ is gross income from level i of nitrogen and level j of irrigation}\\[20pt]
p \ \text{ is the price of wheat}\\[20pt]
I_{240,2} = p \ \hat{\mu}_{240,2}\\[20pt]
I_{160,1} = p \ \hat{\mu}_{160,1}\\[20pt]
P((I_{240,2} - I_{160,1}) \ge 100) = P((p \ \hat{\mu}_{240,2} - p \ \hat{\mu}_{160,1}) \ge 100)\\[20pt]
= P((p \ (\hat{\mu}_{240,2} - \ \hat{\mu}_{160,1}) - 100) \ge 0)\]</span></p>
<p>If residuals of ANOVA are normally distributed as is assumed, theory indicates that the linear combination of estimated parameters also has a normal distribution, and the ratio of the linear combination over its standard error has a Student’s t distribution. These facts allow us to use the distribution to calculate the probability sought.</p>
<p><strong>The big picture:</strong> Anova tells you whether there is at least one contrast that is significantly different from zero, but it does not tell what it is. Without the restriction of orthogonality, there is an large number of contrasts that could be tested, so we need to choose crefully. When we do not choose a few contrasts <em>a priori</em> and start calculating comparisons (contrasts) looking for something significant, the probability of at least one Error Type I increases very fast and can reach 100% very quickly, so something needs to be done. One approach is to make orthogonal contrasts <em>before</em> colleting the data, during the planning of the experiment. The restriction of orthogonality will keep the number of constrasts limited to one fewer than the treatment degrees of freedom, and the <em>a priori</em> condition makes it acceptable not to have to correct for multiple comparisons. Another approach is to make a few <em>post-hoc</em> (after seeing the data) contrasts and applying some method to contain the inflation of experimentwise error rate, for example the Protected LSD, Bonferroni’s correction or Tukey’s HSD. In the case of quantitative treatments such as doses, rates, times, age, etc., contrasts can be used to naturally partition the shape of the response into incremental orthogonal components that increase the “wiggliness” of the reponse in an orderly way. Non-significant complexity can be ignored, which simplifies comparisons and explanations.</p>
</div>
<div id="ExSol12" class="section level2">
<h2><span class="header-section-number">1.6</span> Exercises and Solutions</h2>
<p>Use the data below and basic R functions to calculate <code>Estimate</code>, <code>Std. Error</code>, <code>t value</code>, <code>Pr(&gt;|t|)</code>, <code>Sum Sq</code>, <code>Mean Sq</code>, <code>F value</code> and <code>Pr(&gt;F)</code> for the last 3 contrasts in the weed control example (Tables <a href="#tab:OrthoContr4">1.18</a> and <a href="#tab:OrthoExer1">1.19</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">weed.ctl.dat</code></pre></div>
<pre><code>##        trt rep wc.fx   weed.mass    Ctrt
## 1    Blast   1  -100 1292.590817   Blast
## 2    Blast   4  -100 1033.306997   Blast
## 3    Blast   3  -100 1413.875790   Blast
## 4    Blast   2  -100 1421.217694   Blast
## 5    Blast   5  -100 1405.370122   Blast
## 6    chemA   1  -200 1640.896760   chemA
## 7    chemA   4  -200 1572.566873   chemA
## 8    chemA   3  -200 1199.940497   chemA
## 9    chemA   2  -200 1621.172691   chemA
## 10   chemA   5  -200 1118.504260   chemA
## 11   chemB   1  -200  711.372525   chemB
## 12   chemB   4  -200 1047.751096   chemB
## 13   chemB   3  -200 1145.176056   chemB
## 14   chemB   2  -200 1053.694085   chemB
## 15   chemB   5  -200 1058.377490   chemB
## 16 Control   1   600 1790.392174 Control
## 17 Control   4   600 2052.653449 Control
## 18 Control   3   600 2158.150912 Control
## 19 Control   2   600 2313.133287 Control
## 20 Control   5   600 2230.049669 Control
## 21   Flame   1   100 1643.910088   Flame
## 22   Flame   4   100 1515.366131   Flame
## 23   Flame   3   100 1662.122917   Flame
## 24   Flame   2   100 1862.998144   Flame
## 25   Flame   5   100 1499.226417   Flame
## 26     Hoe   1  -300 1309.283161     Hoe
## 27     Hoe   4  -300 1324.548520     Hoe
## 28     Hoe   3  -300 1117.377184     Hoe
## 29     Hoe   2  -300 1272.584375     Hoe
## 30     Hoe   5  -300 1204.495715     Hoe
## 31   Steam   1   100 1403.964871   Steam
## 32   Steam   4   100 1652.322679   Steam
## 33   Steam   3   100 1555.416272   Steam
## 34   Steam   2   100 1473.835118   Steam
## 35   Steam   5   100 1674.125867   Steam</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">summary</span>(wc.m2)<span class="op">$</span>coefficients, <span class="dt">caption =</span> <span class="st">&quot;Summary of t-tests for contrasts in the weed control example with simulated data.&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">full_width =</span> <span class="ot">FALSE</span>)</code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:OrthoExer1">Table 1.19: </span>Summary of t-tests for contrasts in the weed control example with simulated data.
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Std. Error
</th>
<th style="text-align:right;">
t value
</th>
<th style="text-align:right;">
Pr(&gt;|t|)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
1470.05059153
</td>
<td style="text-align:right;">
28.64963074
</td>
<td style="text-align:right;">
51.3113277071
</td>
<td style="text-align:right;">
0.0000000000
</td>
</tr>
<tr>
<td style="text-align:left;">
CtrtTvsC
</td>
<td style="text-align:right;">
-106.47088446
</td>
<td style="text-align:right;">
11.69616277
</td>
<td style="text-align:right;">
-9.1030611095
</td>
<td style="text-align:right;">
0.0000000007
</td>
</tr>
<tr>
<td style="text-align:left;">
CtrtCvsNC
</td>
<td style="text-align:right;">
73.31723688
</td>
<td style="text-align:right;">
21.88151692
</td>
<td style="text-align:right;">
3.3506469029
</td>
<td style="text-align:right;">
0.0023191459
</td>
</tr>
<tr>
<td style="text-align:left;">
CtrtAvsB
</td>
<td style="text-align:right;">
213.67098275
</td>
<td style="text-align:right;">
53.59855124
</td>
<td style="text-align:right;">
3.9865066835
</td>
<td style="text-align:right;">
0.0004356827
</td>
</tr>
<tr>
<td style="text-align:left;">
CtrtTHvsNTH
</td>
<td style="text-align:right;">
157.43190643
</td>
<td style="text-align:right;">
37.89989904
</td>
<td style="text-align:right;">
4.1538872239
</td>
<td style="text-align:right;">
0.0002777760
</td>
</tr>
<tr>
<td style="text-align:left;">
CtrtCSvsFF
</td>
<td style="text-align:right;">
-42.39588906
</td>
<td style="text-align:right;">
53.59855124
</td>
<td style="text-align:right;">
-0.7909894592
</td>
<td style="text-align:right;">
0.4355993825
</td>
</tr>
<tr>
<td style="text-align:left;">
CtrtRHvsAB
</td>
<td style="text-align:right;">
33.80724640
</td>
<td style="text-align:right;">
53.59855124
</td>
<td style="text-align:right;">
0.6307492575
</td>
<td style="text-align:right;">
0.5333194985
</td>
</tr>
</tbody>
</table>
<p>Interpret the results for the last 3 contrasts in the weed control example. Include statements about the efectiveness of treatments in the real world and your certainty about them.</p>
</div>
<div id="Hwk12" class="section level2">
<h2><span class="header-section-number">1.7</span> Homework</h2>
</div>
<div id="laboratory-exercises" class="section level2">
<h2><span class="header-section-number">1.8</span> Laboratory Exercises</h2>
<div id="Lab12PLS" class="section level3">
<h3><span class="header-section-number">1.8.1</span> Plant Sciences</h3>
<p>Prepare an .Rmd document starting with the following text, where you substitute the corresponsing information for author name and date.</p>
<pre><code>---
title: &quot;Lab07 Factorial ANOVA and LSD&quot;
author: &quot;YourFirstName YourLastName&quot;
date: &quot;enter date here&quot;
output: html_document
---</code></pre>
<div id="instructions" class="section level4">
<h4><span class="header-section-number">1.8.1.1</span> Instructions</h4>
<p>The same instructions for completion and submission of work used in previous labs applies here. Refer to previous labs for the details.</p>
<p>For this lab you have to be familiar with the following sections of the textbook:</p>
<p><a href="#chRcbd"><strong>??</strong></a> RCBD without subsamples <a href="#chTrtstr">1</a> Factorial Experiments <a href="#label"><strong>??</strong></a> Fisher’s Protected LSD</p>
<p>In this exercise we analyze the data resulting from an experiment at the UC Davis Plant Sciences research fields. These are based on the <strong>same experiment used in Lab 06</strong>, but now we will consider that seeding and fertilizer are two <strong>factors</strong> that create the set of 6 treatments in a <strong>factorial</strong> treatment structure. We ignore the factor water for simplicity and because it did not cause any effects. The 6 treatments were applied in a <strong>Completely Randomized Block Design</strong> in which each of 6 treatments were applied randomly to 2 plots in each of 3 blocks for a total of 36 experimental units or plots.</p>
<p>Simulated block effects of 0.50, 0.25, and -0.75 were added to logMass observations in blocks 1, 2 and 3 to show block effects. Blocks were defined areas that were more or less homogeneous in soil and plant properties and that were contiguous. We will assume that the variances of the errors or residuals are the same in all treatments. Each observation represents the average mass of seeds produced by 4-5 medusahead plants (logMass). Data were log transformed as <span class="math inline">\(logMass = log(SeedMass + 0.2)\)</span> to achieve normality and equality of variances.</p>
</div>
<div id="part-1.-factorial-anova-using-r-functions-points" class="section level4">
<h4><span class="header-section-number">1.8.1.2</span> Part 1. Factorial ANOVA using R functions [ points]</h4>
<div id="a.-random-assignment-of-treatments-to-plots" class="section level5">
<h5><span class="header-section-number">1.8.1.2.1</span> 1a. Random assignment of treatments to plots</h5>
<p>In a RCBD the treatments are assigned randomly to plots within blocks such that each treatment appears at least once in each block. Because we ignore the water factor, treatments will have 2 replicate plots in each block, one for each original level of the water factor. There are a total of 6 treatments that resulf from the combination each level of the factor “nitrogen” (n and N) with each of the three levels of the factor “seeding” (s, S and E). The treatments are identified by the two letters together. For example. NE is the treatment with addition of nitrogen and at the egde between naturalized annual and seeded native perennial grasses.</p>
<p>First, we pretend that the experiment is about to start and we need to assign treatments to experimental units. The random assignment of treatments to plots within blocks can be done using the ’*‘sample’ R function. To preform the random assignment we start by creating a dataframe with a row for each treatment and a column for each factor. A new column called “Treatment” is created by pasting together the two letters that represent the corresponding level of the factor.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Read and understand the code in this part but do not type or modify anything.</span>
<span class="co"># Create a data frame with all combinations of levels of the 2 factors. First, create treatment names for all 6 treatments. </span>

treat &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(
  <span class="dt">nitro =</span> <span class="kw">c</span>(<span class="st">&quot;n&quot;</span>, <span class="st">&quot;N&quot;</span>), 
  <span class="dt">seeding =</span> <span class="kw">c</span>(<span class="st">&quot;s&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;E&quot;</span>)
  )


<span class="co"># Create a column containing the treatment name in the data frame</span>

treat<span class="op">$</span>Treatment &lt;-<span class="st"> </span><span class="kw">paste</span>(
  treat<span class="op">$</span>nitro, 
  treat<span class="op">$</span>seeding, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>
  )</code></pre></div>
<p>In the second step, plots in each block are labeled with the numbers 1 through 12. We make a character vector with two copies of each treatment label, shuffle the order of treatment with ‘sample’ and column-bind the results with the plot labels. At this point, the objects called ‘block1’, ‘block2’ and ‘block3’ list the plot number and the treatment it should receive.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Number the 12 plots in each block 1 through 12, then shuffle the treatment names and assign to plots of each block.</span>
<span class="co"># The sample() function is used to create a vector that has each treatment randomly assigned to each block twice, because there are two plots for each treatment in each block.</span>

<span class="co"># Plots 1-12 of each block get:</span>

(block1 &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="kw">sample</span>(<span class="kw">c</span>(treat<span class="op">$</span>Treatment, treat<span class="op">$</span>Treatment))))</code></pre></div>
<pre><code>##       [,1] [,2]
##  [1,] &quot;1&quot;  &quot;ns&quot;
##  [2,] &quot;2&quot;  &quot;Ns&quot;
##  [3,] &quot;3&quot;  &quot;ns&quot;
##  [4,] &quot;4&quot;  &quot;NS&quot;
##  [5,] &quot;5&quot;  &quot;NS&quot;
##  [6,] &quot;6&quot;  &quot;nS&quot;
##  [7,] &quot;7&quot;  &quot;Ns&quot;
##  [8,] &quot;8&quot;  &quot;NE&quot;
##  [9,] &quot;9&quot;  &quot;NE&quot;
## [10,] &quot;10&quot; &quot;nE&quot;
## [11,] &quot;11&quot; &quot;nE&quot;
## [12,] &quot;12&quot; &quot;nS&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(block2 &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="kw">sample</span>(<span class="kw">c</span>(treat<span class="op">$</span>Treatment, treat<span class="op">$</span>Treatment))))</code></pre></div>
<pre><code>##       [,1] [,2]
##  [1,] &quot;1&quot;  &quot;NS&quot;
##  [2,] &quot;2&quot;  &quot;nE&quot;
##  [3,] &quot;3&quot;  &quot;NS&quot;
##  [4,] &quot;4&quot;  &quot;nS&quot;
##  [5,] &quot;5&quot;  &quot;NE&quot;
##  [6,] &quot;6&quot;  &quot;nS&quot;
##  [7,] &quot;7&quot;  &quot;nE&quot;
##  [8,] &quot;8&quot;  &quot;ns&quot;
##  [9,] &quot;9&quot;  &quot;Ns&quot;
## [10,] &quot;10&quot; &quot;Ns&quot;
## [11,] &quot;11&quot; &quot;NE&quot;
## [12,] &quot;12&quot; &quot;ns&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(block3 &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="kw">sample</span>(<span class="kw">c</span>(treat<span class="op">$</span>Treatment, treat<span class="op">$</span>Treatment))))</code></pre></div>
<pre><code>##       [,1] [,2]
##  [1,] &quot;1&quot;  &quot;ns&quot;
##  [2,] &quot;2&quot;  &quot;NE&quot;
##  [3,] &quot;3&quot;  &quot;Ns&quot;
##  [4,] &quot;4&quot;  &quot;NS&quot;
##  [5,] &quot;5&quot;  &quot;Ns&quot;
##  [6,] &quot;6&quot;  &quot;nS&quot;
##  [7,] &quot;7&quot;  &quot;NS&quot;
##  [8,] &quot;8&quot;  &quot;ns&quot;
##  [9,] &quot;9&quot;  &quot;nE&quot;
## [10,] &quot;10&quot; &quot;nE&quot;
## [11,] &quot;11&quot; &quot;NE&quot;
## [12,] &quot;12&quot; &quot;nS&quot;</code></pre>
</div>
<div id="b-add-columns-with-factor-levels-to-the-data" class="section level5">
<h5><span class="header-section-number">1.8.1.2.2</span> 1.b Add columns with factor levels to the data</h5>
<p>Treatments were applied, plantts grown and measured. Data were collected and organized, and we enter them below. Because the data have the labels for the original treatments, we need to split the labels into the columns that correspond to nitrogen and seeding treatment. In order to analyze the experiment as a factorial of nitrogen x seeding, each factor has to be in a separate column.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Read and understand the code in this part but do not type or modify anything.</span>
<span class="co"># Read data (seedF for &quot;factorial&quot;)</span>

<span class="co"># seedF &lt;- read.csv(file = &quot;Lab07SeedMassData.txt&quot;, header = TRUE)</span>

seedF &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">text =</span> <span class="st">&quot;</span>
<span class="st">Treatment  block  logMass</span>
<span class="st">wnE  Block1  -0.210836005431437</span>
<span class="st">wNE  Block1  1.55288938986704</span>
<span class="st">WnE  Block1  0.055235139345024</span>
<span class="st">WNE  Block1  0.835167804254832</span>
<span class="st">wns  Block1  1.24627323200302</span>
<span class="st">wnS  Block1  0.540066519204629</span>
<span class="st">wNs  Block1  1.57199447282598</span>
<span class="st">wNS  Block1  1.23870355136554</span>
<span class="st">Wns  Block1  0.986995928669204</span>
<span class="st">WnS  Block1  -0.170749893385349</span>
<span class="st">WNs  Block1  0.664136397253749</span>
<span class="st">WNS  Block1  0.736888706368722</span>
<span class="st">wnE  Block2  0.041449411568171</span>
<span class="st">wNE  Block2  1.428708818124</span>
<span class="st">WnE  Block2  0.319992367391131</span>
<span class="st">WNE  Block2  1.03098409320956</span>
<span class="st">wns  Block2  0.643797294741899</span>
<span class="st">wnS  Block2  -0.511211922892043</span>
<span class="st">wNs  Block2  1.84080033644501</span>
<span class="st">wNS  Block2  0.813650468511317</span>
<span class="st">Wns  Block2  1.69986757761409</span>
<span class="st">WnS  Block2  -0.154140967169852</span>
<span class="st">WNs  Block2  1.423732115253</span>
<span class="st">WNS  Block2  0.2968644855256</span>
<span class="st">wnE  Block3  -0.655926955677754</span>
<span class="st">wNE  Block3  -0.27934035269992</span>
<span class="st">WnE  Block3  -0.5542030003591</span>
<span class="st">WNE  Block3  -1.12888399571028</span>
<span class="st">wns  Block3  0.45627765803375</span>
<span class="st">wnS  Block3  -1.04875645623447</span>
<span class="st">wNs  Block3  0.49759250163951</span>
<span class="st">wNS  Block3  -0.097792008066854</span>
<span class="st">Wns  Block3  -0.513584856362292</span>
<span class="st">WnS  Block3  -1.36796547632004</span>
<span class="st">WNs  Block3  1.02290365359422</span>
<span class="st">WNS  Block3  -0.527897010482484</span>
<span class="st">&quot;</span>)</code></pre></div>
<p>The two factor columns are sufficient to perform the analysis using preexisting R functions for factorial treatment combinations, but to do the calculations using only “basic” R functions (we refer to this as “by hand”) we need a new column that contain labels for all 12 treatments. We create the colkumn by pasting the letters for nitrogen and seeding levels, make it into a factor, and add it to the data frame. Recall that a factor is a special type of column in data frames that behaves as a categorical variable with a certain set of possible values. The same column of strings could be set to be a character vector, in which case it would not have recognizable levels. You can explore this by running ‘levels(seedF$NStreat)’ and then ‘levels(as.character(seedF$NStreat))’</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Add columns $nitro and $seeding to the data, to show the levels for each factor.</span>

seedF<span class="op">$</span>nitro &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">substr</span>(seedF<span class="op">$</span>Treatment, <span class="dv">2</span>, <span class="dv">2</span>))

seedF<span class="op">$</span>seeding &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">substr</span>(seedF<span class="op">$</span>Treatment, <span class="dv">3</span>, <span class="dv">3</span>))

<span class="co"># Add column NStreat for treatments resulting from nitro and seeding combinations.</span>

seedF<span class="op">$</span>NStreat &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">paste</span>(seedF<span class="op">$</span>nitro, seedF<span class="op">$</span>seeding, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</code></pre></div>
</div>
<div id="c-perform-a-test-of-the-ho-that-all-treatment-means-are-equal." class="section level5">
<h5><span class="header-section-number">1.8.1.2.3</span> 1.c Perform a test of the Ho that all treatment means are equal.</h5>
<p>For this part you need to test the null hypotheses that: - there are no interactions between nitrogen and seeding, - there are no “main effects” of nitro or seeding.</p>
<p>“Main effects” refers to the overall effect of a factor averaged over all levels of other factors. “Simple effects” are the effects of one factor for a given individual level of another factor. For example, the main effect of S for level n is:</p>
<p><span class="math display">\[\bar{Y}_{nS}\]</span></p>
<p>We do these tests with an ANOVA that partitions all variation (sum of squares) in the response variable (logMass) into Block, Treatment and Error, and then partition the Treatment variation into main effect of nitro, main effect of seeding, and the interaction between nitro and seeding (nitro x seeding).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># First do the ANOVA ignoring the treatment factorial structure.</span>

<span class="co"># This yields the first partition of SS</span>

rcbd.mod &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> logMass <span class="op">~</span><span class="st"> </span>NStreat <span class="op">+</span><span class="st"> </span>block, <span class="dt">data =</span> seedF)

<span class="kw">pander</span>(<span class="kw">anova</span>(rcbd.mod))</code></pre></div>
<table style="width:85%;">
<caption>Analysis of Variance Table</caption>
<colgroup>
<col width="22%" />
<col width="6%" />
<col width="12%" />
<col width="13%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">Sum Sq</th>
<th align="center">Mean Sq</th>
<th align="center">F value</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>NStreat</strong></td>
<td align="center">5</td>
<td align="center">10.76</td>
<td align="center">2.153</td>
<td align="center">11.05</td>
<td align="center">6.049e-06</td>
</tr>
<tr class="even">
<td align="center"><strong>block</strong></td>
<td align="center">2</td>
<td align="center">9.62</td>
<td align="center">4.81</td>
<td align="center">24.68</td>
<td align="center">6.617e-07</td>
</tr>
<tr class="odd">
<td align="center"><strong>Residuals</strong></td>
<td align="center">28</td>
<td align="center">5.457</td>
<td align="center">0.1949</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Now, analyze the same data, this time partitioning the Treatment SS according to a factorial treatment structure.</span>

rcbdF.mod &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> logMass <span class="op">~</span><span class="st"> </span>nitro <span class="op">*</span><span class="st"> </span>seeding <span class="op">+</span><span class="st"> </span>block, <span class="dt">data =</span> seedF)

<span class="co"># complete the code below to make an ANOVA table for the same data partitioning the Treatment SS according to factorial, as above:</span>

<span class="kw">pander</span>(<span class="kw">anova</span>(rcbdF.mod))</code></pre></div>
<table style="width:90%;">
<caption>Analysis of Variance Table</caption>
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="12%" />
<col width="13%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">Sum Sq</th>
<th align="center">Mean Sq</th>
<th align="center">F value</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>nitro</strong></td>
<td align="center">1</td>
<td align="center">4.079</td>
<td align="center">4.079</td>
<td align="center">20.93</td>
<td align="center">8.851e-05</td>
</tr>
<tr class="even">
<td align="center"><strong>seeding</strong></td>
<td align="center">2</td>
<td align="center">6.367</td>
<td align="center">3.183</td>
<td align="center">16.34</td>
<td align="center">1.988e-05</td>
</tr>
<tr class="odd">
<td align="center"><strong>block</strong></td>
<td align="center">2</td>
<td align="center">9.62</td>
<td align="center">4.81</td>
<td align="center">24.68</td>
<td align="center">6.617e-07</td>
</tr>
<tr class="even">
<td align="center"><strong>nitro:seeding</strong></td>
<td align="center">2</td>
<td align="center">0.3178</td>
<td align="center">0.1589</td>
<td align="center">0.8155</td>
<td align="center">0.4527</td>
</tr>
<tr class="odd">
<td align="center"><strong>Residuals</strong></td>
<td align="center">28</td>
<td align="center">5.457</td>
<td align="center">0.1949</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
</tbody>
</table>
<p>Questions:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Report MSE in the RCBD and RCBDF models.</p></li>
<li><p>State the null hypothesis for the main effects of N in the RCBDF model.</p></li>
<li><p>State the null hypothesis for the main effects of seeding in in the RCBDF model.</p></li>
<li><p>Do we reject or fail to reject the following null hypothesis for the RCBDF model?</p></li>
</ol>
<p>Ho: There is no interaction between nitrogen and seeding affecting medusahead seed mass?</p>
</div>
</div>
<div id="part-2.-factorial-anova-detailed-calculations-points" class="section level4">
<h4><span class="header-section-number">1.8.1.3</span> Part 2. Factorial ANOVA detailed calculations [ points]</h4>
<p>Create a new column in the data for each of the following: - overall average - nitro treatment average - nitro effect = nitro average - overall average - seeding treatment average - seeding effect = seeding average - overall average - overall average + nitro effect + seeding effect - nitro x seeding average - nitro x seeding interaction = = nitro x seeding average - (overall average + nitro effect + seeding effect) - block average -block effect = block average - overall average - residual</p>
<p>Then calculate the sum of squares and degrees of freedom for nitro effect, seeding effect, interaction and residuals. Make sure that the numbers match the results from the previous section.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># First calculate the average medusahead seed mass per factor and add to a data frame</span>

<span class="co"># Type the column name of the response variable after the dollar sign:</span>

seedF<span class="op">$</span>overall.avg &lt;-<span class="st"> </span><span class="kw">mean</span>(seedF<span class="op">$</span>logMass) 

nitro.avg &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="dt">formula =</span> logMass <span class="op">~</span><span class="st"> </span>nitro, 
                       <span class="dt">data =</span> seedF, 
                       <span class="dt">FUN =</span> mean)

<span class="kw">names</span>(nitro.avg)[<span class="dv">2</span>] &lt;-<span class="st"> &quot;nitro.avg&quot;</span>

seedF &lt;-<span class="st"> </span><span class="kw">merge</span>(seedF, nitro.avg)

<span class="co"># Type the function for calculating averages:</span>

seed.avg &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="dt">formula =</span> logMass <span class="op">~</span><span class="st"> </span>seeding, 
                      <span class="dt">data =</span> seedF, 
                      <span class="dt">FUN =</span> mean)

<span class="kw">names</span>(seed.avg)[<span class="dv">2</span>] &lt;-<span class="st"> &quot;seed.avg&quot;</span>

seedF &lt;-<span class="st"> </span><span class="kw">merge</span>(seedF, seed.avg)


nitro.seed.avg &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="dt">formula =</span> logMass <span class="op">~</span><span class="st"> </span>nitro <span class="op">+</span><span class="st"> </span>seeding, 
                      <span class="dt">data =</span> seedF, 
                      <span class="dt">FUN =</span> mean)

<span class="kw">names</span>(nitro.seed.avg)[<span class="dv">3</span>] &lt;-<span class="st"> &quot;nitro.seed.avg&quot;</span>

seedF &lt;-<span class="st"> </span><span class="kw">merge</span>(seedF, nitro.seed.avg)


<span class="co"># Create a vector called block.avg to aggregate the response variable by block and calculate the means of each block</span>

block.avg &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="dt">formula =</span> logMass <span class="op">~</span><span class="st"> </span>block, 
                       <span class="dt">data =</span> seedF, 
                       <span class="dt">FUN =</span> <span class="st">&quot;mean&quot;</span>)

<span class="kw">names</span>(block.avg)[<span class="dv">2</span>] &lt;-<span class="st"> &quot;block.avg&quot;</span>

seedF &lt;-<span class="st"> </span><span class="kw">merge</span>(seedF, block.avg)


<span class="co"># Second, calculate the effects and residuals</span>

seedF<span class="op">$</span>nitro.fx &lt;-<span class="st"> </span>seedF<span class="op">$</span>nitro.avg <span class="op">-</span><span class="st"> </span>seedF<span class="op">$</span>overall.avg

<span class="co"># Type the vector name for the average of the seeded/unseeded treatment:</span>

seedF<span class="op">$</span>seed.fx &lt;-<span class="st"> </span>seedF<span class="op">$</span>seed.avg <span class="op">-</span><span class="st"> </span>seedF<span class="op">$</span>overall.avg 

seedF<span class="op">$</span>nitro.seed.fx &lt;-<span class="st"> </span><span class="kw">with</span>(seedF, nitro.seed.avg <span class="op">-</span><span class="st"> </span>(overall.avg <span class="op">+</span><span class="st"> </span>nitro.fx <span class="op">+</span><span class="st"> </span>seed.fx))

seedF<span class="op">$</span>block.fx &lt;-<span class="st"> </span>seedF<span class="op">$</span>block.avg <span class="op">-</span><span class="st"> </span>seedF<span class="op">$</span>overall.avg

seedF<span class="op">$</span>resdl &lt;-<span class="st"> </span><span class="kw">with</span>(seedF, 
                    logMass <span class="op">-</span><span class="st"> </span>
<span class="st">                       </span>overall.avg <span class="op">-</span><span class="st"> </span>
<span class="st">                       </span>nitro.fx <span class="op">-</span><span class="st"> </span>
<span class="st">                       </span>seed.fx <span class="op">-</span><span class="st"> </span>
<span class="st">                       </span>nitro.seed.fx <span class="op">-</span><span class="st"> </span>
<span class="st">                       </span>block.fx)


<span class="co"># Finally, type your equations to calculate the sum of squares.</span>

(SSnitro &lt;-<span class="st"> </span><span class="kw">sum</span>(seedF<span class="op">$</span>nitro.fx <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))</code></pre></div>
<pre><code>## [1] 4.079406108</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(SSseed &lt;-<span class="st"> </span><span class="kw">sum</span>(seedF<span class="op">$</span>seed.fx <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))</code></pre></div>
<pre><code>## [1] 6.366998066</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(SSnitro.seed &lt;-<span class="st"> </span><span class="kw">sum</span>(seedF<span class="op">$</span>nitro.seed.fx <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))</code></pre></div>
<pre><code>## [1] 0.3178363507</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(SSblock &lt;-<span class="st"> </span><span class="kw">sum</span>(seedF<span class="op">$</span>block.fx <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))</code></pre></div>
<pre><code>## [1] 9.620035671</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(SSresdl &lt;-<span class="st"> </span><span class="kw">sum</span>(seedF<span class="op">$</span>resdl <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))</code></pre></div>
<pre><code>## [1] 5.456590694</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># HINT: check your answers of the SS with the anova table in Part1. It should be the same if your calculations are correct:</span>

<span class="kw">pander</span>(<span class="kw">anova</span>(rcbdF.mod)) </code></pre></div>
<table style="width:90%;">
<caption>Analysis of Variance Table</caption>
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="12%" />
<col width="13%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">Sum Sq</th>
<th align="center">Mean Sq</th>
<th align="center">F value</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>nitro</strong></td>
<td align="center">1</td>
<td align="center">4.079</td>
<td align="center">4.079</td>
<td align="center">20.93</td>
<td align="center">8.851e-05</td>
</tr>
<tr class="even">
<td align="center"><strong>seeding</strong></td>
<td align="center">2</td>
<td align="center">6.367</td>
<td align="center">3.183</td>
<td align="center">16.34</td>
<td align="center">1.988e-05</td>
</tr>
<tr class="odd">
<td align="center"><strong>block</strong></td>
<td align="center">2</td>
<td align="center">9.62</td>
<td align="center">4.81</td>
<td align="center">24.68</td>
<td align="center">6.617e-07</td>
</tr>
<tr class="even">
<td align="center"><strong>nitro:seeding</strong></td>
<td align="center">2</td>
<td align="center">0.3178</td>
<td align="center">0.1589</td>
<td align="center">0.8155</td>
<td align="center">0.4527</td>
</tr>
<tr class="odd">
<td align="center"><strong>Residuals</strong></td>
<td align="center">28</td>
<td align="center">5.457</td>
<td align="center">0.1949</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="part-3.-multiple-comparison-of-means-using-fishers-plsd-points" class="section level4">
<h4><span class="header-section-number">1.8.1.4</span> Part 3. Multiple comparison of means using Fisher’s PLSD [ points]</h4>
<p>Fisher’s Protected Least Significant Difference is the LSD that is applied only if the overall F test is significant. In this section you need to calculate the Least Significant differences for nitro, seeding and nitro x seeding levels. For each one, construct a table that shows the means that are NOT significantly different connected by a common letter.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># First, use the LSD.test() function of the agricolae package.</span>


<span class="kw">LSD.test</span>(rcbdF.mod, <span class="st">&quot;nitro&quot;</span>, <span class="dt">group =</span> <span class="ot">TRUE</span>, <span class="dt">console =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## 
## Study: rcbdF.mod ~ &quot;nitro&quot;
## 
## LSD t Test for logMass 
## 
## Mean Square Error:  0.1948782391 
## 
## nitro,  means and individual ( 95 %) CI
## 
##         logMass          std  r           LCL          UCL          Min
## n 0.04458775526 0.7946030192 18 -0.1685506451 0.2577261557 -1.367965476
## N 0.71783907929 0.8054141606 18  0.5047006789 0.9309774797 -1.128883996
##           Max
## n 1.699867578
## N 1.840800336
## 
## Alpha: 0.05 ; DF Error: 28
## Critical Value of t: 2.048407142 
## 
## least Significant Difference: 0.3014232165 
## 
## Treatments with the same letter are not significantly different.
## 
##         logMass groups
## N 0.71783907929      a
## n 0.04458775526      b</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">LSD.test</span>(rcbdF.mod, <span class="st">&quot;seeding&quot;</span>, <span class="dt">group =</span> <span class="ot">TRUE</span>, <span class="dt">console =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## 
## Study: rcbdF.mod ~ &quot;seeding&quot;
## 
## LSD t Test for logMass 
## 
## Mean Square Error:  0.1948782391 
## 
## seeding,  means and individual ( 95 %) CI
## 
##          logMass          std  r            LCL          UCL           Min
## E  0.20293639282 0.8506851147 12 -0.05810376998 0.4639765556 -1.1288839957
## s  0.96173219264 0.6623600110 12  0.70069202984 1.2227723554 -0.5135848564
## S -0.02102833363 0.7797215931 12 -0.28206849643 0.2400118292 -1.3679654763
##           Max
## E 1.552889390
## s 1.840800336
## S 1.238703551
## 
## Alpha: 0.05 ; DF Error: 28
## Critical Value of t: 2.048407142 
## 
## least Significant Difference: 0.3691665386 
## 
## Treatments with the same letter are not significantly different.
## 
##          logMass groups
## s  0.96173219264      a
## E  0.20293639282      b
## S -0.02102833363      b</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">LSD.test</span>(rcbdF.mod, <span class="kw">c</span>(<span class="st">&quot;nitro&quot;</span>, <span class="st">&quot;seeding&quot;</span>), <span class="dt">group =</span> <span class="ot">TRUE</span>, <span class="dt">console =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## 
## Study: rcbdF.mod ~ c(&quot;nitro&quot;, &quot;seeding&quot;)
## 
## LSD t Test for logMass 
## 
## Mean Square Error:  0.1948782391 
## 
## nitro:seeding,  means and individual ( 95 %) CI
## 
##           logMass          std r            LCL            UCL
## n:E -0.1673815072 0.3797097928 6 -0.53654804575  0.20178503136
## N:E  0.5732542928 1.0577140454 6  0.20408775428  0.94242083140
## n:s  0.7532711391 0.7614245756 6  0.38410460056  1.12243767767
## n:S -0.4521263661 0.6856580171 6 -0.82129290469 -0.08295982758
## N:s  1.1701932462 0.5302111982 6  0.80102670761  1.53935978473
## N:S  0.4100696989 0.6491290541 6  0.04090316031  0.77923623743
##               Min          Max
## n:E -0.6559269557 0.3199923674
## N:E -1.1288839957 1.5528893899
## n:s -0.5135848564 1.6998675776
## n:S -1.3679654763 0.5400665192
## N:s  0.4975925016 1.8408003364
## N:S -0.5278970105 1.2387035514
## 
## Alpha: 0.05 ; DF Error: 28
## Critical Value of t: 2.048407142 
## 
## least Significant Difference: 0.5220803256 
## 
## Treatments with the same letter are not significantly different.
## 
##           logMass groups
## N:s  1.1701932462      a
## n:s  0.7532711391     ab
## N:E  0.5732542928      b
## N:S  0.4100696989      b
## n:E -0.1673815072      c
## n:S -0.4521263661      c</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Second, calculate the LSD&#39;s and CI&#39;s &quot;by hand.&quot;</span>
<span class="co"># Hint: check your answers of LSD with the lsd test table. It should be the same if your calculations are correct.</span>

(dfe.rcbd.F &lt;-<span class="st"> </span><span class="dv">36</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] 28</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(t.critical &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.975</span>, dfe.rcbd.F))</code></pre></div>
<pre><code>## [1] 2.048407142</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(MSE.rcbd.F &lt;-<span class="st"> </span>SSresdl <span class="op">/</span><span class="st"> </span>dfe.rcbd.F)</code></pre></div>
<pre><code>## [1] 0.1948782391</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># nitrogen</span>
(se.nitro &lt;-<span class="st"> </span><span class="kw">sqrt</span>(MSE.rcbd.F <span class="op">/</span><span class="st"> </span>(<span class="kw">length</span>(seedF<span class="op">$</span>logMass) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(<span class="kw">levels</span>(seedF<span class="op">$</span>nitro)))))</code></pre></div>
<pre><code>## [1] 0.1040507993</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(LSD.nitro &lt;-<span class="st"> </span>t.critical <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>se.nitro)</code></pre></div>
<pre><code>## [1] 0.3014232165</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># seeding</span>
(se.seed &lt;-<span class="st"> </span><span class="kw">sqrt</span>(MSE.rcbd.F <span class="op">/</span><span class="st"> </span>(<span class="kw">length</span>(seedF<span class="op">$</span>logMass) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(<span class="kw">levels</span>(seedF<span class="op">$</span>seeding)))))</code></pre></div>
<pre><code>## [1] 0.1274356828</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Type your equation and calculate the LSD for seeding.</span>
(LSD.seed &lt;-<span class="st"> </span>t.critical <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>se.seed)</code></pre></div>
<pre><code>## [1] 0.3691665386</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># nitrogen x seeding</span>
(se.nitro.seed &lt;-<span class="st"> </span><span class="kw">sqrt</span>(MSE.rcbd.F <span class="op">/</span><span class="st"> </span>
<span class="st">                         </span>(<span class="kw">length</span>(seedF<span class="op">$</span>logMass) <span class="op">/</span><span class="st"> </span>
<span class="st">                            </span>(<span class="kw">length</span>(<span class="kw">levels</span>(seedF<span class="op">$</span>nitro)) <span class="op">*</span><span class="st"> </span>
<span class="st">                            </span><span class="kw">length</span>(<span class="kw">levels</span>(seedF<span class="op">$</span>seeding))))))</code></pre></div>
<pre><code>## [1] 0.180221271</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Type your equation and calculate the LSD for nitro * seeding</span>
(LSD.nitro.seed &lt;-<span class="st"> </span>t.critical <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>se.nitro.seed)</code></pre></div>
<pre><code>## [1] 0.5220803256</code></pre>
<p>Question Read the last lsd table and answer following questions:.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Do treatments “n:s” and “N:s” differ?</p></li>
<li><p>Do treatments “n:s” and “N:E” differ?</p></li>
<li><p>Do treatments “n:s” and “n:E’ differ?</p></li>
</ol>
</div>
</div>
<div id="Lab12ANS" class="section level3">
<h3><span class="header-section-number">1.8.2</span> Animal Sciences</h3>
</div>
</div>
</div>









<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p><span class="math inline">\(Y = 1000 \ \frac{[4 + \log(PlantMass.g + 0.03)]} {6}\)</span><a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>In this experiment, the overall average is the same as the estimated overall mean because the data are balanced (all treatments appear once in each block). When the number of observations differs among treatments, the estimated overall mean is not the overall average, but the average of all estimated treatment means.<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>We use 12 instead of 10 for simplicity, to have the same number of replicates equal in all treatments. This is not absolutely necessary, but different sample sizes per treatment makes things a bit more complicated.<a href="#fnref3">↩</a></p></li>
<li id="fn4"><p>Note that for simplicity, we use the language in a lax manner here and in other parts of the book. When writing “if Flame method is different from Blast,” we actually mean “if the effect of the Flame method on response variable Y is the same as the effect of the Blast method on Y.” Of course, the methods themselves ARE different as one involves burning weeds and in the other, weeds are blasted with an abrasive agent.<a href="#fnref4">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
