<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <meta name="description" content="">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="chAnova.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Applied Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="chAnova.html"><a href="chAnova.html"><i class="fa fa-check"></i><b>1</b> Analysis of Variance</a><ul>
<li class="chapter" data-level="1.1" data-path="chAnova.html"><a href="chAnova.html#learning-objectives-for-chapter"><i class="fa fa-check"></i><b>1.1</b> Learning Objectives for Chapter</a></li>
<li class="chapter" data-level="1.2" data-path="chAnova.html"><a href="chAnova.html#analysis-of-variance-anova"><i class="fa fa-check"></i><b>1.2</b> Analysis of Variance (ANOVA)</a></li>
<li class="chapter" data-level="1.3" data-path="chAnova.html"><a href="chAnova.html#assumptions-of-anova"><i class="fa fa-check"></i><b>1.3</b> Assumptions of ANOVA</a></li>
<li class="chapter" data-level="1.4" data-path="chAnova.html"><a href="chAnova.html#partitioning-of-variance"><i class="fa fa-check"></i><b>1.4</b> Partitioning of Variance</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="anova-table.html"><a href="anova-table.html"><i class="fa fa-check"></i><b>2</b> ANOVA Table</a><ul>
<li class="chapter" data-level="2.1" data-path="anova-table.html"><a href="anova-table.html#estimation-of-parameters"><i class="fa fa-check"></i><b>2.1</b> Estimation of parameters</a><ul>
<li class="chapter" data-level="2.1.1" data-path="anova-table.html"><a href="anova-table.html#r-code"><i class="fa fa-check"></i><b>2.1.1</b> R Code</a></li>
<li class="chapter" data-level="2.1.2" data-path="anova-table.html"><a href="anova-table.html#detailed-calculations"><i class="fa fa-check"></i><b>2.1.2</b> Detailed calculations</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="anova-table.html"><a href="anova-table.html#hypothesis-testing"><i class="fa fa-check"></i><b>2.2</b> Hypothesis Testing</a></li>
<li class="chapter" data-level="2.3" data-path="anova-table.html"><a href="anova-table.html#exercises-and-solutions"><i class="fa fa-check"></i><b>2.3</b> Exercises and Solutions</a></li>
<li class="chapter" data-level="2.4" data-path="anova-table.html"><a href="anova-table.html#homework"><i class="fa fa-check"></i><b>2.4</b> Homework</a><ul>
<li class="chapter" data-level="2.4.1" data-path="anova-table.html"><a href="anova-table.html#introduction-to-anova"><i class="fa fa-check"></i><b>2.4.1</b> Introduction to ANOVA</a></li>
<li class="chapter" data-level="2.4.2" data-path="anova-table.html"><a href="anova-table.html#need-for-anova"><i class="fa fa-check"></i><b>2.4.2</b> Need for ANOVA</a></li>
<li class="chapter" data-level="2.4.3" data-path="anova-table.html"><a href="anova-table.html#comparison-of-diets"><i class="fa fa-check"></i><b>2.4.3</b> Comparison of Diets</a></li>
<li class="chapter" data-level="2.4.4" data-path="anova-table.html"><a href="anova-table.html#use-of-anova"><i class="fa fa-check"></i><b>2.4.4</b> Use of ANOVA</a></li>
<li class="chapter" data-level="2.4.5" data-path="anova-table.html"><a href="anova-table.html#test-of-equality-of-variances"><i class="fa fa-check"></i><b>2.4.5</b> Test of Equality of Variances</a></li>
<li class="chapter" data-level="2.4.6" data-path="anova-table.html"><a href="anova-table.html#estimation-of-the-variance-between-and-within-samples"><i class="fa fa-check"></i><b>2.4.6</b> Estimation of the Variance Between and Within Samples</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="anova-table.html"><a href="anova-table.html#laboratory-exercises"><i class="fa fa-check"></i><b>2.5</b> Laboratory Exercises</a><ul>
<li class="chapter" data-level="2.5.1" data-path="anova-table.html"><a href="anova-table.html#LabCh09PLS"><i class="fa fa-check"></i><b>2.5.1</b> Plant Sciences</a></li>
<li class="chapter" data-level="2.5.2" data-path="anova-table.html"><a href="anova-table.html#LabCh09ANS"><i class="fa fa-check"></i><b>2.5.2</b> Animal Sciences</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="anova-table" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> ANOVA Table</h1>
<p>An experiment that tests four different treatments with five different replications will allow researchers to partition the variance into differences among treatments and within treatments (experimental error). This type of experiment is considered a completely randomized design when the observational units for treatment and the replications are randomized.</p>
<table>
<colgroup>
<col width="100%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Source df Sum of Squares (SS) Mean Squares (MS) Observed F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Total <span class="math inline">\(kr-1\)</span> <span class="math inline">\(TSS\)</span></td>
</tr>
<tr class="even">
<td align="left">Among <span class="math inline">\(k-1\)</span> <span class="math inline">\(SST\)</span> <span class="math inline">\(MST\)</span> <span class="math inline">\(\frac{MST}{MSE}\)</span> Treatments</td>
</tr>
<tr class="odd">
<td align="left">Within <span class="math inline">\(k(r-1)\)</span> <span class="math inline">\(SSE\)</span> <span class="math inline">\(MSE\)</span> Treatments</td>
</tr>
</tbody>
</table>
<p>ANOVA intuition. Present students with a series of groups of objects and ask them to guess if they think they are subsets of the some large group of whether any group seems to come from a different population.</p>
<p>Exercise: All objects in each of the squares below were randomly selected from a single larger set called <em>parent</em> set. The set of objects in any square is called a <em>group</em>. Does it look like all groups have the same parent set?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Code to generate 4 groups from two populations.</span>

<span class="kw">library</span>(randomcoloR)

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))

<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {
  <span class="kw">plot</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">3</span>), 
         <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">each =</span> <span class="dv">3</span>),
         <span class="dt">pch =</span> <span class="dv">21</span>,
         <span class="dt">cex =</span> <span class="dv">4</span>,
       <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">5</span>), 
       <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">3.5</span>),
       <span class="dt">bg =</span> <span class="kw">randomColor</span>(<span class="dt">count =</span> <span class="dv">9</span>, 
                        <span class="dt">hue =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;orange&quot;</span>, <span class="dv">3</span>), <span class="st">&quot;yellow&quot;</span>)[i], 
                        <span class="dt">luminosity =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;light&quot;</span>, <span class="dv">3</span>), <span class="st">&quot;bright&quot;</span>)[i]), 
       <span class="dt">axes =</span> <span class="ot">FALSE</span>,
       <span class="dt">xlab =</span> <span class="kw">paste</span>(<span class="st">&quot;GROUP&quot;</span>, i, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>), 
       <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>)
  }</code></pre></div>
<div class="figure">
<img src="09.0_Anova1_files/figure-html/anova.intuition1-1.png" alt="Does it look like all groups come from the same parent population?" width="672" />
<p class="caption">
(#fig:anova.intuition1)Does it look like all groups come from the same parent population?
</p>
</div>
<p>Is the answer the same for the next figure?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Code to generate 4 groups from a single population.</span>

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))

<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {
  <span class="kw">plot</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">3</span>), 
         <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">each =</span> <span class="dv">3</span>),
         <span class="dt">pch =</span> <span class="dv">21</span>,
         <span class="dt">cex =</span> <span class="dv">4</span>,
       <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">5</span>), 
       <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">3.5</span>),
       <span class="dt">bg =</span> <span class="kw">randomColor</span>(<span class="dt">count =</span> <span class="dv">9</span>, 
                        <span class="dt">hue =</span> <span class="st">&quot;orange&quot;</span>, 
                        <span class="dt">luminosity =</span> <span class="st">&quot;light&quot;</span>), 
       <span class="dt">axes =</span> <span class="ot">FALSE</span>,
       <span class="dt">xlab =</span> <span class="kw">paste</span>(<span class="st">&quot;GROUP&quot;</span>, i, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>), 
       <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>)
  }</code></pre></div>
<div class="figure">
<img src="09.0_Anova1_files/figure-html/anova.intuition2-1.png" alt="Does it look like all groups come from the same parent population?" width="672" />
<p class="caption">
(#fig:anova.intuition2)Does it look like all groups come from the same parent population?
</p>
</div>
<div id="estimation-of-parameters" class="section level2">
<h2><span class="header-section-number">2.1</span> Estimation of parameters</h2>
<div id="r-code" class="section level3">
<h3><span class="header-section-number">2.1.1</span> R Code</h3>
</div>
<div id="detailed-calculations" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Detailed calculations</h3>
<p>First, we present the calculations as traditionally taught in introductory courses. Then we briefly explain the method and equations actually used in the theory of least squares and emplemented by statistical software.</p>
</div>
</div>
<div id="hypothesis-testing" class="section level2">
<h2><span class="header-section-number">2.2</span> Hypothesis Testing</h2>
<p>When using ANOVA to test for a difference among treatments, our null hypothesis and alternative hypothesis can be stated, respectively, as</p>
<p><span class="math inline">\(H_0 : \mu_1 = \mu_2 = ... =\mu_k\)</span> for <span class="math inline">\(k\)</span> treatments<br />
<span class="math inline">\(H_1 : at least 1 treatment is different\)</span></p>
</div>
<div id="exercises-and-solutions" class="section level2">
<h2><span class="header-section-number">2.3</span> Exercises and Solutions</h2>
</div>
<div id="homework" class="section level2">
<h2><span class="header-section-number">2.4</span> Homework</h2>
<div id="introduction-to-anova" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Introduction to ANOVA</h3>
<p>This set of exercises introduces the need for and shows the use of a method called Analysis of Variance (ANOVA). This method is used to determine if there are differences in the means of several populations. Instead of two populations, now there are many. We start with a type of ANOVA called One-way ANOVA. The term “One-way” means that the populations may differ in only one factor. For example, the factor can be the amount of fertilizer applied to a crop or the type of diet fed to an animal. Conversely, “Two-way” ANOVA involves more than one factor, for example when plots differ not only in the amount of fertilizer but also in the amount of irrigation. For now we focus on one-way ANOVA.</p>
</div>
<div id="need-for-anova" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Need for ANOVA</h3>
<p>We already know how to compare two means. When we have many means and want to determine if any of them are different we could simply test all possible pairs. Why is this not a good idea unless we take precautions? This first part of this homework illustrates this.</p>
</div>
<div id="comparison-of-diets" class="section level3">
<h3><span class="header-section-number">2.4.3</span> Comparison of Diets</h3>
<p>You are looking for diets that reduce blood cholesterol in rats. You created 14 test diets and did an experiment in which 4 randomly selected rats were fed each diet. Blood cholesterol was measured on each rat at the end of 30 days of feeding. Because you do this before knowing about ANOVA you decide to test for differences using the independent observations procedure for two population means, taking two diets at a time. You use alpha=0.05 for each test. Assume that the test are all independent.</p>
<p><strong>Binomial</strong></p>
<ol style="list-style-type: decimal">
<li><p>How many different tests of <span class="math inline">\(H_0: \mu1 =\mu2\)</span> do you make? Consider that each time you make a test you are choosing 2 out of 14 means. The order of the means does not matter, because we are making 2-tailed tests.</p></li>
<li><p>What is the probability that you make a type I error in each test separately?</p></li>
<li><p>What is the probability that you make a type I error in just one of all the tests?</p></li>
<li><p>What is the probability that you make a type I error in none of the tests?</p></li>
<li><p>What is the probability that you make a type I error in at least one test (family-wise error rate)?</p></li>
</ol>
</div>
<div id="use-of-anova" class="section level3">
<h3><span class="header-section-number">2.4.4</span> Use of ANOVA</h3>
<p>When you make a lot of tests, your chance of making at least one mistake can be quite large. ANOVA avoids the problem with your “all-tests” approach by doing a single test that simultaneously checks for evidence of at least one difference. Interestingly, although the test is to determine if there are differences among means, it actually is a test of equality of variances estimated in two different ways. So first we practice testing for equality (or difference) of variances. When two random variables have normal distributions with equal variance, the ratio of sample variances from each population has an F distribution (SG textbook pages 54 and 81).</p>
</div>
<div id="test-of-equality-of-variances" class="section level3">
<h3><span class="header-section-number">2.4.5</span> Test of Equality of Variances</h3>
<p>The data below are samples of forage yield (ton/ha) from a variety of fescue grown with and without irrigation. Test the hypothesis that irrigated and rainfed yields have the same variance.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test.of.eq.var &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
<span class="st">&#39;rainfed&#39;</span>&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">4.55531</span>, <span class="fl">3.28384</span>,<span class="fl">3.69763</span>, <span class="fl">4.97093</span>, <span class="fl">4.86167</span>, <span class="fl">3.51156</span>, <span class="fl">5.37135</span>, <span class="fl">4.17079</span>, <span class="fl">3.51320</span>, <span class="fl">4.02560</span>, 
              <span class="fl">2.79041</span>, <span class="fl">3.55350</span>, <span class="fl">3.22606</span>, <span class="fl">5.89298</span>, <span class="fl">1.66526</span>, <span class="fl">4.16665</span>, <span class="fl">3.50212</span>, <span class="fl">3.72783</span>, <span class="fl">2.36477</span>, <span class="fl">3.30673</span>, 
              <span class="fl">4.40777</span>, <span class="fl">3.66480</span>, <span class="fl">3.35171</span>, <span class="fl">3.10409</span>, <span class="fl">2.85976</span>, <span class="fl">3.81750</span>, <span class="fl">5.39221</span>, <span class="fl">4.99803</span>,<span class="fl">4.11388</span>, <span class="fl">4.11004</span>),
<span class="st">&#39;irrigated&#39;</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">13.10275</span>, <span class="fl">11.66548</span>, <span class="fl">8.40485</span>, <span class="fl">8.37005</span>, <span class="fl">10.32271</span>, <span class="fl">10.22372</span>, <span class="fl">8.08630</span>, <span class="fl">12.99069</span>, <span class="fl">11.70000</span>, <span class="fl">12.10000</span>, 
                 <span class="fl">7.87410</span>, <span class="fl">10.22707</span>, <span class="fl">12.10700</span>, <span class="fl">11.00452</span>, <span class="fl">10.64577</span>, <span class="fl">8.68308</span>, <span class="fl">6.83079</span>, <span class="fl">12.25721</span>, <span class="fl">10.20000</span>, <span class="fl">12.52602</span>, 
                 <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="ot">NA</span>))</code></pre></div>
<p><strong>Note: because our two treatments do not contain the same number of samples, ‘NA’ values are included to balance out the dataset in R.</strong></p>
<p>For the following calculations, assume an <span class="math inline">\(\alpha = 0.05\)</span>, and <span class="math inline">\(df_{rainfed} = 29\)</span> and <span class="math inline">\(df_{irrigated} = 19\)</span> to calculate these values.</p>
<ol start="6" style="list-style-type: decimal">
<li><p>Calculate the sample variances and report the “calculated” or sample F value.</p></li>
<li><p>What is the probability of observing an F-value larger than the one observed?</p></li>
<li><p>What is the critical F “from table?”</p></li>
<li><p>Interpret the results of the test of equality of variances.</p></li>
</ol>
</div>
<div id="estimation-of-the-variance-between-and-within-samples" class="section level3">
<h3><span class="header-section-number">2.4.6</span> Estimation of the Variance Between and Within Samples</h3>
<p>For this section of the exercise we will use yield (ton/ha) data about 10 fescue varieties, all grown in rainfed conditions. We assume that the variances are the same for all varieties. This is an important point to understand: we assume that the variance is the same for all varieties, regardless of their means. We are referring to the variances within each sample. Because the variances are assumed to be the same, we can follow the idea used in Case 1 of two populations means (textbook page 88) and pool the estimates to get a better overall estimate of the variance.</p>
<p>These are randomly simulated data. All variances are equal to 1 and the true means are below. These values are given just FYI, to see how samples differ.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fescue.samples &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
<span class="st">&#39;var1&#39;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="fl">3.10</span>, <span class="fl">3.88</span>, <span class="fl">2.37</span>, <span class="fl">3.95</span>, <span class="fl">2.42</span>, <span class="fl">1.72</span>, <span class="fl">3.28</span>, <span class="fl">2.51</span>, <span class="fl">2.44</span>), 
<span class="st">&#39;var2&#39;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="fl">3.84</span>, <span class="fl">2.65</span>, <span class="fl">3.10</span>, <span class="fl">2.83</span>, <span class="fl">1.81</span>, <span class="fl">3.86</span>, <span class="fl">4.25</span>, <span class="fl">4.21</span>, <span class="fl">5.44</span>), 
<span class="st">&#39;var3&#39;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="fl">5.80</span>, <span class="fl">5.87</span>, <span class="fl">4.25</span>, <span class="fl">2.56</span>, <span class="fl">4.32</span>, <span class="fl">3.05</span>, <span class="fl">4.31</span>, <span class="fl">3.67</span>, <span class="fl">2.36</span>), 
<span class="st">&#39;var4&#39;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="fl">5.03</span>, <span class="fl">2.18</span>, <span class="fl">3.49</span>, <span class="fl">4.50</span>, <span class="fl">1.99</span>, <span class="fl">2.95</span>, <span class="fl">3.48</span>, <span class="fl">2.74</span>, <span class="fl">3.89</span>), 
<span class="st">&#39;var5&#39;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="fl">3.90</span>, <span class="fl">4.24</span>, <span class="fl">4.60</span>, <span class="fl">5.00</span>, <span class="fl">4.04</span>, <span class="fl">4.85</span>, <span class="fl">4.65</span>, <span class="fl">4.26</span>, <span class="fl">5.47</span>), 
<span class="st">&#39;var6&#39;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="fl">7.57</span>, <span class="fl">3.76</span>, <span class="fl">6.66</span>, <span class="fl">5.87</span>, <span class="fl">5.69</span>, <span class="fl">6.41</span>, <span class="fl">5.12</span>, <span class="fl">6.74</span>, <span class="fl">6.04</span>), 
<span class="st">&#39;var7&#39;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="fl">2.47</span>, <span class="fl">4.23</span>, <span class="fl">2.63</span>, <span class="fl">4.68</span>, <span class="fl">3.22</span>, <span class="fl">3.88</span>, <span class="fl">3.17</span>, <span class="fl">3.62</span>, <span class="fl">3.22</span>), 
<span class="st">&#39;var8&#39;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="fl">3.23</span>, <span class="fl">4.15</span>, <span class="fl">4.12</span>, <span class="fl">6.05</span>, <span class="fl">3.66</span>, <span class="fl">4.90</span>, <span class="fl">3.88</span>, <span class="fl">3.76</span>, <span class="fl">3.15</span>), 
<span class="st">&#39;var9&#39;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="fl">4.01</span>, <span class="fl">5.46</span>, <span class="fl">4.31</span>, <span class="fl">5.63</span>, <span class="fl">5.22</span>, <span class="fl">4.38</span>, <span class="fl">4.75</span>, <span class="fl">4.09</span>, <span class="fl">4.60</span>),
<span class="st">&#39;var10&#39;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="fl">6.96</span>, <span class="fl">5.79</span>, <span class="fl">6.76</span>, <span class="fl">6.25</span>, <span class="fl">6.83</span>, <span class="fl">7.24</span>, <span class="fl">7.26</span>, <span class="fl">5.00</span>, <span class="fl">4.66</span>))

<span class="co">#Actual Population Means</span>
pop.means &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
<span class="st">&#39;var1&#39;</span> =<span class="st"> </span><span class="fl">3.0</span>, 
<span class="st">&#39;var2&#39;</span> =<span class="st"> </span><span class="fl">3.5</span>, 
<span class="st">&#39;var3&#39;</span> =<span class="st"> </span><span class="fl">4.0</span>, 
<span class="st">&#39;var4&#39;</span> =<span class="st"> </span><span class="fl">3.0</span>, 
<span class="st">&#39;var5&#39;</span> =<span class="st"> </span><span class="fl">5.0</span>, 
<span class="st">&#39;var6&#39;</span> =<span class="st"> </span><span class="fl">6.0</span>, 
<span class="st">&#39;var7&#39;</span> =<span class="st"> </span><span class="fl">3.2</span>, 
<span class="st">&#39;var8&#39;</span> =<span class="st"> </span><span class="fl">3.9</span>, 
<span class="st">&#39;var9&#39;</span> =<span class="st"> </span><span class="fl">4.5</span>, 
<span class="st">&#39;var10&#39;</span> =<span class="st"> </span><span class="fl">6.0</span>)

df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">&#39;var1&#39;</span> =<span class="st"> </span><span class="dv">8</span>, <span class="st">&#39;var2&#39;</span> =<span class="st"> </span><span class="dv">8</span>, <span class="st">&#39;var3&#39;</span> =<span class="st"> </span><span class="dv">8</span>, <span class="st">&#39;var4&#39;</span> =<span class="st"> </span><span class="dv">8</span>, <span class="st">&#39;var5&#39;</span> =<span class="st"> </span><span class="dv">8</span>, <span class="st">&#39;var6&#39;</span> =<span class="st"> </span><span class="dv">8</span>, <span class="st">&#39;var7&#39;</span> =<span class="st"> </span><span class="dv">8</span>, <span class="st">&#39;var8&#39;</span> =<span class="st"> </span><span class="dv">8</span>, <span class="st">&#39;var9&#39;</span> =<span class="st"> </span><span class="dv">8</span>, <span class="st">&#39;var10&#39;</span> =<span class="st"> </span><span class="dv">8</span>)

<span class="co">#Sample Averages for Each Variety</span>
sample.avg &lt;-<span class="st"> </span><span class="kw">sapply</span>(fescue.samples, mean)

<span class="co">#Sample Variances for Each Variety</span>
sample.var &lt;-<span class="st"> </span><span class="kw">sapply</span>(fescue.samples, var)</code></pre></div>
<p>For the following calculations, assume an <span class="math inline">\(\alpha = 0.05\)</span>, and <span class="math inline">\(df_{var_i} = 8\)</span> to calculate these values.</p>
<p><span class="math inline">\(S^2_{\bar{Y}} = \frac{S^2_{Y}}{r}\)</span></p>
<p><span class="math inline">\(S^2 = \frac{(r_1 - 1)S^2_{1} + (r_2 - 1)S^2_{2} +(r_3 - 1)S^2_{3} + (r_4 - 1)S^2_{4} + (r_5 - 1)S^2_{5} + (r_6 - 1)S^2_{6} + (r_7 - 1)S^2_{7} + (r_8 - 1)S^2_{8} + (r_9 - 1)S^2_{9} + (r_10 - 1)S^2_{10}}{(r_1 -1) + (r_2 -1) + (r_3 -1) + (r_4 -1) + (r_5 -1) + (r_6 -1) + (r_7 -1) + (r_8 -1) + (r_9 -1) + (r_{10} -1)}\)</span></p>
<ol start="10" style="list-style-type: decimal">
<li>Estimate the pooled variance for the 10 varieties of fescue.</li>
</ol>
<p>Now we recall that the variance of averages for samples from a population is the variance of individual observations divided by sample size. If it is true that all means are the same for all varieties, then we can obtain another estimate of the individual variance by calculating the variance among averages and multiplying by sample size.</p>
<ol start="11" style="list-style-type: decimal">
<li>Estimate the variance of yield using the variance among averages and sample size. Refer to the equation you were asked to memorize for this course.<br />
</li>
<li><p>What is the overall average?</p></li>
<li><p>What is the pooled within variance?</p></li>
<li><p>What is the variance of averages?</p></li>
<li><p>What is the second variance estimate?</p></li>
<li><p>What is <span class="math inline">\(F_{calc}\)</span>?</p></li>
<li><p>What is <span class="math inline">\(F_{critical}\)</span>?</p></li>
<li><p>What is P(<span class="math inline">\(F\)</span> &gt; <span class="math inline">\(F_{calc}\)</span>)?</p></li>
<li><p>What is <span class="math inline">\(df_{numerator}\)</span>?</p></li>
<li><p>What is <span class="math inline">\(df_{denominator}\)</span>?</p></li>
</ol>
</div>
</div>
<div id="laboratory-exercises" class="section level2">
<h2><span class="header-section-number">2.5</span> Laboratory Exercises</h2>
<div id="LabCh09PLS" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Plant Sciences</h3>
<p>Prepare an .Rmd document starting with the following text, where you substitute the corresponsing information for author name and date.</p>
<pre><code>---
title: &quot;Lab05 CRD Anova&quot;
author: &quot;YourFirstName YourLastName&quot;
date: &quot;enter date here&quot;
output: html_document
---</code></pre>
<div id="instructions" class="section level4">
<h4><span class="header-section-number">2.5.1.1</span> Instructions</h4>
<p>For this lab you will modify this file and submit this file with the file name changed so it has your email ID (the part before @) in lower case instead of “email.” Do not add spaces to the file name.</p>
<p>This is a markdown document. You will type your code and run it one line at a time as you add it in the lines indicated below. Add code <strong>ONLY</strong> in the areas between “```{r}” and “```”. These areas are highlighted with a light grey color. Run each line and parts to learn and experiment until you get the result you want. Keep the lines that worked and move on. At any time you can see if your document “knits” or not by clicking on the Knit HTML icon at the top. Once you have completed all work, knit your document and save the html file produced with the same file name but with an html extension (Lab01email.html).</p>
<p><strong>Submit BOTH files for your lab report using the appropriate Canvas tool</strong></p>
<p>For each part and question below, type your code in the grey area below, between the sets of back-ticks (```) to perform the desired computation and get output. Type your answers <strong>below</strong> the corresponding grey area.</p>
<p>In this exercise we analyze the data resulting from an experiment at the UC Davis Plant Sciences research fields. The data and description of the experimental setup have been simplified to facilitate understanding. For the purpose of this lab we will consider that the experiment was designed as a Completely Randomized Design in which 12 treatments were applied randomly to 13 plots each. We will also assume that the variances of the errors or residuals are the same in all treatments. One medusahead plant was grown in each plot and its total seed production was recorded at maturity (seedMass.g).</p>
<p>Treatments resulted from combining two levels of nitrogen fertilization (n: no fertilizer added and N: nitrogen added), two levels of watering (w: no water other than rain, W: with water added) and three environments (s: areas without addition of seed representing the typical California Annual Grassland, S: areas where native perennial grasses were seeded, E: edge between seeded and unseeded areas). Based on previous experience and plant biology, we expect medusahead seed production to be lowest without water or fertilizer and when exposed to competition by native perennial grasses.</p>
<p>This exercise has four parts. First, we read in and explore the data with some descriptive statistics. We will use a transformation to normalize the distribution of the response variable. Second, each observation is partitioned into the components indicated by the model and then the corresponding sums of squares (SS) and degreees of freedom (df) are computed. The ANOVA table and tests are done with the resulting values of SS and dfe. Third, we repeat the analysis using pre-existing R functions to do the ANOVA tables and tests direclty. Finally, we calculate confidence intervals for treatment means an back-transform them to be able to interpret results in the original units of grams of seed produced per plant.</p>
</div>
<div id="part-1.-inspection-and-summary-of-data-25-points" class="section level4">
<h4><span class="header-section-number">2.5.1.2</span> Part 1. Inspection and summary of data [25 points]</h4>
<p>Get a histogram of the data. Make a graph showing boxplots of the data for each treatment. Notice that the data have a highly skewed distribution, so a logarithmic transformation is necessary. Create a new column called logSmass that contains the log of seed mass after adding 0.3 to the mass. We add 0.3 to avoid problems with the zeroes, because log(0) is not defined. Plot histograms and boxplots of the new variable. Inspect the boxplots and determine if there appear to be any effects of treatments on the seed production of the invasive exotic weed. Create a table of averages and standard errors by treatment.</p>
<p>In the first R chunk we read in the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># seed &lt;- read.csv(file = &quot;Lab05SeedMassData.txt&quot;, header = TRUE)</span>

seed &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">text =</span> <span class="st">&quot;</span>
<span class="st">id block Treatment seedMass.g</span>
<span class="st">1 1 WNE 0.8452</span>
<span class="st">2 1 WNE 1.628599896</span>
<span class="st">3 1 WNE 1.71330012</span>
<span class="st">5 1 WNE 0.605599925</span>
<span class="st">63 2 WNE 1.478700073</span>
<span class="st">64 2 WNE 1.655799925</span>
<span class="st">65 2 WNE 3.579000285</span>
<span class="st">66 2 WNE 2.52810012</span>
<span class="st">67 2 WNE 0.676500068</span>
<span class="st">119 3 WNE 0.84060003</span>
<span class="st">120 3 WNE 0.455200004</span>
<span class="st">121 3 WNE 0.642700076</span>
<span class="st">122 3 WNE 0</span>
<span class="st">6 1 wNE 2.39799978</span>
<span class="st">7 1 wNE 3.630199812</span>
<span class="st">8 1 wNE 3.19679986</span>
<span class="st">9 1 wNE 1.579800105</span>
<span class="st">10 1 wNE 2.524800075</span>
<span class="st">73 2 wNE 1.628599875</span>
<span class="st">74 2 wNE 5.239899819</span>
<span class="st">75 2 wNE 2.374499816</span>
<span class="st">76 2 wNE 2.957700192</span>
<span class="st">128 3 wNE 0.39629997</span>
<span class="st">129 3 wNE 1.11970005</span>
<span class="st">130 3 wNE 2.129599824</span>
<span class="st">131 3 wNE 1.958600049</span>
<span class="st">13 1 wnE 0.049800007</span>
<span class="st">14 1 wnE 0.46560003</span>
<span class="st">15 1 wnE 0.358300019</span>
<span class="st">68 2 wnE 0.616600044</span>
<span class="st">69 2 wnE 1.018299904</span>
<span class="st">70 2 wnE 0.402999948</span>
<span class="st">71 2 wnE 0.600599976</span>
<span class="st">72 2 wnE 0.420299968</span>
<span class="st">132 3 wnE 1.267800064</span>
<span class="st">133 3 wnE 0.722599913</span>
<span class="st">134 3 wnE 0.6414</span>
<span class="st">135 3 wnE 1.559600013</span>
<span class="st">136 3 wnE 0.301799972</span>
<span class="st">16 1 WnE 0.49499996</span>
<span class="st">17 1 WnE 0.42920001</span>
<span class="st">18 1 WnE 0.52509996</span>
<span class="st">19 1 WnE 0.314599977</span>
<span class="st">78 2 WnE 1.070900032</span>
<span class="st">79 2 WnE 0.523999944</span>
<span class="st">80 2 WnE 0.879599924</span>
<span class="st">81 2 WnE 1.015500081</span>
<span class="st">123 3 WnE 0.745699944</span>
<span class="st">124 3 WnE 0.804199928</span>
<span class="st">125 3 WnE 0.633399966</span>
<span class="st">126 3 WnE 0.965900001</span>
<span class="st">127 3 WnE 1.932200036</span>
<span class="st">20 1 wnS 0.3136</span>
<span class="st">21 1 wnS 0.43789998</span>
<span class="st">22 1 wnS 0.326600029</span>
<span class="st">23 1 wnS 2.688000014</span>
<span class="st">24 1 wnS 0.438300029</span>
<span class="st">83 2 wnS 0.184299984</span>
<span class="st">85 2 wnS 0.3579</span>
<span class="st">86 2 wnS 0.2591</span>
<span class="st">152 3 wnS 0.299800035</span>
<span class="st">153 3 wnS 0.713900075</span>
<span class="st">154 3 wnS 0.384100024</span>
<span class="st">155 3 wnS 0.67930006</span>
<span class="st">156 3 wnS 0.631599974</span>
<span class="st">25 1 WNS 2.424700152</span>
<span class="st">26 1 WNS 0.5808</span>
<span class="st">27 1 WNS 0.584400068</span>
<span class="st">28 1 WNS 0.67930005</span>
<span class="st">91 2 WNS 0.7138</span>
<span class="st">92 2 WNS 0.057500004</span>
<span class="st">93 2 WNS 0.18880002</span>
<span class="st">94 2 WNS 2.87149987</span>
<span class="st">95 2 WNS 0.408300021</span>
<span class="st">147 3 WNS 0.62479995</span>
<span class="st">148 3 WNS 0.471400036</span>
<span class="st">150 3 WNS 1.432499985</span>
<span class="st">151 3 WNS 1.666099926</span>
<span class="st">30 1 wNS 0.81229995</span>
<span class="st">31 1 wNS 3.78009968</span>
<span class="st">32 1 wNS 2.014800174</span>
<span class="st">33 1 wNS 1.697400132</span>
<span class="st">34 1 wNS 1.161500076</span>
<span class="st">87 2 wNS 0.997699956</span>
<span class="st">88 2 wNS 2.960099866</span>
<span class="st">89 2 wNS 1.23570003</span>
<span class="st">90 2 wNS 1.034799964</span>
<span class="st">138 3 wNS 1.05819988</span>
<span class="st">139 3 wNS 2.100399994</span>
<span class="st">140 3 wNS 1.347200127</span>
<span class="st">141 3 wNS 2.373300001</span>
<span class="st">35 1 WnS 0.455399956</span>
<span class="st">36 1 WnS 0.258800003</span>
<span class="st">38 1 WnS 0.30340002</span>
<span class="st">39 1 WnS 0.2277</span>
<span class="st">96 2 WnS 0.28540002</span>
<span class="st">97 2 WnS 0.915400058</span>
<span class="st">98 2 WnS 0.3118</span>
<span class="st">99 2 WnS 0.35759997</span>
<span class="st">142 3 WnS 0.209499996</span>
<span class="st">143 3 WnS 0.355199988</span>
<span class="st">144 3 WnS 0.479600032</span>
<span class="st">145 3 WnS 0.195100021</span>
<span class="st">146 3 WnS 0.455800025</span>
<span class="st">40 1 WNs 2.977100165</span>
<span class="st">41 1 WNs 0</span>
<span class="st">42 1 WNs 0</span>
<span class="st">43 1 WNs 0.93639996</span>
<span class="st">105 2 WNs 0.717100059</span>
<span class="st">106 2 WNs 2.6535999</span>
<span class="st">107 2 WNs 4.149200016</span>
<span class="st">108 2 WNs 5.559399812</span>
<span class="st">109 2 WNs 2.09089998</span>
<span class="st">167 3 WNs 6.93320061</span>
<span class="st">168 3 WNs 4.72049974</span>
<span class="st">169 3 WNs 8.660299999</span>
<span class="st">171 3 WNs 2.437699887</span>
<span class="st">44 1 Wns 0.650700024</span>
<span class="st">45 1 Wns 0.93370002</span>
<span class="st">46 1 Wns 2.126800006</span>
<span class="st">47 1 Wns 1.311599922</span>
<span class="st">48 1 Wns 2.114299946</span>
<span class="st">115 2 Wns 2.113199912</span>
<span class="st">116 2 Wns 7.767500208</span>
<span class="st">117 2 Wns 3.437700174</span>
<span class="st">118 2 Wns 2.931799789</span>
<span class="st">172 3 Wns 0.635800038</span>
<span class="st">173 3 Wns 1.607500132</span>
<span class="st">174 3 Wns 0.947599979</span>
<span class="st">175 3 Wns 1.075900105</span>
<span class="st">49 1 wns 1.70000015</span>
<span class="st">51 1 wns 1.504</span>
<span class="st">52 1 wns 0.94400004</span>
<span class="st">53 1 wns 3.488500337</span>
<span class="st">100 2 wns 2.2786001</span>
<span class="st">101 2 wns 1.578499845</span>
<span class="st">102 2 wns 0.764299998</span>
<span class="st">103 2 wns 0.474700014</span>
<span class="st">104 2 wns 1.31689998</span>
<span class="st">157 3 wns 1.770300075</span>
<span class="st">159 3 wns 2.36320013</span>
<span class="st">160 3 wns 4.271699849</span>
<span class="st">161 3 wns 4.158900105</span>
<span class="st">54 1 wNs 5.17460008</span>
<span class="st">55 1 wNs 3.88629957</span>
<span class="st">56 1 wNs 0.592299989</span>
<span class="st">57 1 wNs 2.063099988</span>
<span class="st">58 1 wNs 1.889700111</span>
<span class="st">110 2 wNs 3.202000016</span>
<span class="st">111 2 wNs 5.395399962</span>
<span class="st">112 2 wNs 3.959800395</span>
<span class="st">114 2 wNs 6.27350022</span>
<span class="st">163 3 wNs 2.42960022</span>
<span class="st">164 3 wNs 4.8853</span>
<span class="st">165 3 wNs 1.079000118</span>
<span class="st">166 3 wNs 4.73389994</span>
<span class="st">&quot;</span>)

seed<span class="op">$</span>Treatment &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">as.character</span>(seed<span class="op">$</span>Treatment), <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;wns&quot;</span>, <span class="st">&quot;wnE&quot;</span>, <span class="st">&quot;wnS&quot;</span>, <span class="st">&quot;wNs&quot;</span>, <span class="st">&quot;wNE&quot;</span>, <span class="st">&quot;wNS&quot;</span>, <span class="st">&quot;Wns&quot;</span>, <span class="st">&quot;WnE&quot;</span>, <span class="st">&quot;WnS&quot;</span>, <span class="st">&quot;WNs&quot;</span>, <span class="st">&quot;WNE&quot;</span>, <span class="st">&quot;WNS&quot;</span>)) <span class="co"># Better order for treatments</span></code></pre></div>
<p>The last line of code changes the order of the treatment levels such that treatmens s, E and S appear in that sequence for each combination of water and nitrogen. This order facilitates the detection of patterns of response.</p>
<p>We then look at the structure of the data frame to make sure the data were read correctly, and we make a boxplot and a histogram of the seed mass in grams produced by each plant.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Look at the data</span>

<span class="kw">str</span>(seed) <span class="co"># Note the column that has our dependent variable</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    156 obs. of  4 variables:
##  $ id        : int  1 2 3 5 63 64 65 66 67 119 ...
##  $ block     : int  1 1 1 1 2 2 2 2 2 3 ...
##  $ Treatment : Factor w/ 12 levels &quot;wns&quot;,&quot;wnE&quot;,&quot;wnS&quot;,..: 11 11 11 11 11 11 11 11 11 11 ...
##  $ seedMass.g: num  0.845 1.629 1.713 0.606 1.479 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(seedMass.g <span class="op">~</span><span class="st"> </span>Treatment, seed)</code></pre></div>
<p><img src="09.0_Anova1_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Obtain a histogram of the data for seed mass</span>

<span class="kw">hist</span>(seed<span class="op">$</span>seedMass.g) <span class="co"># Distribution is too far from Normal</span></code></pre></div>
<p><img src="09.0_Anova1_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
<p>Note how the distribution of seed mass is highly skewed with a long right tail. The data model we will use for the ANOVA requires that the <em>residuals</em> be normally distributed, not the original data. Therefore, a proper check of normality must be applied on the residuals after removing treatment effects.</p>
<p>The model for a Completely Randomized Design (CRD) is</p>
<p><span class="math display">\[Y_{ij} = \mu_{..} + \tau_i + \epsilon_{ij}\]</span> where <span class="math inline">\(Y_{ij}\)</span> is the observation (mass of seeds in g) for treatment i and replicate j, <span class="math inline">\(\mu_{..}\)</span> is the overall mean, <span class="math inline">\(\tau_i\)</span> is the effect of treatment i and <span class="math inline">\(\epsilon_{ij}\)</span> is a random error with identical independent normal distributions for all replicates and treatments, which is written as</p>
<p><span class="math display">\[\epsilon_{ij} \sim iid \quad N(0,\sigma) \quad \forall \quad i, j\]</span></p>
<p>A histogram of the residuals of the model with treatments can be obtained in one line of code as follows. Note how functions can be nested, and they are calculated from the inside out.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(
   <span class="kw">residuals</span>(
      <span class="kw">lm</span>(seedMass.g <span class="op">~</span><span class="st"> </span>Treatment,
         <span class="dt">data =</span> seed)
   )
)</code></pre></div>
<p><img src="09.0_Anova1_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Residuals are slightly skewed. A logarithmic transformation seems to do the trick, yielding residuals that are more normal. Note that we add 1.0 to each observation because some observations are 0, and log(0) is not defined. Moreover, the addition of a fixed quantity to all observations improves the effect of the transformation. In symbols, the transformation is</p>
<p><span class="math display">\[Z_{ij} = \log(Y_{ij} + 1.0)\]</span></p>
<p>where <span class="math inline">\(Z_{ij}\)</span> is called logSmass in the R environment.</p>
<p>Transformations of original variables can be very useful to meet the assumptions necessary for inference with many models. This is a topic that requires specific treatment, but for now we note that a log transformation seems to work.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">seed<span class="op">$</span>logSmass &lt;-<span class="st"> </span><span class="kw">log</span>(seed<span class="op">$</span>seedMass.g <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)

<span class="kw">hist</span>(
   <span class="kw">residuals</span>(
      <span class="kw">lm</span>(logSmass <span class="op">~</span><span class="st"> </span>Treatment,
         <span class="dt">data =</span> seed)
   )
)</code></pre></div>
<p><img src="09.0_Anova1_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>A boxplot of the transformed seed mass by treatment allows us to look for trends in the results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(logSmass <span class="op">~</span><span class="st"> </span>Treatment, 
        <span class="dt">data =</span> seed, 
        <span class="dt">ylab =</span> <span class="st">&#39;log Seed mass (g)&#39;</span>)</code></pre></div>
<p><img src="09.0_Anova1_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p><br />
<br />
<strong>ANSWER THE FOLLOWING QUESTIONS:</strong></p>
<p>Inspect the boxplot. What treatments appear to differ? What would you expect to see based on the hypotheses and previous knowledge? Do the data appear to support your expectations?</p>
<p><br />
<br />
The descriptive statistics for these data are augmented by with a table of averages, medians and standard errors for each treatment. Keep in mind that we are working with the transformed variable, so we include back-transformed values that are in units of grams of seed per plant. The back transformation equation is</p>
<p><span class="math display">\[\bar{Y}_i. = \exp(\bar{Z}_i.) - 1.0\]</span></p>
<p>where <span class="math inline">\(\bar{Z}_i.\)</span> is the treatment average for the transformed variable. Transformations of reponse and predictor variables can be extremely useful to statistical modeling in general and in particular to meet the assumptions necessary to do inference in ANOVA. Recall that inference (<a href="#">see Chapter about inference</a>) means to make statistical statements about populations and their parameters based on samples.</p>
<p>To obtain descriptive statistics we will use the <code>aggregate</code> function. This is a versatile function that aggregates the data into groups defined by a formula and applies a predefined or a custom-built formula to obtain one result for each group. The custom function can be specified directly inside <code>aggregate</code>. Below, <code>smeans</code> is a dataframe that has two columns: one for treatment names and the other with the mean <code>logSmass</code> for each treatment. The <code>formula =</code> argument tells R what variable is to be aggregated (logSmass) and what variable to use as grouping factor (Treatment). These variables are to be found in the dataframe specified by <code>data =</code>. Each group will be processed with the function <code>mean</code> as specified in <code>FUN =</code>. Note that the parentheses are not necessary to refer to the function that calculates the averages.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Read help about aggregate() function.</span>

smeans &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="dt">formula =</span> logSmass <span class="op">~</span><span class="st"> </span>Treatment, 
                    <span class="dt">data =</span> seed, 
                    <span class="dt">FUN =</span> mean)

smedians &lt;-<span class="st"> </span><span class="kw">aggregate</span>(logSmass <span class="op">~</span><span class="st"> </span>Treatment, 
                      <span class="dt">data =</span> seed, 
                      <span class="dt">FUN =</span> median)

<span class="co"># Use the aggregate() function to get the standard error of the average for each treatment. Note that the function applied gets the standard deviation and divides by the square root of the sample size to get the standard error.</span>

sserrors &lt;-<span class="st"> </span><span class="kw">aggregate</span>(logSmass <span class="op">~</span><span class="st"> </span>Treatment, 
                      <span class="dt">data =</span> seed, 
                      <span class="dt">FUN =</span> <span class="cf">function</span>(x) <span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">length</span>(x)))</code></pre></div>
<p>For the calculation of the standard errors (the square root of the variance of each group average) we had to use a custom function defined inside <code>agregate</code> and using the <code>function</code> function where x is the set of values in each group.</p>
<p>Part 1 is completed by creating a table with the values calculated above and the back-transformed treatment averages. In the first line of code, the separate dataframes created for averages, standard errors and medians are joined as columns with <code>cbind</code>, and only columns 1, 2, 4 and 6 are kept. This removes the redundant column for treatments, which is present in each original dataframe. If you want to see the redundant column, see what happens if you remove the <code>[, c(1, 2, 4, 6)]</code> part of the code.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">table.seed.mass &lt;-<span class="st"> </span><span class="kw">cbind</span>(smeans, sserrors, smedians)[, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)]

<span class="kw">names</span>(table.seed.mass) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Treatment&quot;</span>, 
                            <span class="st">&quot;Mean.log&quot;</span>, 
                            <span class="st">&quot;SE.log&quot;</span>, 
                            <span class="st">&quot;Median.log&quot;</span>)

table.seed.mass<span class="op">$</span>Mean.g &lt;-<span class="st"> </span><span class="kw">exp</span>(table.seed.mass<span class="op">$</span>Mean.log) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>

<span class="kw">pander</span>(table.seed.mass)</code></pre></div>
<table style="width:75%;">
<colgroup>
<col width="16%" />
<col width="15%" />
<col width="13%" />
<col width="18%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Treatment</th>
<th align="center">Mean.log</th>
<th align="center">SE.log</th>
<th align="center">Median.log</th>
<th align="center">Mean.g</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">wns</td>
<td align="center">1.042</td>
<td align="center">0.1094</td>
<td align="center">0.9933</td>
<td align="center">1.834</td>
</tr>
<tr class="even">
<td align="center">wnE</td>
<td align="center">0.4724</td>
<td align="center">0.06644</td>
<td align="center">0.4704</td>
<td align="center">0.6039</td>
</tr>
<tr class="odd">
<td align="center">wnS</td>
<td align="center">0.4174</td>
<td align="center">0.08025</td>
<td align="center">0.3251</td>
<td align="center">0.5181</td>
</tr>
<tr class="even">
<td align="center">wNs</td>
<td align="center">1.416</td>
<td align="center">0.1291</td>
<td align="center">1.586</td>
<td align="center">3.122</td>
</tr>
<tr class="odd">
<td align="center">wNE</td>
<td align="center">1.161</td>
<td align="center">0.1033</td>
<td align="center">1.216</td>
<td align="center">2.194</td>
</tr>
<tr class="even">
<td align="center">wNS</td>
<td align="center">0.964</td>
<td align="center">0.08207</td>
<td align="center">0.8532</td>
<td align="center">1.622</td>
</tr>
<tr class="odd">
<td align="center">Wns</td>
<td align="center">1.022</td>
<td align="center">0.1299</td>
<td align="center">0.9584</td>
<td align="center">1.779</td>
</tr>
<tr class="even">
<td align="center">WnE</td>
<td align="center">0.5635</td>
<td align="center">0.05799</td>
<td align="center">0.5572</td>
<td align="center">0.7568</td>
</tr>
<tr class="odd">
<td align="center">WnS</td>
<td align="center">0.3072</td>
<td align="center">0.03461</td>
<td align="center">0.2714</td>
<td align="center">0.3596</td>
</tr>
<tr class="even">
<td align="center">WNs</td>
<td align="center">1.219</td>
<td align="center">0.2041</td>
<td align="center">1.296</td>
<td align="center">2.383</td>
</tr>
<tr class="odd">
<td align="center">WNE</td>
<td align="center">0.7474</td>
<td align="center">0.1126</td>
<td align="center">0.6126</td>
<td align="center">1.111</td>
</tr>
<tr class="even">
<td align="center">WNS</td>
<td align="center">0.6056</td>
<td align="center">0.1088</td>
<td align="center">0.4854</td>
<td align="center">0.8323</td>
</tr>
</tbody>
</table>
<p>The same information can be displayed graphically with a bar plot, where the hight of the bars represents seed production for each treatment, with error bars at the top.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(table.seed.mass, 
       <span class="kw">aes</span>(Treatment, Mean.log)) <span class="op">+</span><span class="st"> </span>
<span class="st">   </span><span class="kw">geom_col</span>() <span class="op">+</span><span class="st">  </span>
<span class="st">   </span><span class="kw">geom_errorbar</span>(
      <span class="kw">aes</span>(
         <span class="dt">ymin =</span> Mean.log <span class="op">-</span><span class="st"> </span>SE.log, 
         <span class="dt">ymax =</span> Mean.log <span class="op">+</span><span class="st"> </span>SE.log), 
      <span class="dt">width =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Log of Seed mass in g  ± s.e.&quot;</span>, 
        <span class="dt">x =</span> <span class="st">&quot;Treatment&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">   </span><span class="kw">theme_classic</span>()</code></pre></div>
<p><img src="09.0_Anova1_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p><br />
<br />
<strong>ANSWER THE FOLLOWING QUESTIONS</strong></p>
<p>What does<code>cbind</code> do? What does <code>aggregate</code> do?</p>
</div>
<div id="part-2.-partition-of-sum-of-squares-and-degrees-of-freedom-30-points" class="section level4">
<h4><span class="header-section-number">2.5.1.3</span> Part 2. Partition of Sum of Squares and Degrees of Freedom [30 points]</h4>
<p>Now, we use basic functions to partition the total sum of squares of logSmass into treatments and residual or error. The purpose of doing this is for you to undersand the calculations in some detail, without having to actually use a calculator. Start by creating a column with treatment averages for each observation. This column will have a repeating number for all observations in a treatment. We calculate the total sum of squares as the sum of squares of deviations from each observation to the overall average:</p>
<p><span class="math display">\[total \ deviation = Y_{ij} - \bar{Y}_{..}\]</span> <span class="math display">\[total \ sum \ of \ squares = TSS = \displaystyle\sum_{i=1}^{k} \displaystyle\sum_{j=1}^{r} \ \left(Y_{ij} - \bar{Y}_{..} \right)^2 \]</span></p>
<p>Treatment sum of squares is the sum of squared deviations from the treatment average to the overall average, for all observations. This deviation is the estimated <em>treatment effect</em> <span class="math inline">\(\hat\tau_i\)</span>.</p>
<p><span class="math display">\[sum \ of \ squares \ of \ treatments= SST =  \displaystyle\sum_{i=1}^{k} \displaystyle\sum_{j=1}^{r}  \hat\tau_i^2  = \displaystyle\sum_{i=1}^{k} \displaystyle\sum_{j=1}^{r} \left( \bar{Y}_{i.} - \bar{Y}_{..} \right)^2\]</span></p>
<p>Calculate the corresponding degrees of freedom and prepare a complete analysis of variance table with columns for Source, SS, df, and MS. Make it into a data frame and then print it nicely with <code>pander</code>. Calculate the F test and the critical F to test the Ho: mean seed production is the same in all treatments. Interpret the results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(smeans)[<span class="dv">2</span>] &lt;-<span class="st"> &quot;AvgLogMass&quot;</span>

seed &lt;-<span class="st"> </span><span class="kw">merge</span>(seed, 
              smeans, 
              <span class="dt">by =</span> <span class="st">&quot;Treatment&quot;</span>, 
              <span class="dt">all =</span> <span class="ot">TRUE</span>)

<span class="kw">head</span>(seed)</code></pre></div>
<pre><code>##   Treatment id block  seedMass.g     logSmass   AvgLogMass
## 1       wnE 13     1 0.049800007 0.0485996765 0.4724101438
## 2       wnE 14     1 0.465600030 0.3822647354 0.4724101438
## 3       wnE 15     1 0.358300019 0.3062339318 0.4724101438
## 4       wnE 68     2 0.616600044 0.4803252055 0.4724101438
## 5       wnE 69     2 1.018299904 0.7022555254 0.4724101438
## 6       wnE 70     2 0.402999948 0.3386127641 0.4724101438</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Total sum of squares:</span>
<span class="co"># total deviation of observations from the overall average</span>
ssTot &lt;-<span class="st"> </span><span class="kw">sum</span>((seed<span class="op">$</span>logSmass <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(seed<span class="op">$</span>logSmass)) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)

<span class="co"># Treatment sum of squares:</span>
<span class="co"># deviation of treatment average from the overall average</span>
ssTrt &lt;-<span class="st"> </span><span class="kw">sum</span>((seed<span class="op">$</span>AvgLogMass <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(seed<span class="op">$</span>logSmass)) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)

<span class="co"># Residual sum of squares:</span>
<span class="co"># deviation of observations from treatment average</span>
ssRes &lt;-<span class="st"> </span><span class="kw">sum</span>((seed<span class="op">$</span>logSmass <span class="op">-</span><span class="st"> </span>seed<span class="op">$</span>AvgLogMass) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)

<span class="co"># calculate the degrees of freedom by completing the code below</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df.Trt &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">levels</span>(seed<span class="op">$</span>Treatment)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>

dfe &lt;-<span class="st"> </span><span class="kw">length</span>(seed<span class="op">$</span>AvgLogMass) <span class="op">-</span><span class="st"> </span>df.Trt <span class="op">-</span><span class="st"> </span><span class="dv">1</span>

df.Tot &lt;-<span class="st"> </span>df.Trt <span class="op">+</span><span class="st"> </span>dfe

<span class="co"># Now calculate the means squares</span>

MSTrt &lt;-<span class="st"> </span>ssTrt <span class="op">/</span><span class="st"> </span>df.Trt

MSE &lt;-<span class="st"> </span>ssRes <span class="op">/</span><span class="st"> </span>dfe

<span class="co"># Calculate the F ratio and F critical value</span>

(Fcalc &lt;-<span class="st"> </span>MSTrt <span class="op">/</span><span class="st"> </span>MSE)</code></pre></div>
<pre><code>## [1] 10.59804265</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(Fcrit &lt;-<span class="st"> </span><span class="kw">qf</span>(<span class="fl">0.05</span>, 
             <span class="dt">df1 =</span> df.Trt, 
             <span class="dt">df2 =</span> dfe, 
             <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>))</code></pre></div>
<pre><code>## [1] 1.855696417</code></pre>
<p>ANSWER THE FOLLOWING QUESTIONS:</p>
<p>Are there differences among treatments? Report the F statistic and result. State your conclusions.</p>
</div>
<div id="part-3.-anova-using-r-functions.20-points" class="section level4">
<h4><span class="header-section-number">2.5.1.4</span> Part 3. ANOVA using R functions.[20 points]</h4>
<p>Use the R functions <code>aov</code> and <code>anova</code> to obtain the same tests of the null hypothesis that all means are equal. Report the results of using each function and compare to the previous results. The purpose of this part is for you to become familiar with different R functions that accomplish the same task. Read the help about the function <code>oneway.test</code> and use it, making sure that all arguments have proper values. Pay particular attention to the assumption of equal variances. Note that this function allows you to do the test even when variances are not equal, but we assume that the variances are equal.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># read help about function aov(), anova(), oneway.test()</span>

<span class="kw">summary</span>(<span class="kw">aov</span>(<span class="dt">formula =</span> logSmass <span class="op">~</span><span class="st"> </span>Treatment, 
            <span class="dt">data =</span> seed))</code></pre></div>
<pre><code>##              Df   Sum Sq   Mean Sq  F value     Pr(&gt;F)    
## Treatment    11 18.25286 1.6593510 10.59804 4.2504e-14 ***
## Residuals   144 22.54629 0.1565715                        
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">linear.model1 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> logSmass <span class="op">~</span><span class="st"> </span>Treatment, 
                    <span class="dt">data =</span> seed)

<span class="kw">anova</span>(linear.model1)</code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: logSmass
##            Df    Sum Sq    Mean Sq  F value     Pr(&gt;F)    
## Treatment  11 18.252862 1.65935104 10.59804 4.2504e-14 ***
## Residuals 144 22.546291 0.15657146                        
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">oneway.test</span>(logSmass <span class="op">~</span><span class="st"> </span>Treatment, 
            <span class="dt">data =</span> seed, 
            <span class="dt">var.equal =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## 
##  One-way analysis of means
## 
## data:  logSmass and Treatment
## F = 10.598043, num df = 11, denom df = 144, p-value = 4.250449e-14</code></pre>
<p>ANSWER THE FOLLOWING QUESTION:</p>
<p>Do the results differ among functions? Compare to the results from Part 2 and Part 3.</p>
</div>
<div id="part-4.-confidence-intervals-for-treatment-means-25-points" class="section level4">
<h4><span class="header-section-number">2.5.1.5</span> Part 4. Confidence intervals for treatment means [25 points]</h4>
<p>Create 95% confidence intervals for all the treatment means, back-transform to see mass in g by exponentiating and subtracting 0.3, then add them to the table created in Part 1. Explain how the line to add the CI’s to the ci.data works.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ci.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Treatment =</span> <span class="kw">levels</span>(seed<span class="op">$</span>Treatment))

ci.data &lt;-<span class="st"> </span><span class="kw">cbind</span>(ci.data, <span class="kw">predict</span>(linear.model1, 
                                  <span class="dt">newdata =</span> ci.data, 
                                  <span class="dt">interval =</span> <span class="st">&quot;confidence&quot;</span>)) 

<span class="kw">str</span>(ci.data)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    12 obs. of  4 variables:
##  $ Treatment: Factor w/ 12 levels &quot;wnE&quot;,&quot;wNE&quot;,&quot;WnE&quot;,..: 5 1 6 7 2 8 9 3 10 11 ...
##  $ fit      : num  1.042 0.472 0.417 1.416 1.161 ...
##  $ lwr      : num  0.825 0.255 0.201 1.199 0.944 ...
##  $ upr      : num  1.259 0.689 0.634 1.633 1.378 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Complete the code below to do the back transformation of the CI&#39;s and make a table with them</span>

ci.data.bt &lt;-<span class="st"> </span>ci.data[,<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>]

<span class="co"># Note that we will be doing a back-transformation on 3 columns from the ci.data table: the estimated mean values for each of 12 treatments, the lower 95% CIs, and the upper 95% CIs</span>

<span class="co"># Back-transformation code goes here ...</span>


<span class="kw">library</span>(plotrix)
<span class="kw">plotCI</span>(ci.data.bt<span class="op">$</span>fit, 
       <span class="dt">uiw =</span> ci.data.bt<span class="op">$</span>upr <span class="op">-</span><span class="st"> </span>ci.data.bt<span class="op">$</span>fit, 
       <span class="dt">liw =</span> ci.data.bt<span class="op">$</span>fit <span class="op">-</span><span class="st"> </span>ci.data.bt<span class="op">$</span>lwr, 
       <span class="dt">ylab =</span> <span class="st">&quot;Seed Mass (g)&quot;</span>)</code></pre></div>
<p><img src="09.0_Anova1_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>ANSWER THE FOLLOWING QUESTIONS.</p>
<ol style="list-style-type: decimal">
<li><p>Can you conclude that any of the treatments are effective at controlling medusahead seed production, if your threshold for control is 2 g? In other words, do any treatments result in an expected seed mass production that is significantly less than 2 g?</p></li>
<li><p>Explain how the line to add the CI’s to the ci.data works (i.e., explain the <code>cbind</code> function).</p></li>
</ol>
</div>
</div>
<div id="LabCh09ANS" class="section level3">
<h3><span class="header-section-number">2.5.2</span> Animal Sciences</h3>
<p>Prepare an .Rmd document starting with the following text, where you substitute the corresponsing information for author name and date.</p>
<pre><code>---
title: &quot;Lab05 CRD Anova&quot;
author: &quot;YourFirstName YourLastName&quot;
date: &quot;enter date here&quot;
output: html_document
---</code></pre>
<div id="instructions-1" class="section level4">
<h4><span class="header-section-number">2.5.2.1</span> Instructions</h4>
<p>For this lab you will modify this file and submit this file with the file name changed so it has your email ID (the part before @) in lower case instead of “email.” Do not add spaces to the file name.</p>
<p>This is a markdown document. You will type your code and run it one line at a time as you add it in the lines indicated below. Add code <strong>ONLY</strong> in the areas between “```{r}” and “```”. These areas are highlighted with a light grey color. Run each line and parts to learn and experiment until you get the result you want. Keep the lines that worked and move on. At any time you can see if your document “knits” or not by clicking on the Knit HTML icon at the top. Once you have completed all work, knit your document and save the html file produced with the same file name but with an html extension (Lab05email.html).</p>
<p><strong>Submit BOTH files for your lab report using the appropriate Canvas tool</strong></p>
<p>For each part and question below, type your code in the grey areas, between the sets of back-ticks (```) to perform the desired computation and get output. Type your answers <strong>below</strong> the corresponding grey area.</p>
<p>In this exercise we analyze the data resulting from an experiment that measured the concentration of protein in cow’s milk as a function of diet and period of lactation. Period of lactation are sets of 5 weeks starting on the date of the calf’s birth, and are labeled A-D. The data are modified from the <code>Milk</code> dataset that comes with Base R. For the purpose of this exercise we assume that each row of data comes from a different cow.</p>
<p>This exercise has four parts. First, we read in and explore the data with some descriptive statistics. We check if we need to use a transformation to normalize the distribution of residuals. Second, each observation is partitioned into the components indicated by the ANOVA model and then the corresponding sums of squares (SS) and degreees of freedom (df) are computed. The ANOVA table and tests are done with the resulting values of SS and dfe. Third, we repeat the analysis using pre-existing R functions to do the ANOVA tables and tests direclty. Finally, we calculate confidence intervals for treatment means an back-transform them to be able to interpret results in the original units of milk protein.</p>
</div>
<div id="part-1.-inspection-and-summary-of-data-25-points-1" class="section level4">
<h4><span class="header-section-number">2.5.2.2</span> Part 1. Inspection and summary of data [25 points]</h4>
<p>Get a histogram of the data. Make a graph showing boxplots of the data for each treatment. Notice that the data have a highly skewed distribution, so a logarithmic transformation is necessary. We will create a new column called logProt that contains the log of milk protein content after subtracting 2.64%. Then we will plot histograms and boxplots of the new variable, inspect the boxplots and determine if there appear to be any effects of treatments (lactation period and diet) the concentration of protein in the milk. We create a table of averages and standard errors by treatment.</p>
<p>In the first R chunk we read in the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># milk.prot &lt;- read.csv(file = &quot;milk.prot.txt&quot;, header = TRUE)</span>

milk.prot &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">text =</span> <span class="st">&quot;</span>
<span class="st">Treatment Period Diet protein</span>
<span class="st">bar+lupA A bar+lup 3.16247700898787</span>
<span class="st">bar+lupA A bar+lup 3.08724498141275</span>
<span class="st">bar+lupA A bar+lup 3.46609229309978</span>
<span class="st">bar+lupA A bar+lup 3.6114421162452</span>
<span class="st">bar+lupA A bar+lup 3.46406702334731</span>
<span class="st">bar+lupA A bar+lup 3.36414430399419</span>
<span class="st">bar+lupA A bar+lup 3.45400121050413</span>
<span class="st">bar+lupA A bar+lup 3.19441594578852</span>
<span class="st">bar+lupA A bar+lup 3.35326928628574</span>
<span class="st">bar+lupA A bar+lup 3.22934381716112</span>
<span class="st">bar+lupA A bar+lup 3.33543175929905</span>
<span class="st">bar+lupA A bar+lup 3.5461325365186</span>
<span class="st">bar+lupA A bar+lup 3.33014969744167</span>
<span class="st">bar+lupA A bar+lup 3.27738459138318</span>
<span class="st">bar+lupA A bar+lup 3.61608739128879</span>
<span class="st">bar+lupA A bar+lup 3.57269856794826</span>
<span class="st">bar+lupA A bar+lup 3.57269856794826</span>
<span class="st">bar+lupA A bar+lup 3.56377228768805</span>
<span class="st">bar+lupA A bar+lup 3.62309023649696</span>
<span class="st">bar+lupA A bar+lup 3.38815934301783</span>
<span class="st">bar+lupA A bar+lup 3.39003264549302</span>
<span class="st">bar+lupA A bar+lup 3.69796748620264</span>
<span class="st">bar+lupA A bar+lup 3.5593358550955</span>
<span class="st">bar+lupA A bar+lup 3.37515060805783</span>
<span class="st">bar+lupA A bar+lup 3.93172455189781</span>
<span class="st">bar+lupA A bar+lup 3.81254081175683</span>
<span class="st">bar+lupA A bar+lup 3.7723438892983</span>
<span class="st">bar+lupB B bar+lup 3.24936791495157</span>
<span class="st">bar+lupB B bar+lup 3.21695450412385</span>
<span class="st">bar+lupB B bar+lup 3.24071829671401</span>
<span class="st">bar+lupB B bar+lup 3.26162361847266</span>
<span class="st">bar+lupB B bar+lup 3.11788028618845</span>
<span class="st">bar+lupB B bar+lup 3.26338848183654</span>
<span class="st">bar+lupB B bar+lup 3.1938468686581</span>
<span class="st">bar+lupB B bar+lup 3.21028616958602</span>
<span class="st">bar+lupB B bar+lup 3.54647855732033</span>
<span class="st">bar+lupB B bar+lup 3.25635015740983</span>
<span class="st">bar+lupB B bar+lup 3.55349802155413</span>
<span class="st">bar+lupB B bar+lup 3.23045228530264</span>
<span class="st">bar+lupB B bar+lup 3.60873626268452</span>
<span class="st">bar+lupB B bar+lup 3.14492519743976</span>
<span class="st">bar+lupB B bar+lup 3.32176884990615</span>
<span class="st">bar+lupB B bar+lup 3.39612749347632</span>
<span class="st">bar+lupB B bar+lup 3.32743600301904</span>
<span class="st">bar+lupB B bar+lup 3.51427222456755</span>
<span class="st">bar+lupB B bar+lup 3.57242380725101</span>
<span class="st">bar+lupB B bar+lup 3.55584721786233</span>
<span class="st">bar+lupB B bar+lup 3.62356902754425</span>
<span class="st">bar+lupB B bar+lup 3.37401840989471</span>
<span class="st">bar+lupB B bar+lup 3.50748741046134</span>
<span class="st">bar+lupB B bar+lup 3.53256534972504</span>
<span class="st">bar+lupB B bar+lup 3.71373258501917</span>
<span class="st">bar+lupB B bar+lup 3.26515687845922</span>
<span class="st">bar+lupB B bar+lup 3.95140962311483</span>
<span class="st">bar+lupC C bar+lup 3.21581657493573</span>
<span class="st">bar+lupC C bar+lup 3.44800859079776</span>
<span class="st">bar+lupC C bar+lup 3.05291167767717</span>
<span class="st">bar+lupC C bar+lup 3.01560466016744</span>
<span class="st">bar+lupC C bar+lup 3.26808563987888</span>
<span class="st">bar+lupC C bar+lup 3.15847493306766</span>
<span class="st">bar+lupC C bar+lup 3.44582631217777</span>
<span class="st">bar+lupC C bar+lup 3.3480301686479</span>
<span class="st">bar+lupC C bar+lup 3.18789847677067</span>
<span class="st">bar+lupC C bar+lup 3.6660333640695</span>
<span class="st">bar+lupC C bar+lup 3.11627883449707</span>
<span class="st">bar+lupC C bar+lup 3.39059231774347</span>
<span class="st">bar+lupC C bar+lup 3.6171777865758</span>
<span class="st">bar+lupC C bar+lup 3.45019523834246</span>
<span class="st">bar+lupC C bar+lup 3.24868037494299</span>
<span class="st">bar+lupC C bar+lup 3.45019523834246</span>
<span class="st">bar+lupC C bar+lup 3.57745198893342</span>
<span class="st">bar+lupC C bar+lup 3.19668177573324</span>
<span class="st">bar+lupC C bar+lup 3.16979172595156</span>
<span class="st">bar+lupC C bar+lup 3.44582631217777</span>
<span class="st">bar+lupC C bar+lup 3.29211669426641</span>
<span class="st">bar+lupC C bar+lup 3.78656131482943</span>
<span class="st">bar+lupC C bar+lup 3.50630722143868</span>
<span class="st">bar+lupC C bar+lup 3.92757897670371</span>
<span class="st">bar+lupC C bar+lup 3.35250536604907</span>
<span class="st">bar+lupC C bar+lup 3.73321160451148</span>
<span class="st">bar+lupC C bar+lup 3.18831464115259</span>
<span class="st">bar+lupD D bar+lup 3.12623709074007</span>
<span class="st">bar+lupD D bar+lup 3.17169459716754</span>
<span class="st">bar+lupD D bar+lup 3.39124380992673</span>
<span class="st">bar+lupD D bar+lup 3.53688468513483</span>
<span class="st">bar+lupD D bar+lup 3.37943092312895</span>
<span class="st">bar+lupD D bar+lup 3.4375038999136</span>
<span class="st">bar+lupD D bar+lup 3.37008635578213</span>
<span class="st">bar+lupD D bar+lup 3.51248690170277</span>
<span class="st">bar+lupD D bar+lup 3.24861665707967</span>
<span class="st">bar+lupD D bar+lup 4.19483265796442</span>
<span class="st">bar+lupD D bar+lup 3.75315138527902</span>
<span class="st">bar+lupD D bar+lup 3.19021008845822</span>
<span class="st">bar+lupD D bar+lup 3.00565324979326</span>
<span class="st">bar+lupD D bar+lup 3.39601046509553</span>
<span class="st">bar+lupD D bar+lup 3.75315138527902</span>
<span class="st">bar+lupD D bar+lup 3.74987334137213</span>
<span class="st">bar+lupD D bar+lup 4.01863236126144</span>
<span class="st">barleyA A barley 3.21958971793313</span>
<span class="st">barleyA A barley 3.40301871623453</span>
<span class="st">barleyA A barley 3.50152934825351</span>
<span class="st">barleyA A barley 3.2777551240594</span>
<span class="st">barleyA A barley 3.35527902404323</span>
<span class="st">barleyA A barley 3.29381369336062</span>
<span class="st">barleyA A barley 3.45720753257547</span>
<span class="st">barleyA A barley 3.43583176700737</span>
<span class="st">barleyA A barley 3.6589813362789</span>
<span class="st">barleyA A barley 3.46626662788544</span>
<span class="st">barleyA A barley 3.4093965937507</span>
<span class="st">barleyA A barley 3.40641429773502</span>
<span class="st">barleyA A barley 3.78479439947903</span>
<span class="st">barleyA A barley 3.61572576157793</span>
<span class="st">barleyA A barley 3.54012447891671</span>
<span class="st">barleyA A barley 3.74371163446542</span>
<span class="st">barleyA A barley 3.74371163446542</span>
<span class="st">barleyA A barley 3.58646003246399</span>
<span class="st">barleyA A barley 3.77256589988619</span>
<span class="st">barleyA A barley 3.67901802958386</span>
<span class="st">barleyA A barley 3.93595317757239</span>
<span class="st">barleyA A barley 3.93871620603499</span>
<span class="st">barleyA A barley 3.78233890699106</span>
<span class="st">barleyA A barley 3.75325288164326</span>
<span class="st">barleyA A barley 3.62423901528139</span>
<span class="st">barleyB B barley 3.12248643668717</span>
<span class="st">barleyB B barley 3.1833831655686</span>
<span class="st">barleyB B barley 3.19651323869693</span>
<span class="st">barleyB B barley 3.23890704839903</span>
<span class="st">barleyB B barley 3.35588423809517</span>
<span class="st">barleyB B barley 3.2083844872523</span>
<span class="st">barleyB B barley 3.46802834620995</span>
<span class="st">barleyB B barley 3.5475869572146</span>
<span class="st">barleyB B barley 3.55194409350653</span>
<span class="st">barleyB B barley 3.45800307265941</span>
<span class="st">barleyB B barley 3.39242637826698</span>
<span class="st">barleyB B barley 3.32422300702216</span>
<span class="st">barleyB B barley 3.51335024348643</span>
<span class="st">barleyB B barley 3.65234582572941</span>
<span class="st">barleyB B barley 3.58743578295748</span>
<span class="st">barleyB B barley 3.74903315029059</span>
<span class="st">barleyB B barley 3.63342772094056</span>
<span class="st">barleyB B barley 3.32942104357986</span>
<span class="st">barleyB B barley 3.66011818640367</span>
<span class="st">barleyB B barley 3.3139200324209</span>
<span class="st">barleyB B barley 3.56071082643042</span>
<span class="st">barleyB B barley 3.89886362429008</span>
<span class="st">barleyB B barley 3.56291349001264</span>
<span class="st">barleyB B barley 3.70284894926828</span>
<span class="st">barleyB B barley 3.83694690162881</span>
<span class="st">barleyC C barley 3.24984772541843</span>
<span class="st">barleyC C barley 3.02806867166766</span>
<span class="st">barleyC C barley 2.97722909449215</span>
<span class="st">barleyC C barley 3.3042385914231</span>
<span class="st">barleyC C barley 3.26432739051296</span>
<span class="st">barleyC C barley 3.36964715879539</span>
<span class="st">barleyC C barley 3.38443727877473</span>
<span class="st">barleyC C barley 3.14986995607598</span>
<span class="st">barleyC C barley 3.15828711751181</span>
<span class="st">barleyC C barley 3.55489711476464</span>
<span class="st">barleyC C barley 3.61838457145728</span>
<span class="st">barleyC C barley 3.61605541224996</span>
<span class="st">barleyC C barley 3.33061250616517</span>
<span class="st">barleyC C barley 3.40898170288263</span>
<span class="st">barleyC C barley 3.80163517433127</span>
<span class="st">barleyC C barley 3.80433586446984</span>
<span class="st">barleyC C barley 3.23523496727666</span>
<span class="st">barleyC C barley 3.65870138900657</span>
<span class="st">barleyC C barley 3.34611225223677</span>
<span class="st">barleyC C barley 3.75393510087424</span>
<span class="st">barleyC C barley 3.55269480358039</span>
<span class="st">barleyC C barley 3.61431159731975</span>
<span class="st">barleyC C barley 4.05801921547774</span>
<span class="st">barleyC C barley 4.16070303427735</span>
<span class="st">barleyC C barley 4.07739981710658</span>
<span class="st">barleyD D barley 3.34998211701732</span>
<span class="st">barleyD D barley 3.27810352281012</span>
<span class="st">barleyD D barley 3.13268376425181</span>
<span class="st">barleyD D barley 3.62959693702492</span>
<span class="st">barleyD D barley 3.23145524255033</span>
<span class="st">barleyD D barley 3.72418401852007</span>
<span class="st">barleyD D barley 3.41265614968261</span>
<span class="st">barleyD D barley 3.86239745579332</span>
<span class="st">barleyD D barley 3.34736464607758</span>
<span class="st">barleyD D barley 3.54516881896749</span>
<span class="st">barleyD D barley 3.36520307449937</span>
<span class="st">barleyD D barley 4.05014583644687</span>
<span class="st">barleyD D barley 3.82716258843302</span>
<span class="st">barleyD D barley 3.90530736258486</span>
<span class="st">barleyD D barley 3.53297348054545</span>
<span class="st">barleyD D barley 3.71839474054614</span>
<span class="st">barleyD D barley 4.53054760216554</span>
<span class="st">lupinsA A lupins 2.95603029280222</span>
<span class="st">lupinsA A lupins 3.17289912491032</span>
<span class="st">lupinsA A lupins 3.2108375205081</span>
<span class="st">lupinsA A lupins 3.14859988098279</span>
<span class="st">lupinsA A lupins 3.22389375887796</span>
<span class="st">lupinsA A lupins 3.0897690493546</span>
<span class="st">lupinsA A lupins 3.26433959404596</span>
<span class="st">lupinsA A lupins 3.1713575354305</span>
<span class="st">lupinsA A lupins 3.41003766428486</span>
<span class="st">lupinsA A lupins 3.34372591926749</span>
<span class="st">lupinsA A lupins 3.43453941314132</span>
<span class="st">lupinsA A lupins 3.17909640732043</span>
<span class="st">lupinsA A lupins 3.60897167260467</span>
<span class="st">lupinsA A lupins 3.45541156047723</span>
<span class="st">lupinsA A lupins 3.38611695701222</span>
<span class="st">lupinsA A lupins 3.44492330687577</span>
<span class="st">lupinsA A lupins 3.45752182649412</span>
<span class="st">lupinsA A lupins 3.77937948894192</span>
<span class="st">lupinsA A lupins 3.99600309156165</span>
<span class="st">lupinsA A lupins 3.65073736963817</span>
<span class="st">lupinsA A lupins 3.50724127766915</span>
<span class="st">lupinsA A lupins 3.39800554938786</span>
<span class="st">lupinsA A lupins 3.28707199749165</span>
<span class="st">lupinsA A lupins 3.67088861428483</span>
<span class="st">lupinsA A lupins 3.31587400920237</span>
<span class="st">lupinsA A lupins 4.13921452740736</span>
<span class="st">lupinsA A lupins 4.1993184650446</span>
<span class="st">lupinsB B lupins 3.05903881648069</span>
<span class="st">lupinsB B lupins 3.06059630293279</span>
<span class="st">lupinsB B lupins 2.99635917438271</span>
<span class="st">lupinsB B lupins 3.11378054556574</span>
<span class="st">lupinsB B lupins 3.0466904311162</span>
<span class="st">lupinsB B lupins 2.98641495493623</span>
<span class="st">lupinsB B lupins 2.90540540400742</span>
<span class="st">lupinsB B lupins 3.02257855521687</span>
<span class="st">lupinsB B lupins 3.30836577833734</span>
<span class="st">lupinsB B lupins 3.1154476250325</span>
<span class="st">lupinsB B lupins 3.07316897172911</span>
<span class="st">lupinsB B lupins 3.23128235620088</span>
<span class="st">lupinsB B lupins 3.26611304512492</span>
<span class="st">lupinsB B lupins 3.15647431931853</span>
<span class="st">lupinsB B lupins 3.36971049805063</span>
<span class="st">lupinsB B lupins 3.50360828445366</span>
<span class="st">lupinsB B lupins 3.4164069900062</span>
<span class="st">lupinsB B lupins 3.35029034810974</span>
<span class="st">lupinsB B lupins 3.43702801495283</span>
<span class="st">lupinsB B lupins 3.2199479989707</span>
<span class="st">lupinsB B lupins 3.609408606032</span>
<span class="st">lupinsB B lupins 4.57193094248879</span>
<span class="st">lupinsB B lupins 3.51589495753408</span>
<span class="st">lupinsB B lupins 3.64303555480527</span>
<span class="st">lupinsB B lupins 3.21433162140314</span>
<span class="st">lupinsB B lupins 3.73014980454211</span>
<span class="st">lupinsB B lupins 3.92145079924361</span>
<span class="st">lupinsC C lupins 3.06590780468262</span>
<span class="st">lupinsC C lupins 3.02059230996939</span>
<span class="st">lupinsC C lupins 2.86743593436082</span>
<span class="st">lupinsC C lupins 2.89494446060554</span>
<span class="st">lupinsC C lupins 3.04780205976617</span>
<span class="st">lupinsC C lupins 3.17953007221293</span>
<span class="st">lupinsC C lupins 3.19286293885429</span>
<span class="st">lupinsC C lupins 3.22603060060185</span>
<span class="st">lupinsC C lupins 3.0805972658309</span>
<span class="st">lupinsC C lupins 3.25624750596647</span>
<span class="st">lupinsC C lupins 3.33257618780012</span>
<span class="st">lupinsC C lupins 3.6250333091386</span>
<span class="st">lupinsC C lupins 3.06799059326193</span>
<span class="st">lupinsC C lupins 3.21419538670027</span>
<span class="st">lupinsC C lupins 3.39122240348853</span>
<span class="st">lupinsC C lupins 3.43364747957442</span>
<span class="st">lupinsC C lupins 3.22404818913958</span>
<span class="st">lupinsC C lupins 3.15112175078154</span>
<span class="st">lupinsC C lupins 2.93863888085488</span>
<span class="st">lupinsC C lupins 3.40519473867389</span>
<span class="st">lupinsC C lupins 3.570483577836</span>
<span class="st">lupinsC C lupins 3.37513185317005</span>
<span class="st">lupinsC C lupins 3.85341302609114</span>
<span class="st">lupinsC C lupins 3.26291484346087</span>
<span class="st">lupinsC C lupins 3.71106031119639</span>
<span class="st">lupinsC C lupins 3.37970618982359</span>
<span class="st">lupinsC C lupins 3.26034535288705</span>
<span class="st">lupinsD D lupins 2.84223981242853</span>
<span class="st">lupinsD D lupins 2.88396586957888</span>
<span class="st">lupinsD D lupins 3.06592157327319</span>
<span class="st">lupinsD D lupins 3.15478932401863</span>
<span class="st">lupinsD D lupins 3.4110674466176</span>
<span class="st">lupinsD D lupins 3.27648807200425</span>
<span class="st">lupinsD D lupins 3.32507280585903</span>
<span class="st">lupinsD D lupins 3.42603743847819</span>
<span class="st">lupinsD D lupins 3.19290053993781</span>
<span class="st">lupinsD D lupins 3.5296744345488</span>
<span class="st">lupinsD D lupins 3.09821010221529</span>
<span class="st">lupinsD D lupins 2.97601302622587</span>
<span class="st">lupinsD D lupins 3.62808203709135</span>
<span class="st">lupinsD D lupins 3.16417469088188</span>
<span class="st">lupinsD D lupins 3.2452918380361</span>
<span class="st">lupinsD D lupins 3.82744489060173</span>
<span class="st">&quot;</span>)</code></pre></div>
<p>We then look at the structure of the data frame to make sure the data were read correctly, and we make a boxplot and a histogram of milk.prot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Look at the data</span>

<span class="kw">str</span>(milk.prot) <span class="co"># Note the column that has our dependent variable</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    287 obs. of  4 variables:
##  $ Treatment: Factor w/ 12 levels &quot;bar+lupA&quot;,&quot;bar+lupB&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Period   : Factor w/ 4 levels &quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Diet     : Factor w/ 3 levels &quot;bar+lup&quot;,&quot;barley&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ protein  : num  3.16 3.09 3.47 3.61 3.46 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(protein <span class="op">~</span><span class="st"> </span>Treatment, milk.prot)</code></pre></div>
<p><img src="09.0_Anova1_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Obtain a histogram of the data for milk protein concentration.</span>

<span class="kw">hist</span>(milk.prot<span class="op">$</span>protein) <span class="co"># Distribution is slightly skewed</span></code></pre></div>
<p><img src="09.0_Anova1_files/figure-html/unnamed-chunk-17-2.png" width="672" /></p>
<p>Note how the distribution of milk protein is skewed with a slightly long right tail. The data model we will use for the ANOVA requires that the <em>residuals</em> be normally distributed, not the original data. Therefore, a proper check of normality must be applied on the residuals after removing treatment effects. R has a functions called <code>residuals</code> that extracts the residuals from the linear model object.</p>
<p>The model for a Completely Randomized Design (CRD) is</p>
<p><span class="math display">\[Y_{ij} = \mu_{..} + \tau_i + \epsilon_{ij}\]</span> where <span class="math inline">\(Y_{ij}\)</span> is the observation (percent milk protein for a cow in a period) for treatment i and replicate j, <span class="math inline">\(\mu_{..}\)</span> is the overall mean, <span class="math inline">\(\tau_i\)</span> is the effect of treatment i and <span class="math inline">\(\epsilon_{ij}\)</span> is a random error with identical independent normal distributions for all replicates and treatments, which is written as</p>
<p><span class="math display">\[\epsilon_{ij} \sim iid \quad N(0,\sigma) \quad \forall \quad i, j\]</span></p>
<p>A histogram of the residuals of the model with treatments can be obtained in one line of code as follows. Note how functions can be nested, and they are calculated from the inside out.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(
   <span class="kw">residuals</span>(
      <span class="kw">lm</span>(protein <span class="op">~</span><span class="st"> </span>Treatment,
         <span class="dt">data =</span> milk.prot)
   )
)</code></pre></div>
<p><img src="09.0_Anova1_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Residuals are slightly skewed. A logarithmic transformation seems to do the trick, yielding residuals that are more normal. Note that we subtract 2.64 from each observation to improve the effect of the transformation. In symbols, the transformation is</p>
<p><span class="math display">\[Z_{ij} = \log(Y_{ij} - 2.64)\]</span></p>
<p>where <span class="math inline">\(Z_{ij}\)</span> is called logProt in the R environment.</p>
<p>Transformations of original variables can be very useful to meet the assumptions necessary for inference with many models. This is a topic that requires specific treatment, but for now we note that a log transformation seems to work.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk.prot<span class="op">$</span>logProt &lt;-<span class="st"> </span><span class="kw">log</span>(milk.prot<span class="op">$</span>protein <span class="op">-</span><span class="st"> </span><span class="fl">2.64</span>)

<span class="kw">hist</span>(
   <span class="kw">residuals</span>(
      <span class="kw">lm</span>(logProt <span class="op">~</span><span class="st"> </span>Treatment,
         <span class="dt">data =</span> milk.prot)
   )
)</code></pre></div>
<p><img src="09.0_Anova1_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>A boxplot of the transformed protein content by treatment allows us to look for trends in the results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(logProt <span class="op">~</span><span class="st"> </span>Treatment, 
        <span class="dt">data =</span> milk.prot, 
        <span class="dt">ylab =</span> <span class="st">&#39;log protein %&#39;</span>)</code></pre></div>
<p><img src="09.0_Anova1_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p><br />
<strong>ANSWER THE FOLLOWING QUESTIONS:</strong></p>
<p>Inspect the boxplot. What treatments appear to differ? What would you expect to see based on the hypotheses and previous knowledge? Do the data appear to support your expectations?</p>
<p><br />
<br />
The descriptive statistics for these data are augmented with a table of averages, medians and standard errors for each treatment. Keep in mind that we are working with the transformed variable, so we include back-transformed values that are in units of percent milk protein. The back transformation equation is</p>
<p><span class="math display">\[\bar{Y}_i. = \exp(\bar{Z}_i.) + 2.64\]</span></p>
<p>where <span class="math inline">\(\bar{Z}_i.\)</span> is the treatment average for the transformed variable. Transformations of reponse and predictor variables can be extremely useful to statistical modeling in general and in particular to meet the assumptions necessary to do inference in ANOVA. Recall that <a href="#InferenceEstimation">inference</a> means to make statistical statements about populations and their parameters based on samples.</p>
<p>To obtain descriptive statistics we will use the <code>aggregate</code> function. This is a versatile function that aggregates the data into groups defined by a formula and applies a predefined or a custom-built formula to obtain one result for each group. The custom function can be specified directly inside <code>aggregate</code>. Below, <code>smeans</code> is a dataframe that has two columns: one for treatment names and the other with the mean <code>logProt</code> for each treatment. The <code>formula =</code> argument tells R what variable is to be aggregated (logProt) and what variable to use as grouping factor (Treatment). These variables are to be found in the dataframe specified by <code>data =</code>. Each group will be processed with the functions <code>mean</code>, <code>median</code> and a function created inside the <code>aggregate</code> call to calculate the standard error, as specified in <code>FUN =</code> ardument. Recall that the standard error is the square root of the variance of an average, and that the variance of an average is the variance of the original random variable (logProt) divided by the sample size.</p>
<p><span class="math display">\[V[\bar{X}] = \frac{V[X]}{n}\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Read help about aggregate() function to understand syntax.</span>

smeans &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="dt">formula =</span> logProt <span class="op">~</span><span class="st"> </span>Treatment, 
                    <span class="dt">data =</span> milk.prot, 
                    <span class="dt">FUN =</span> mean)

smedians &lt;-<span class="st"> </span><span class="kw">aggregate</span>(logProt <span class="op">~</span><span class="st"> </span>Treatment, 
                      <span class="dt">data =</span> milk.prot, 
                      <span class="dt">FUN =</span> median)

<span class="co"># Use the aggregate() function to get the standard error of the average for each treatment. Note that the function applied gets the standard deviation and divides it by the square root of the sample size to get the standard error.</span>

sserrors &lt;-<span class="st"> </span><span class="kw">aggregate</span>(logProt <span class="op">~</span><span class="st"> </span>Treatment, 
                      <span class="dt">data =</span> milk.prot, 
                      <span class="dt">FUN =</span> <span class="cf">function</span>(x) <span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">length</span>(x)))</code></pre></div>
<p>For the calculation of the standard errors (the square root of the variance of each group average) we had to use a custom function defined inside <code>agregate</code> and using the <code>function</code> function where x is the set of values for protein in each treatment group.</p>
<p>Part 1 is completed by creating a table with the values calculated above and the back-transformed treatment averages. In the first line of code, the separate dataframes created for averages, standard errors and medians are joined as columns with <code>cbind</code>, and only columns 1, 2, 4 and 6 are kept. This removes the redundant column for treatments, which is present in each original dataframe. If you want to see the redundant column, see what happens if you remove the <code>[, c(1, 2, 4, 6)]</code> part of the code.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">table.milk.prot &lt;-<span class="st"> </span><span class="kw">cbind</span>(smeans, sserrors, smedians)[, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)]

<span class="kw">names</span>(table.milk.prot) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Treatment&quot;</span>, 
                            <span class="st">&quot;Mean.log&quot;</span>, 
                            <span class="st">&quot;SE.log&quot;</span>, 
                            <span class="st">&quot;Median.log&quot;</span>)

table.milk.prot<span class="op">$</span>Mean.Prot &lt;-<span class="st"> </span><span class="kw">exp</span>(table.milk.prot<span class="op">$</span>Mean.log) <span class="op">+</span><span class="st"> </span><span class="fl">2.64</span>

<span class="kw">pander</span>(table.milk.prot)</code></pre></div>
<table style="width:82%;">
<colgroup>
<col width="16%" />
<col width="15%" />
<col width="13%" />
<col width="18%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Treatment</th>
<th align="center">Mean.log</th>
<th align="center">SE.log</th>
<th align="center">Median.log</th>
<th align="center">Mean.Prot</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">bar+lupA</td>
<td align="center">-0.2137</td>
<td align="center">0.04886</td>
<td align="center">-0.1935</td>
<td align="center">3.448</td>
</tr>
<tr class="even">
<td align="center">bar+lupB</td>
<td align="center">-0.3092</td>
<td align="center">0.04933</td>
<td align="center">-0.3748</td>
<td align="center">3.374</td>
</tr>
<tr class="odd">
<td align="center">bar+lupC</td>
<td align="center">-0.3478</td>
<td align="center">0.06011</td>
<td align="center">-0.339</td>
<td align="center">3.346</td>
</tr>
<tr class="even">
<td align="center">bar+lupD</td>
<td align="center">-0.2368</td>
<td align="center">0.09285</td>
<td align="center">-0.2797</td>
<td align="center">3.429</td>
</tr>
<tr class="odd">
<td align="center">barleyA</td>
<td align="center">-0.08998</td>
<td align="center">0.04452</td>
<td align="center">-0.05503</td>
<td align="center">3.554</td>
</tr>
<tr class="even">
<td align="center">barleyB</td>
<td align="center">-0.2039</td>
<td align="center">0.05242</td>
<td align="center">-0.1354</td>
<td align="center">3.456</td>
</tr>
<tr class="odd">
<td align="center">barleyC</td>
<td align="center">-0.2217</td>
<td align="center">0.07806</td>
<td align="center">-0.2627</td>
<td align="center">3.441</td>
</tr>
<tr class="even">
<td align="center">barleyD</td>
<td align="center">-0.08406</td>
<td align="center">0.08466</td>
<td align="center">-0.09963</td>
<td align="center">3.559</td>
</tr>
<tr class="odd">
<td align="center">lupinsA</td>
<td align="center">-0.2884</td>
<td align="center">0.07114</td>
<td align="center">-0.2771</td>
<td align="center">3.389</td>
</tr>
<tr class="even">
<td align="center">lupinsB</td>
<td align="center">-0.4796</td>
<td align="center">0.08738</td>
<td align="center">-0.5255</td>
<td align="center">3.259</td>
</tr>
<tr class="odd">
<td align="center">lupinsC</td>
<td align="center">-0.5544</td>
<td align="center">0.07922</td>
<td align="center">-0.5344</td>
<td align="center">3.214</td>
</tr>
<tr class="even">
<td align="center">lupinsD</td>
<td align="center">-0.5891</td>
<td align="center">0.1207</td>
<td align="center">-0.5473</td>
<td align="center">3.195</td>
</tr>
</tbody>
</table>
<p>The same information can be displayed graphically with a bar plot, where the hight of the bars represents milk proteni content for each treatment, with error bars at the top.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(table.milk.prot, 
       <span class="kw">aes</span>(Treatment, Mean.log)) <span class="op">+</span><span class="st"> </span>
<span class="st">   </span><span class="kw">geom_col</span>() <span class="op">+</span><span class="st">  </span>
<span class="st">   </span><span class="kw">geom_errorbar</span>(
      <span class="kw">aes</span>(
         <span class="dt">ymin =</span> Mean.log <span class="op">-</span><span class="st"> </span>SE.log, 
         <span class="dt">ymax =</span> Mean.log <span class="op">+</span><span class="st"> </span>SE.log), 
      <span class="dt">width =</span> <span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">   </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Log of protein ± s.e.&quot;</span>, 
        <span class="dt">x =</span> <span class="st">&quot;Treatment&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">   </span><span class="kw">theme_classic</span>()</code></pre></div>
<p><img src="09.0_Anova1_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p><br />
<br />
<strong>ANSWER THE FOLLOWING QUESTIONS</strong></p>
<p>What does<code>cbind</code> do? What does <code>aggregate</code> do?</p>
</div>
<div id="part-2.-partition-of-sum-of-squares-and-degrees-of-freedom-30-points-1" class="section level4">
<h4><span class="header-section-number">2.5.2.3</span> Part 2. Partition of Sum of Squares and Degrees of Freedom [30 points]</h4>
<p>Now, we use basic functions to partition the total sum of squares of logProt into treatments and residual or error. The purpose of doing this is for you to undersand the calculations in some detail, without having to actually use a calculator. Start by creating a column with treatment averages for each observation. This column will have a repeating number for all observations in a treatment. We calculate the total sum of squares as the sum of squares of deviations from each observation to the overall average:</p>
<p><span class="math display">\[total \ deviation = Y_{ij} - \bar{Y}_{..}\]</span> <span class="math display">\[total \ sum \ of \ squares = TSS = \displaystyle\sum_{i=1}^{k} \displaystyle\sum_{j=1}^{r} \ \left(Y_{ij} - \bar{Y}_{..} \right)^2 \]</span></p>
<p>Treatment sum of squares is the sum of squared deviations from the treatment average to the overall average, for all observations. This deviation is the estimated <em>treatment effect</em> <span class="math inline">\(\hat\tau_i\)</span>.</p>
<p><span class="math display">\[sum \ of \ squares \ of \ treatments= SST =  \displaystyle\sum_{i=1}^{k} \displaystyle\sum_{j=1}^{r}  \hat\tau_i^2  = \displaystyle\sum_{i=1}^{k} \displaystyle\sum_{j=1}^{r} \left( \bar{Y}_{i.} - \bar{Y}_{..} \right)^2\]</span></p>
<p>We calculate the corresponding degrees of freedom and prepare a complete analysis of variance table with columns for Source, SS, df, and MS. Results are put into a data frame and printed neatly with <code>pander</code>. By calculating the F test and the critical F we are able to test the Ho: mean protein content is the same in all treatments.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(smeans)[<span class="dv">2</span>] &lt;-<span class="st"> &quot;AvgLogProt&quot;</span>

milk.prot &lt;-<span class="st"> </span><span class="kw">merge</span>(milk.prot, 
              smeans, 
              <span class="dt">by =</span> <span class="st">&quot;Treatment&quot;</span>, 
              <span class="dt">all =</span> <span class="ot">TRUE</span>)

<span class="kw">head</span>(milk.prot)</code></pre></div>
<pre><code>##   Treatment Period    Diet     protein        logProt    AvgLogProt
## 1  bar+lupA      A bar+lup 3.162477009 -0.64917429805 -0.2136694149
## 2  bar+lupA      A bar+lup 3.087244981 -0.80464877765 -0.2136694149
## 3  bar+lupA      A bar+lup 3.466092293 -0.19104877672 -0.2136694149
## 4  bar+lupA      A bar+lup 3.611442116 -0.02897359378 -0.2136694149
## 5  bar+lupA      A bar+lup 3.464067023 -0.19350341337 -0.2136694149
## 6  bar+lupA      A bar+lup 3.364144304 -0.32276459155 -0.2136694149</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Total sum of squares:</span>
<span class="co"># total deviation of observations from the overall average</span>
ssTot &lt;-<span class="st"> </span><span class="kw">sum</span>((milk.prot<span class="op">$</span>logProt <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(milk.prot<span class="op">$</span>logProt)) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)

<span class="co"># Treatment sum of squares:</span>
<span class="co"># deviation of treatment average from the overall average</span>
ssTrt &lt;-<span class="st"> </span><span class="kw">sum</span>((milk.prot<span class="op">$</span>AvgLogProt <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(milk.prot<span class="op">$</span>logProt)) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)

<span class="co"># Residual sum of squares:</span>
<span class="co"># deviation of observations from treatment average</span>
ssRes &lt;-<span class="st"> </span><span class="kw">sum</span>((milk.prot<span class="op">$</span>logProt <span class="op">-</span><span class="st"> </span>milk.prot<span class="op">$</span>AvgLogProt) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)</code></pre></div>
<p>Degrees of freedom are calculates as the total number of independent (different) terms in each sum, minus the number of parameters estimated for each sum. In the case of total sum of square, there are as many different terms are there are observations, because each observation is potentially different. Only the overall mean is estimated with the overall average. For the sum of squares of treatments we have as maby different terms as there are treatments, and we use the overall average as estiamate of the overall mean. Because the total degrees of freedom equal the sum of the components, the residual df can be calculated as the total df (n-1) minus treatment df.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df.Trt &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">levels</span>(milk.prot<span class="op">$</span>Treatment)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>

dfe &lt;-<span class="st"> </span><span class="kw">length</span>(milk.prot<span class="op">$</span>AvgLogProt) <span class="op">-</span><span class="st"> </span>df.Trt <span class="op">-</span><span class="st"> </span><span class="dv">1</span>

df.Tot &lt;-<span class="st"> </span>df.Trt <span class="op">+</span><span class="st"> </span>dfe

<span class="co"># Now calculate the means squares</span>

(MSTrt &lt;-<span class="st"> </span>ssTrt <span class="op">/</span><span class="st"> </span>df.Trt)</code></pre></div>
<pre><code>## [1] 0.5973035186</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(MSE &lt;-<span class="st"> </span>ssRes <span class="op">/</span><span class="st"> </span>dfe)</code></pre></div>
<pre><code>## [1] 0.1219057988</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate the F ratio and F critical value</span>

(Fcalc &lt;-<span class="st"> </span>MSTrt <span class="op">/</span><span class="st"> </span>MSE)</code></pre></div>
<pre><code>## [1] 4.899713751</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(Fcrit &lt;-<span class="st"> </span><span class="kw">qf</span>(<span class="fl">0.05</span>, 
             <span class="dt">df1 =</span> df.Trt, 
             <span class="dt">df2 =</span> dfe, 
             <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>))</code></pre></div>
<pre><code>## [1] 1.823568455</code></pre>
<p>ANSWER THE FOLLOWING QUESTIONS:</p>
<p>Are there differences among treatments? State your conclusions.</p>
</div>
<div id="part-3.-anova-using-r-functions.20-points-1" class="section level4">
<h4><span class="header-section-number">2.5.2.4</span> Part 3. ANOVA using R functions.[20 points]</h4>
<p>Use the R functions <code>aov</code> and <code>anova</code> to obtain the same tests of the null hypothesis that all means are equal. Report the results of using each function and compare to the previous results. The purpose of this part is for you to become familiar with different R functions that accomplish the same task. Read the help about the function <code>oneway.test</code> and use it, making sure that all arguments have proper values. Pay particular attention to the assumption of equal variances. Note that this function allows you to do the test even when variances are not equal, but we assume that the variances are equal.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># read help about function aov(), anova(), oneway.test()</span>

<span class="kw">summary</span>(<span class="kw">aov</span>(<span class="dt">formula =</span> logProt <span class="op">~</span><span class="st"> </span>Treatment, 
            <span class="dt">data =</span> milk.prot))</code></pre></div>
<pre><code>##              Df   Sum Sq   Mean Sq F value     Pr(&gt;F)    
## Treatment    11  6.57034 0.5973035 4.89971 6.2391e-07 ***
## Residuals   275 33.52409 0.1219058                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">linear.model1 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> logProt <span class="op">~</span><span class="st"> </span>Treatment, 
                    <span class="dt">data =</span> milk.prot)

<span class="kw">anova</span>(linear.model1)</code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: logProt
##            Df    Sum Sq    Mean Sq F value     Pr(&gt;F)    
## Treatment  11  6.570339 0.59730352 4.89971 6.2391e-07 ***
## Residuals 275 33.524095 0.12190580                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">oneway.test</span>(logProt <span class="op">~</span><span class="st"> </span>Treatment, 
            <span class="dt">data =</span> milk.prot, 
            <span class="dt">var.equal =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## 
##  One-way analysis of means
## 
## data:  logProt and Treatment
## F = 4.8997138, num df = 11, denom df = 275, p-value = 6.239104e-07</code></pre>
<p>ANSWER THE FOLLOWING QUESTION:</p>
<p>Do the results differ among functions? Compare to the results from Part 2 and Part 3.</p>
</div>
<div id="part-4.-confidence-intervals-for-treatment-means-25-points-1" class="section level4">
<h4><span class="header-section-number">2.5.2.5</span> Part 4. Confidence intervals for treatment means [25 points]</h4>
<p>Create 95% confidence intervals for all the treatment means, back-transform to see milk protein content by exponentiating and adding 2.64, then add them to the table created in Part 1. Explain how the line to add the CI’s to the ci.data works.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ci.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Treatment =</span> <span class="kw">levels</span>(milk.prot<span class="op">$</span>Treatment))

ci.data &lt;-<span class="st"> </span><span class="kw">cbind</span>(ci.data, <span class="kw">predict</span>(linear.model1, 
                                  <span class="dt">newdata =</span> ci.data, 
                                  <span class="dt">interval =</span> <span class="st">&quot;confidence&quot;</span>)) 

<span class="kw">str</span>(ci.data)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    12 obs. of  4 variables:
##  $ Treatment: Factor w/ 12 levels &quot;bar+lupA&quot;,&quot;bar+lupB&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ fit      : num  -0.214 -0.309 -0.348 -0.237 -0.09 ...
##  $ lwr      : num  -0.346 -0.441 -0.48 -0.403 -0.227 ...
##  $ upr      : num  -0.0814 -0.1769 -0.2155 -0.0701 0.0475 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Complete the code below to do the back transformation of the CI&#39;s and make a table with them</span>

ci.data.bt &lt;-<span class="st"> </span><span class="kw">exp</span>(ci.data[,<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>]) <span class="op">+</span><span class="st"> </span><span class="fl">2.64</span> <span class="co"># All columns are back transformed one at a time</span>

ci.data.bt<span class="op">$</span>Treatment &lt;-<span class="st"> </span>ci.data<span class="op">$</span>Treatment <span class="co"># add treatment names back</span>


<span class="kw">library</span>(plotrix)
<span class="kw">plotCI</span>(ci.data.bt<span class="op">$</span>fit,
       <span class="dt">uiw =</span> ci.data.bt<span class="op">$</span>upr <span class="op">-</span><span class="st"> </span>ci.data.bt<span class="op">$</span>fit, 
       <span class="dt">liw =</span> ci.data.bt<span class="op">$</span>fit <span class="op">-</span><span class="st"> </span>ci.data.bt<span class="op">$</span>lwr, 
       <span class="dt">ylab =</span> <span class="st">&quot;milk.prot&quot;</span>, 
       <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, 
       <span class="dt">axes =</span> <span class="ot">FALSE</span>)
<span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">2</span>)
<span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">at =</span> <span class="kw">seq_along</span>(ci.data.bt<span class="op">$</span>Treatment), <span class="dt">labels =</span> ci.data.bt<span class="op">$</span>Treatment)</code></pre></div>
<p><img src="09.0_Anova1_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>The confidence interval graph is built first without axes, then the axes are custom-added so we can have treatment names instead of values in the x-axis.</p>
<p>ANSWER THE FOLLOWING QUESTIONS.</p>
<p>Can you conclude that any of the treatments are effective to produce a protein content of 3.4% at least in one period? In other words, do any treatments result in an expected protein content that is significantly greater than 3.4%</p>
<p>Explain the <code>cbind</code> function works.</p>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chAnova.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
