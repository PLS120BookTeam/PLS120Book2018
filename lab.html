<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <meta name="description" content="">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="exercises.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Applied Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="chStatsR.html"><a href="chStatsR.html"><i class="fa fa-check"></i><b>1</b> Statistics with R</a><ul>
<li class="chapter" data-level="1.1" data-path="chStatsR.html"><a href="chStatsR.html#learning-objectives-for-chapter"><i class="fa fa-check"></i><b>1.1</b> Learning Objectives for Chapter</a></li>
<li class="chapter" data-level="1.2" data-path="chStatsR.html"><a href="chStatsR.html#background-on-r-and-rstudio"><i class="fa fa-check"></i><b>1.2</b> Background on R and RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="chStatsR.html"><a href="chStatsR.html#r-basics"><i class="fa fa-check"></i><b>1.3</b> R Basics</a></li>
<li class="chapter" data-level="1.4" data-path="chStatsR.html"><a href="chStatsR.html#exploring-rstudio"><i class="fa fa-check"></i><b>1.4</b> Exploring RStudio</a><ul>
<li class="chapter" data-level="1.4.1" data-path="chStatsR.html"><a href="chStatsR.html#terminal-or-console-window"><i class="fa fa-check"></i><b>1.4.1</b> Terminal or Console Window</a></li>
<li class="chapter" data-level="1.4.2" data-path="chStatsR.html"><a href="chStatsR.html#markdown-source-window"><i class="fa fa-check"></i><b>1.4.2</b> Markdown (Source) Window</a></li>
<li class="chapter" data-level="1.4.3" data-path="chStatsR.html"><a href="chStatsR.html#files-plots-packages-help-window"><i class="fa fa-check"></i><b>1.4.3</b> Files, Plots, Packages, Help Window</a></li>
<li class="chapter" data-level="1.4.4" data-path="chStatsR.html"><a href="chStatsR.html#environment-and-history-window"><i class="fa fa-check"></i><b>1.4.4</b> Environment and History Window</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="chStatsR.html"><a href="chStatsR.html#functions"><i class="fa fa-check"></i><b>1.5</b> Functions</a><ul>
<li class="chapter" data-level="1.5.1" data-path="chStatsR.html"><a href="chStatsR.html#summary-statistics-functions"><i class="fa fa-check"></i><b>1.5.1</b> Summary Statistics Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>2</b> Exercises</a></li>
<li class="chapter" data-level="3" data-path="lab.html"><a href="lab.html"><i class="fa fa-check"></i><b>3</b> Lab</a><ul>
<li class="chapter" data-level="3.1" data-path="lab.html"><a href="lab.html#plant-sciences"><i class="fa fa-check"></i><b>3.1</b> Plant Sciences</a><ul>
<li class="chapter" data-level="3.1.1" data-path="lab.html"><a href="lab.html#introduction-to-r-and-rstudio"><i class="fa fa-check"></i><b>3.1.1</b> Introduction to R and RStudio</a></li>
<li class="chapter" data-level="3.1.2" data-path="lab.html"><a href="lab.html#create-a-dataframe-and-table"><i class="fa fa-check"></i><b>3.1.2</b> Create a dataframe and table</a></li>
<li class="chapter" data-level="3.1.3" data-path="lab.html"><a href="lab.html#summary-statistics"><i class="fa fa-check"></i><b>3.1.3</b> Summary Statistics</a></li>
<li class="chapter" data-level="3.1.4" data-path="lab.html"><a href="lab.html#frequency-table-and-histogram"><i class="fa fa-check"></i><b>3.1.4</b> Frequency Table and Histogram</a></li>
<li class="chapter" data-level="3.1.5" data-path="lab.html"><a href="lab.html#box-and-whisker-plot-and-5-number-summary"><i class="fa fa-check"></i><b>3.1.5</b> Box-and-Whisker Plot and 5-Number Summary</a></li>
<li class="chapter" data-level="3.1.6" data-path="lab.html"><a href="lab.html#analyses-by-groups"><i class="fa fa-check"></i><b>3.1.6</b> Analyses by Groups</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="lab.html"><a href="lab.html#animal-sciences"><i class="fa fa-check"></i><b>3.2</b> Animal Sciences</a><ul>
<li class="chapter" data-level="3.2.1" data-path="lab.html"><a href="lab.html#introduction-to-r-and-rstudio-1"><i class="fa fa-check"></i><b>3.2.1</b> Introduction to R and RStudio</a></li>
<li class="chapter" data-level="3.2.2" data-path="lab.html"><a href="lab.html#create-a-dataframe-and-table-1"><i class="fa fa-check"></i><b>3.2.2</b> Create a dataframe and table</a></li>
<li class="chapter" data-level="3.2.3" data-path="lab.html"><a href="lab.html#summary-statistics-1"><i class="fa fa-check"></i><b>3.2.3</b> Summary Statistics</a></li>
<li class="chapter" data-level="3.2.4" data-path="lab.html"><a href="lab.html#frequency-table-and-histogram-1"><i class="fa fa-check"></i><b>3.2.4</b> Frequency Table and Histogram</a></li>
<li class="chapter" data-level="3.2.5" data-path="lab.html"><a href="lab.html#box-and-whisker-plot-and-5-number-summary-1"><i class="fa fa-check"></i><b>3.2.5</b> Box-and-Whisker Plot and 5-Number Summary</a></li>
<li class="chapter" data-level="3.2.6" data-path="lab.html"><a href="lab.html#analyses-by-groups-1"><i class="fa fa-check"></i><b>3.2.6</b> Analyses by Groups</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lab" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Lab</h1>
<div id="plant-sciences" class="section level2">
<h2><span class="header-section-number">3.1</span> Plant Sciences</h2>
<div id="introduction-to-r-and-rstudio" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Introduction to R and RStudio</h3>
<p>If you are using a lab computer and not your personal computer, insert your flash drive and set the working directory to be in your drive. This way you will have all of your files with you in your drive. Files that you save to the lab computers are wiped every night. The following script chunk allows you to manually select your working directory by selecting a file within it.</p>
<p>Once you have installed the necessary packages, you can render this Rmd file and produce the html file that can be viewed in any browser. <strong>For full credit you will submit both the Rmd and html files you complete.</strong></p>
</div>
<div id="create-a-dataframe-and-table" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Create a dataframe and table</h3>
<p>To create a data frame we use the data.frame() function. In this example we create a data frame named “mydata.” This data frame has 2 columns (Y1 and Y2) and 3 rows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Y1 =</span> <span class="kw">c</span>(<span class="st">&quot;treatment 1&quot;</span>, <span class="st">&quot;treatment 2&quot;</span>, <span class="st">&quot;treatment 3&quot;</span>), <span class="dt">Y2 =</span> <span class="kw">c</span>(<span class="dv">35</span>, <span class="dv">23</span>, <span class="dv">30</span>)) <span class="co"># Create data frame with 2 columns and 3 rows</span>

mydata <span class="co"># see the contents of the data frame</span></code></pre></div>
<pre><code>##            Y1 Y2
## 1 treatment 1 35
## 2 treatment 2 23
## 3 treatment 3 30</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(mydata) <span class="co"># see the structure of the data frame</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    3 obs. of  2 variables:
##  $ Y1: Factor w/ 3 levels &quot;treatment 1&quot;,..: 1 2 3
##  $ Y2: num  35 23 30</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(mydata) <span class="co"># see the class of the data frame</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pander) <span class="co"># we need to install pander first</span>

<span class="kw">pander</span>(mydata, <span class="dt">caption =</span> <span class="st">&quot;Table showing my data.&quot;</span>) <span class="co">#pander() creates a table for the data</span></code></pre></div>
<table style="width:25%;">
<caption>Table showing my data.</caption>
<colgroup>
<col width="19%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Y1</th>
<th align="center">Y2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">treatment 1</td>
<td align="center">35</td>
</tr>
<tr class="even">
<td align="center">treatment 2</td>
<td align="center">23</td>
</tr>
<tr class="odd">
<td align="center">treatment 3</td>
<td align="center">30</td>
</tr>
</tbody>
</table>
</div>
<div id="summary-statistics" class="section level3">
<h3><span class="header-section-number">3.1.3</span> Summary Statistics</h3>
<p>Summary statistics are classified as measures of central tendency and measures of dispersion. Mean, and median are measures of central tendency. Variance, standard deviation, range minimum and maximum are measures of dispersion. For positive random variables, the coefficient of variation is a measure of variation relative to the mean.</p>
<p>We use the <em>clover.txt</em> data set provided in the first assignment. These data represent the mass of clover plants grown for different periods at three different temperatures. Temperatures are in the first column coded as 1 for 5-15 C, 2 for 10-20 C and 3 for 15-25 C. The second column contains the number of days of growth and the last column contains the log of the plant mass in g. Column names are in the first row of the file, so we specify <em>header = TRUE</em> in the line of code to read the data. Data are placed in a data frame named “clover.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">clover &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;Datasets/Lab01clover.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>) <span class="co"># read in data.</span>

<span class="kw">help</span>(clover) <span class="co"># Read about the nature of the data set.</span></code></pre></div>
<pre><code>## No documentation for &#39;clover&#39; in specified packages and libraries:
## you could try &#39;??clover&#39;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(avg.lnwt &lt;-<span class="st"> </span><span class="kw">mean</span>(clover<span class="op">$</span>lnwt)) <span class="co"># obtain the average lnwtance; note the use of $ to select parts of an object and the outer parentheses to display the result.</span></code></pre></div>
<pre><code>## [1] 3.623269</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(med.lnwt &lt;-<span class="st"> </span><span class="kw">median</span>(clover<span class="op">$</span>lnwt)) <span class="co"># median or 50th percentile</span></code></pre></div>
<pre><code>## [1] 3.75324</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quantile</span>(clover<span class="op">$</span>lnwt, <span class="fl">0.5</span>) <span class="co"># 50th percentile is the same as the median</span></code></pre></div>
<pre><code>##     50% 
## 3.75324</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(var.lnwt &lt;-<span class="st"> </span><span class="kw">var</span>(clover<span class="op">$</span>lnwt)) <span class="co"># variance</span></code></pre></div>
<pre><code>## [1] 1.11373</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(std.lnwt &lt;-<span class="st"> </span><span class="kw">sd</span>(clover<span class="op">$</span>lnwt)) <span class="co"># standard deviation</span></code></pre></div>
<pre><code>## [1] 1.055334</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(clover<span class="op">$</span>lnwt)<span class="op">/</span><span class="kw">length</span>(clover<span class="op">$</span>lnwt) <span class="co"># manual calculation of average</span></code></pre></div>
<pre><code>## [1] 3.623269</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>( (clover<span class="op">$</span>lnwt <span class="op">-</span><span class="st"> </span>avg.lnwt) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> ) <span class="op">/</span><span class="st"> </span>(<span class="kw">length</span>(clover<span class="op">$</span>lnwt) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] 1.11373</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(rng.lnwt &lt;-<span class="st"> </span><span class="kw">range</span>(clover<span class="op">$</span>lnwt)) <span class="co"># output is a vector of lenght 2</span></code></pre></div>
<pre><code>## [1] 2.00326 5.71045</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">min</span>(clover<span class="op">$</span>lnwt) <span class="co"># minimum braking lnwtance</span></code></pre></div>
<pre><code>## [1] 2.00326</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">max</span>(clover<span class="op">$</span>lnwt) <span class="co"># maximum braking lnwtance</span></code></pre></div>
<pre><code>## [1] 5.71045</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(cv.lnwt &lt;-<span class="st"> </span>std.lnwt <span class="op">/</span><span class="st"> </span>avg.lnwt) <span class="co"># coefficient of variation</span></code></pre></div>
<pre><code>## [1] 0.2912657</code></pre>
<p>The <strong>coefficient of variation</strong> is the standard deviation in units of the average. A value greater than 1 is high and indicates that there is a large amount of variation unexplained. Values below 0.30 are very low and indicate that there is little unexplained variation. For laboratory or controlled field experiments the CV should be below 0.5, whereas for observational studies an acceptable CV can be up to 1.0.</p>
</div>
<div id="frequency-table-and-histogram" class="section level3">
<h3><span class="header-section-number">3.1.4</span> Frequency Table and Histogram</h3>
<p>We can create a frequency table by dividing the range of lnwt into bins according to a general guideline: number of bins = 1 + 3.3 log(sample size). For this we use the cut() function. Then we create the frequency table using the xtabs() function and plot the histogram. All of this is done automatically by R using the hist() function. We will worry about making the graphs look pretty later on.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(sample.size &lt;-<span class="st"> </span><span class="kw">length</span>(clover<span class="op">$</span>lnwt))</code></pre></div>
<pre><code>## [1] 45</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(nbins &lt;-<span class="st"> </span><span class="kw">max</span>(<span class="dv">8</span>, (<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(sample.size, <span class="dv">2</span>)))) <span class="co"># we round down for bins</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">clover<span class="op">$</span>bin &lt;-<span class="st"> </span><span class="kw">cut</span>(clover<span class="op">$</span>lnwt, <span class="dt">breaks =</span> nbins) <span class="co"># create column with bin</span>

(freq.table &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">xtabs</span>( <span class="op">~</span>clover<span class="op">$</span>bin))) <span class="co"># creates frequency table</span></code></pre></div>
<pre><code>##    clover.bin Freq
## 1    (2,2.47]   10
## 2 (2.47,2.93]    2
## 3 (2.93,3.39]    8
## 4 (3.39,3.86]    5
## 5 (3.86,4.32]    8
## 6 (4.32,4.78]    5
## 7 (4.78,5.25]    4
## 8 (5.25,5.71]    3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pander</span>(freq.table) <span class="co"># format the table a little better</span></code></pre></div>
<table style="width:28%;">
<colgroup>
<col width="19%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">clover.bin</th>
<th align="center">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">(2,2.47]</td>
<td align="center">10</td>
</tr>
<tr class="even">
<td align="center">(2.47,2.93]</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">(2.93,3.39]</td>
<td align="center">8</td>
</tr>
<tr class="even">
<td align="center">(3.39,3.86]</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="center">(3.86,4.32]</td>
<td align="center">8</td>
</tr>
<tr class="even">
<td align="center">(4.32,4.78]</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="center">(4.78,5.25]</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="center">(5.25,5.71]</td>
<td align="center">3</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(freq.table, <span class="dt">xlim =</span> <span class="kw">c</span>()) <span class="co"># make histogram &quot;by hand&quot;</span></code></pre></div>
<p><img src="02.0_Rcomputation_files/figure-html/ps%20freqhist-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(clover<span class="op">$</span>lnwt) <span class="co"># by default it uses Sturges rule for bins.</span></code></pre></div>
<p><img src="02.0_Rcomputation_files/figure-html/ps%20freqhist-2.png" width="672" /></p>
<p>Note that by adding parenthesis outside the whole expression we make the new object and display it at the same time.The function as.data.frame transforms the output of xtabs() into a table that is easy to understand.</p>
<p>The histogram can be used to visually assess the type of distribution the data may exhibit.</p>
<p>Data can be easily summarized by using the summary() function of R. This function will produce results that take into account the type of variable in the object it operates on.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(clover<span class="op">$</span>lnwt) <span class="co"># summary of a numeric variable or vector</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   2.003   2.717   3.753   3.623   4.352   5.710</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(clover<span class="op">$</span>lnwt) <span class="co"># a numeriv vector contains real numbers</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(clover<span class="op">$</span>bin) <span class="co"># this is a charcater variable coded as a factor</span></code></pre></div>
<pre><code>##    (2,2.47] (2.47,2.93] (2.93,3.39] (3.39,3.86] (3.86,4.32] (4.32,4.78] 
##          10           2           8           5           8           5 
## (4.78,5.25] (5.25,5.71] 
##           4           3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(clover<span class="op">$</span>bin)</code></pre></div>
<pre><code>## [1] &quot;factor&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(clover) <span class="co"># gives the summary for all variables</span></code></pre></div>
<pre><code>##       temp        days           lnwt                bin    
##  Min.   :1   Min.   : 7.0   Min.   :2.003   (2,2.47]   :10  
##  1st Qu.:1   1st Qu.:14.0   1st Qu.:2.717   (2.93,3.39]: 8  
##  Median :2   Median :22.0   Median :3.753   (3.86,4.32]: 8  
##  Mean   :2   Mean   :22.4   Mean   :3.623   (3.39,3.86]: 5  
##  3rd Qu.:3   3rd Qu.:30.0   3rd Qu.:4.352   (4.32,4.78]: 5  
##  Max.   :3   Max.   :37.0   Max.   :5.710   (4.78,5.25]: 4  
##                                             (Other)    : 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># What kind of result or object does summary() produce?</span>

<span class="kw">class</span>(<span class="kw">summary</span>(clover)) <span class="co"># This is functional programming; nested functions</span></code></pre></div>
<pre><code>## [1] &quot;table&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mode</span>(<span class="kw">summary</span>(clover))</code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(<span class="kw">summary</span>(clover)) <span class="co"># See the inside of an object!!</span></code></pre></div>
<pre><code>##  &#39;table&#39; chr [1:7, 1:4] &quot;Min.   :1  &quot; &quot;1st Qu.:1  &quot; &quot;Median :2  &quot; ...
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : chr [1:7] &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; ...
##   ..$ : chr [1:4] &quot;     temp&quot; &quot;     days&quot; &quot;     lnwt&quot; &quot;         bin&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(clover)[<span class="dv">1</span>,<span class="dv">1</span>] <span class="co"># get the first element of the table</span></code></pre></div>
<pre><code>## [1] &quot;Min.   :1  &quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(clover)[<span class="dv">1</span>,] <span class="co"># get the first row of the summary table</span></code></pre></div>
<pre><code>##               temp               days               lnwt 
##      &quot;Min.   :1  &quot;   &quot;Min.   : 7.0  &quot;  &quot;Min.   :2.003  &quot; 
##                bin 
## &quot;(2,2.47]   :10  &quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(clover)[,<span class="dv">1</span>] <span class="co">#  get the first column of the summary table</span></code></pre></div>
<pre><code>##                                                                       
## &quot;Min.   :1  &quot; &quot;1st Qu.:1  &quot; &quot;Median :2  &quot; &quot;Mean   :2  &quot; &quot;3rd Qu.:3  &quot; 
##                             
## &quot;Max.   :3  &quot;            NA</code></pre>
<p>The function str() is really important to see what objects are composed of and to use parts of those objects. Any part of an object can be referenced and modified using its “address.”</p>
</div>
<div id="box-and-whisker-plot-and-5-number-summary" class="section level3">
<h3><span class="header-section-number">3.1.5</span> Box-and-Whisker Plot and 5-Number Summary</h3>
<p>Data can be summarized using a boxplot and or the 5-number summary. These contain information about the average, median, first quartile, third quartile, range and outliers. The <em>range</em> argument determines how far the plot whiskers extend out from the box. If range is positive, the whiskers extend to the most extreme data point which is no more than <em>range</em> times the interquartile range (IQR) from the box. Data points that fall outside the whiskers are plotted and can be interpreted as “outliers” or values more extreme than expected. Outliers are so only on the basis of some preconceived expectation, usually a more or less normal distribution. A range value of zero causes the whiskers to extend to the data extremes, so no outliers are shown.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myrange.factor =<span class="st"> </span><span class="fl">1.5</span> <span class="co"># save number in a named object for later use</span>

<span class="kw">boxplot</span>(clover<span class="op">$</span>lnwt, <span class="dt">range =</span> myrange.factor)

<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">0.70</span>, <span class="dt">y =</span> <span class="kw">median</span>(clover<span class="op">$</span>lnwt), <span class="dt">label =</span> <span class="st">&quot;Median&quot;</span>)

<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">0.65</span>, <span class="dt">y =</span> <span class="kw">quantile</span>(clover<span class="op">$</span>lnwt, <span class="fl">0.75</span>), <span class="dt">label =</span> <span class="st">&quot;3rd quartile or 75% quantile&quot;</span>)

<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.30</span>, <span class="dt">y =</span> <span class="kw">quantile</span>(clover<span class="op">$</span>lnwt, <span class="fl">0.75</span>), <span class="dt">label =</span> <span class="st">&quot;Upper Hinge&quot;</span>)

<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">0.65</span>, <span class="dt">y =</span> <span class="kw">quantile</span>(clover<span class="op">$</span>lnwt, <span class="fl">0.25</span>), <span class="dt">label =</span> <span class="st">&quot;1st quartile or 25% quantile&quot;</span>)

<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.30</span>, <span class="dt">y =</span> <span class="kw">quantile</span>(clover<span class="op">$</span>lnwt, <span class="fl">0.25</span>), <span class="dt">label =</span> <span class="st">&quot;Lower Hinge&quot;</span>)

<span class="co"># To get the location of the top &quot;fence&quot; we need to identify the datapoint that is closest to but no greater than the upper hinge plus 1.5 * interquartile range.</span>

(iqrange &lt;-<span class="st"> </span><span class="kw">IQR</span>(clover<span class="op">$</span>lnwt)) <span class="co"># Calculate the interquartile range</span></code></pre></div>
<pre><code>## [1] 1.63484</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(uplimit &lt;-<span class="st"> </span><span class="kw">quantile</span>(clover<span class="op">$</span>lnwt, <span class="fl">0.75</span>) <span class="op">+</span><span class="st"> </span>myrange.factor <span class="op">*</span><span class="st"> </span>iqrange)</code></pre></div>
<pre><code>##     75% 
## 6.80417</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(rows.where.lt.uplimit &lt;-<span class="st"> </span><span class="kw">which</span>(clover<span class="op">$</span>lnwt <span class="op">&lt;=</span><span class="st"> </span>uplimit)) <span class="co"># gives row numbers of those that are less than uplimit</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
## [24] 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">clover<span class="op">$</span>lnwt[rows.where.lt.uplimit] <span class="co"># gives lnwt in those rows</span></code></pre></div>
<pre><code>##  [1] 2.02629 2.02629 2.00326 2.71707 2.25655 2.48681 3.17759 3.17759
##  [9] 3.29272 3.79929 3.47693 3.75324 3.77626 3.89139 4.00652 2.18747
## [17] 2.25655 2.16444 3.13154 3.24667 3.24667 3.93745 3.89139 3.91442
## [25] 4.23678 4.19073 4.49007 5.11177 4.62823 4.76638 2.39470 2.25655
## [33] 2.46378 3.22364 3.33877 3.40785 4.35191 4.35191 4.30586 4.97362
## [41] 4.90454 5.01967 5.43414 5.71045 5.64137</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(up.fence &lt;-<span class="st"> </span><span class="kw">max</span>(clover<span class="op">$</span>lnwt[rows.where.lt.uplimit])) <span class="co"># gives the value we seek</span></code></pre></div>
<pre><code>## [1] 5.71045</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(outl &lt;-<span class="st"> </span>clover<span class="op">$</span>lnwt[clover<span class="op">$</span>lnwt <span class="op">&gt;</span><span class="st"> </span>up.fence]) <span class="co"># No outliers!</span></code></pre></div>
<pre><code>## numeric(0)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">0.65</span>, <span class="dt">y =</span> up.fence, <span class="dt">label =</span> <span class="st">&quot;Upper Fence&quot;</span>)</code></pre></div>
<p><img src="02.0_Rcomputation_files/figure-html/ps%20boxplot1-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">help</span>(boxplot) <span class="co"># get more information about the boxplot.</span></code></pre></div>
<p>If we choose a smaller value for the <em>range</em> argument of boxplot we can make some values appear like outliers. Note that 1.5 is a commonly accepted value for range. Just to see how the plots behave with a different range, we copy the code above and re-run it after changing the range value.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myrange.factor =<span class="st"> </span><span class="fl">0.5</span>

<span class="kw">boxplot</span>(clover<span class="op">$</span>lnwt, <span class="dt">range =</span> myrange.factor)

<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">0.70</span>, <span class="dt">y =</span> <span class="kw">median</span>(clover<span class="op">$</span>lnwt), <span class="dt">label =</span> <span class="st">&quot;Median&quot;</span>)

<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">0.65</span>, <span class="dt">y =</span> <span class="kw">quantile</span>(clover<span class="op">$</span>lnwt, <span class="fl">0.75</span>), <span class="dt">label =</span> <span class="st">&quot;3rd quartile or 75% quantile&quot;</span>)

<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.30</span>, <span class="dt">y =</span> <span class="kw">quantile</span>(clover<span class="op">$</span>lnwt, <span class="fl">0.75</span>), <span class="dt">label =</span> <span class="st">&quot;Upper Hinge&quot;</span>)

<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">0.65</span>, <span class="dt">y =</span> <span class="kw">quantile</span>(clover<span class="op">$</span>lnwt, <span class="fl">0.25</span>), <span class="dt">label =</span> <span class="st">&quot;1st quartile or 25% quantile&quot;</span>)

<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.30</span>, <span class="dt">y =</span> <span class="kw">quantile</span>(clover<span class="op">$</span>lnwt, <span class="fl">0.25</span>), <span class="dt">label =</span> <span class="st">&quot;Lower Hinge&quot;</span>)

<span class="co"># To get the location of the top &quot;fence&quot; we need to identify the datapoint that is closest to but no greater than the upper hinge plus 1.5 * interquartile range.</span>

(iqrange &lt;-<span class="st"> </span><span class="kw">IQR</span>(clover<span class="op">$</span>lnwt)) <span class="co"># Calculate the interquartile range</span></code></pre></div>
<pre><code>## [1] 1.63484</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(uplimit &lt;-<span class="st"> </span><span class="kw">quantile</span>(clover<span class="op">$</span>lnwt, <span class="fl">0.75</span>) <span class="op">+</span><span class="st"> </span>myrange.factor <span class="op">*</span><span class="st"> </span>iqrange)</code></pre></div>
<pre><code>##     75% 
## 5.16933</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(rows.where.lt.uplimit &lt;-<span class="st"> </span><span class="kw">which</span>(clover<span class="op">$</span>lnwt <span class="op">&lt;=</span><span class="st"> </span>uplimit)) <span class="co"># gives row numbers of those that are less than uplimit</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
## [24] 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">clover<span class="op">$</span>lnwt[rows.where.lt.uplimit] <span class="co"># gives lnwt in those rows</span></code></pre></div>
<pre><code>##  [1] 2.02629 2.02629 2.00326 2.71707 2.25655 2.48681 3.17759 3.17759
##  [9] 3.29272 3.79929 3.47693 3.75324 3.77626 3.89139 4.00652 2.18747
## [17] 2.25655 2.16444 3.13154 3.24667 3.24667 3.93745 3.89139 3.91442
## [25] 4.23678 4.19073 4.49007 5.11177 4.62823 4.76638 2.39470 2.25655
## [33] 2.46378 3.22364 3.33877 3.40785 4.35191 4.35191 4.30586 4.97362
## [41] 4.90454 5.01967</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(up.fence &lt;-<span class="st"> </span><span class="kw">max</span>(clover<span class="op">$</span>lnwt[rows.where.lt.uplimit])) <span class="co"># gives the value we seek</span></code></pre></div>
<pre><code>## [1] 5.11177</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(outl &lt;-<span class="st"> </span>clover<span class="op">$</span>lnwt[clover<span class="op">$</span>lnwt <span class="op">&gt;</span><span class="st"> </span>up.fence]) <span class="co"># We have outliers!</span></code></pre></div>
<pre><code>## [1] 5.43414 5.71045 5.64137</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">0.65</span>, <span class="dt">y =</span> up.fence, <span class="dt">label =</span> <span class="st">&quot;Upper Fence&quot;</span>)</code></pre></div>
<p><img src="02.0_Rcomputation_files/figure-html/ps%20boxplot2-1.png" width="672" /></p>
<p>The values for the five-number summary can be obtained directly with the fivenum() function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pander</span>(<span class="kw">cbind</span>(<span class="kw">c</span>(<span class="st">&quot;min&quot;</span>, <span class="st">&quot;lower hinge&quot;</span>, <span class="st">&quot;median&quot;</span>, <span class="st">&quot;upper hinge&quot;</span>, <span class="st">&quot;max&quot;</span>), <span class="kw">fivenum</span>(clover<span class="op">$</span>lnwt)))</code></pre></div>
<table style="width:32%;">
<colgroup>
<col width="19%" />
<col width="12%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="center">min</td>
<td align="center">2.00326</td>
</tr>
<tr class="even">
<td align="center">lower hinge</td>
<td align="center">2.71707</td>
</tr>
<tr class="odd">
<td align="center">median</td>
<td align="center">3.75324</td>
</tr>
<tr class="even">
<td align="center">upper hinge</td>
<td align="center">4.35191</td>
</tr>
<tr class="odd">
<td align="center">max</td>
<td align="center">5.71045</td>
</tr>
</tbody>
</table>
</div>
<div id="analyses-by-groups" class="section level3">
<h3><span class="header-section-number">3.1.6</span> Analyses by Groups</h3>
<p>The clover data has groups defined by the temperature treatments. Because the group numbers are just lables, we need to transform them into what is called “factor” class in R. This way, we can apply functions that obtain summaries and figures for each group. In the case of the clover, we expect that plants to grow faster at higher temperature; let’s see what the data say.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">clover<span class="op">$</span>temp &lt;-<span class="st"> </span><span class="kw">factor</span>(clover<span class="op">$</span>temp)

<span class="kw">summary</span>(clover)</code></pre></div>
<pre><code>##  temp        days           lnwt                bin    
##  1:15   Min.   : 7.0   Min.   :2.003   (2,2.47]   :10  
##  2:15   1st Qu.:14.0   1st Qu.:2.717   (2.93,3.39]: 8  
##  3:15   Median :22.0   Median :3.753   (3.86,4.32]: 8  
##         Mean   :22.4   Mean   :3.623   (3.39,3.86]: 5  
##         3rd Qu.:30.0   3rd Qu.:4.352   (4.32,4.78]: 5  
##         Max.   :37.0   Max.   :5.710   (4.78,5.25]: 4  
##                                        (Other)    : 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(clover)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    45 obs. of  4 variables:
##  $ temp: Factor w/ 3 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ days: int  9 9 9 15 15 15 22 22 22 30 ...
##  $ lnwt: num  2.03 2.03 2 2.72 2.26 ...
##  $ bin : Factor w/ 8 levels &quot;(2,2.47]&quot;,&quot;(2.47,2.93]&quot;,..: 1 1 1 2 1 2 3 3 3 4 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(lnwt <span class="op">~</span><span class="st"> </span>temp, <span class="dt">data =</span> clover, <span class="dt">notch =</span> <span class="ot">TRUE</span>) <span class="co"># boxplots by treatment</span></code></pre></div>
<p><img src="02.0_Rcomputation_files/figure-html/ps%20grouped-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">help</span>(by) <span class="co"># by produces a list with an element for each value of the grouping variable.</span>

<span class="kw">pander</span>(sumry.by.temp &lt;-<span class="st"> </span><span class="kw">by</span>(<span class="dt">data =</span> clover<span class="op">$</span>lnwt, <span class="dt">INDICES =</span> clover<span class="op">$</span>temp, <span class="dt">FUN =</span> summary))</code></pre></div>
<ul>
<li><p><strong>1</strong>:</p>
<table style="width:72%;">
<colgroup>
<col width="11%" />
<col width="13%" />
<col width="12%" />
<col width="11%" />
<col width="13%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Min.</th>
<th align="center">1st Qu.</th>
<th align="center">Median</th>
<th align="center">Mean</th>
<th align="center">3rd Qu.</th>
<th align="center">Max.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">2.003</td>
<td align="center">2.372</td>
<td align="center">3.178</td>
<td align="center">3.058</td>
<td align="center">3.765</td>
<td align="center">4.007</td>
</tr>
</tbody>
</table></li>
<li><p><strong>2</strong>:</p>
<table style="width:72%;">
<colgroup>
<col width="11%" />
<col width="13%" />
<col width="12%" />
<col width="11%" />
<col width="13%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Min.</th>
<th align="center">1st Qu.</th>
<th align="center">Median</th>
<th align="center">Mean</th>
<th align="center">3rd Qu.</th>
<th align="center">Max.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">2.164</td>
<td align="center">3.189</td>
<td align="center">3.914</td>
<td align="center">3.693</td>
<td align="center">4.363</td>
<td align="center">5.112</td>
</tr>
</tbody>
</table></li>
<li><p><strong>3</strong>:</p>
<table style="width:71%;">
<colgroup>
<col width="11%" />
<col width="13%" />
<col width="12%" />
<col width="11%" />
<col width="13%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Min.</th>
<th align="center">1st Qu.</th>
<th align="center">Median</th>
<th align="center">Mean</th>
<th align="center">3rd Qu.</th>
<th align="center">Max.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">2.257</td>
<td align="center">3.281</td>
<td align="center">4.352</td>
<td align="center">4.119</td>
<td align="center">4.997</td>
<td align="center">5.71</td>
</tr>
</tbody>
</table></li>
</ul>
<!-- end of list -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(fiven.by.temp &lt;-<span class="st"> </span><span class="kw">by</span>(<span class="dt">data =</span> clover<span class="op">$</span>lnwt, <span class="dt">INDICES =</span> clover<span class="op">$</span>temp, <span class="dt">FUN =</span> fivenum))</code></pre></div>
<pre><code>## clover$temp: 1
## [1] 2.00326 2.37168 3.17759 3.76475 4.00652
## -------------------------------------------------------- 
## clover$temp: 2
## [1] 2.164440 3.189105 3.914420 4.363425 5.111770
## -------------------------------------------------------- 
## clover$temp: 3
## [1] 2.256550 3.281205 4.351910 4.996645 5.710450</code></pre>
</div>
</div>
<div id="animal-sciences" class="section level2">
<h2><span class="header-section-number">3.2</span> Animal Sciences</h2>
<div id="introduction-to-r-and-rstudio-1" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Introduction to R and RStudio</h3>
<p>If you are using a lab computer and not your personal computer, insert your flash drive and set the working directory to be in your drive. This way you will have all of your files with you in your drive. Files that you save to the lab computers are wiped every night. The following script chunk allows you to manually select your working directory by selecting a file within it.</p>
<p>Once you have installed the necessary packages, you can render this Rmd file and produce the html file that can be viewed in any browser. <strong>For full credit you will submit both the Rmd and html files you complete.</strong></p>
</div>
<div id="create-a-dataframe-and-table-1" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Create a dataframe and table</h3>
<p>To create a data frame we use the data.frame() function. In this example we create a data frame named “mydata.” This data frame has 2 columns (Y1 and Y2) and 3 rows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mydata &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Y1 =</span> <span class="kw">c</span>(<span class="st">&quot;treatment 1&quot;</span>, <span class="st">&quot;treatment 2&quot;</span>, <span class="st">&quot;treatment 3&quot;</span>), <span class="dt">Y2 =</span> <span class="kw">c</span>(<span class="dv">35</span>, <span class="dv">23</span>, <span class="dv">30</span>)) <span class="co"># Create data frame with 2 columns and 3 rows</span>

mydata <span class="co"># see the contents of the data frame</span></code></pre></div>
<pre><code>##            Y1 Y2
## 1 treatment 1 35
## 2 treatment 2 23
## 3 treatment 3 30</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(mydata) <span class="co"># see the structure of the data frame</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    3 obs. of  2 variables:
##  $ Y1: Factor w/ 3 levels &quot;treatment 1&quot;,..: 1 2 3
##  $ Y2: num  35 23 30</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(mydata) <span class="co"># see the class of the data frame</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pander) <span class="co"># we need to install pander first</span>

<span class="kw">pander</span>(mydata, <span class="dt">caption =</span> <span class="st">&quot;Table showing my data.&quot;</span>) <span class="co">#pander() creates a table for the data</span></code></pre></div>
<table style="width:25%;">
<caption>Table showing my data.</caption>
<colgroup>
<col width="19%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Y1</th>
<th align="center">Y2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">treatment 1</td>
<td align="center">35</td>
</tr>
<tr class="even">
<td align="center">treatment 2</td>
<td align="center">23</td>
</tr>
<tr class="odd">
<td align="center">treatment 3</td>
<td align="center">30</td>
</tr>
</tbody>
</table>
</div>
<div id="summary-statistics-1" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Summary Statistics</h3>
<p>Summary statistics are classified as measures of central tendency and measures of dispersion. Mean, and median are measures of central tendency. Variance, standard deviation, range minimum and maximum are measures of dispersion. For positive random variables, the coefficient of variation is a measure of variation relative to the mean.</p>
<p>We use the <em>heifer.xlsx</em> data set provided in the first assignment. These data represent the birth weight of heifers across three different years (2005, 2006, 2007). Column names are in the first row of the file, so we specify <em>col_names = TRUE</em> in the line of code to read the data. Data are placed in a data frame named “heifer”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readxl)

 <span class="co"># read in data.</span>
heifer &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;Datasets/HeiferDataLab1.xlsx&quot;</span>, <span class="dt">col_names =</span> <span class="ot">TRUE</span>)

(avg.bwt &lt;-<span class="st"> </span><span class="kw">mean</span>(heifer<span class="op">$</span>Birth_Wt)) <span class="co"># obtain the average bwt</span></code></pre></div>
<pre><code>## [1] 76.5988</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># note the use of $ to select parts of an object and the outer</span>
<span class="co"># parentheses to display the result.</span>

(med.bwt &lt;-<span class="st"> </span><span class="kw">median</span>(heifer<span class="op">$</span>Birth_Wt)) <span class="co"># median or 50th percentile</span></code></pre></div>
<pre><code>## [1] 78</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quantile</span>(heifer<span class="op">$</span>Birth_Wt, <span class="fl">0.5</span>) <span class="co"># 50th percentile is the same as the median</span></code></pre></div>
<pre><code>## 50% 
##  78</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(var.bwt &lt;-<span class="st"> </span><span class="kw">var</span>(heifer<span class="op">$</span>Birth_Wt)) <span class="co"># variance</span></code></pre></div>
<pre><code>## [1] 128.7718</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(std.bwt &lt;-<span class="st"> </span><span class="kw">sd</span>(heifer<span class="op">$</span>Birth_Wt)) <span class="co"># standard deviation</span></code></pre></div>
<pre><code>## [1] 11.34777</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(heifer<span class="op">$</span>Birth_Wt)<span class="op">/</span><span class="kw">length</span>(heifer<span class="op">$</span>Birth_Wt) <span class="co"># manual calculation of average</span></code></pre></div>
<pre><code>## [1] 76.5988</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>( (heifer<span class="op">$</span>Birth_Wt <span class="op">-</span><span class="st"> </span>avg.bwt) <span class="op">^</span><span class="st"> </span><span class="dv">2</span> ) <span class="op">/</span><span class="st"> </span>(<span class="kw">length</span>(heifer<span class="op">$</span>Birth_Wt) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] 128.7718</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(rng.bwt &lt;-<span class="st"> </span><span class="kw">range</span>(heifer<span class="op">$</span>Birth_Wt)) <span class="co"># output is a vector of lenght 2</span></code></pre></div>
<pre><code>## [1]  42 112</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">min</span>(heifer<span class="op">$</span>Birth_Wt) <span class="co"># minimum braking bwtance</span></code></pre></div>
<pre><code>## [1] 42</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">max</span>(heifer<span class="op">$</span>Birth_Wt) <span class="co"># maximum braking bwtance</span></code></pre></div>
<pre><code>## [1] 112</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(cv.bwt &lt;-<span class="st"> </span>std.bwt <span class="op">/</span><span class="st"> </span>avg.bwt) <span class="co"># coefficient of variation</span></code></pre></div>
<pre><code>## [1] 0.1481455</code></pre>
<p>The <strong>coefficient of variation</strong> is the standard deviation in units of the average. A value greater than 1 is high and indicates that there is a large amount of variation unexplained. Values below 0.30 are very low and indicate that there is little unexplained variation. For laboratory or controlled field experiments the CV should be below 0.5, whereas for observational studies an acceptable CV can be up to 1.0.</p>
</div>
<div id="frequency-table-and-histogram-1" class="section level3">
<h3><span class="header-section-number">3.2.4</span> Frequency Table and Histogram</h3>
<p>We can create a frequency table by dividing the range of bwt into bins according to a general guideline: number of bins = 1 + 3.3 log(sample size). For this we use the cut() function. Then we create the frequency table using the xtabs() function and plot the histogram. All of this is done automatically by R using the hist() function. We will worry about making the graphs look pretty later on.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(sample.size &lt;-<span class="st"> </span><span class="kw">length</span>(heifer<span class="op">$</span>Birth_Wt))</code></pre></div>
<pre><code>## [1] 167</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(nbins &lt;-<span class="st"> </span><span class="kw">max</span>(<span class="dv">8</span>, (<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(sample.size, <span class="dv">2</span>)))) <span class="co"># we round down for bins</span></code></pre></div>
<pre><code>## [1] 8.383704</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heifer<span class="op">$</span>bin &lt;-<span class="st"> </span><span class="kw">cut</span>(heifer<span class="op">$</span>Birth_Wt, <span class="dt">breaks =</span> nbins) <span class="co"># create column with bin</span>

(freq.table &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">xtabs</span>( <span class="op">~</span>heifer<span class="op">$</span>bin))) <span class="co"># creates frequency table</span></code></pre></div>
<pre><code>##    heifer.bin Freq
## 1 (41.9,50.8]    4
## 2 (50.8,59.5]   11
## 3 (59.5,68.2]   20
## 4   (68.2,77]   39
## 5   (77,85.8]   64
## 6 (85.8,94.5]   23
## 7  (94.5,103]    5
## 8   (103,112]    1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pander</span>(freq.table) <span class="co"># format the table a little better</span></code></pre></div>
<table style="width:28%;">
<colgroup>
<col width="19%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">heifer.bin</th>
<th align="center">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">(41.9,50.8]</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="center">(50.8,59.5]</td>
<td align="center">11</td>
</tr>
<tr class="odd">
<td align="center">(59.5,68.2]</td>
<td align="center">20</td>
</tr>
<tr class="even">
<td align="center">(68.2,77]</td>
<td align="center">39</td>
</tr>
<tr class="odd">
<td align="center">(77,85.8]</td>
<td align="center">64</td>
</tr>
<tr class="even">
<td align="center">(85.8,94.5]</td>
<td align="center">23</td>
</tr>
<tr class="odd">
<td align="center">(94.5,103]</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">(103,112]</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(freq.table, <span class="dt">xlim =</span> <span class="kw">c</span>()) <span class="co"># make histogram &quot;by hand&quot;</span></code></pre></div>
<p><img src="02.0_Rcomputation_files/figure-html/as%20freqhist-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(heifer<span class="op">$</span>Birth_Wt) <span class="co"># by default it uses Sturges rule for bins.</span></code></pre></div>
<p><img src="02.0_Rcomputation_files/figure-html/as%20freqhist-2.png" width="672" /></p>
<p>Note that by adding parenthesis outside the whole expression we make the new object and display it at the same time.The function as.data.frame transforms the output of xtabs() into a table that is easy to understand.</p>
<p>The histogram can be used to visually assess the type of distribution the data may exhibit.</p>
<p>Data can be easily summarized by using the summary() function of R. This function will produce results that take into account the type of variable in the object it operates on.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(heifer<span class="op">$</span>Birth_Wt) <span class="co"># summary of a numeric variable or vector</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    42.0    70.5    78.0    76.6    84.0   112.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(heifer<span class="op">$</span>Birth_Wt) <span class="co"># a numeriv vector contains real numbers</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(heifer<span class="op">$</span>bin) <span class="co"># this is a charcater variable coded as a factor</span></code></pre></div>
<pre><code>## (41.9,50.8] (50.8,59.5] (59.5,68.2]   (68.2,77]   (77,85.8] (85.8,94.5] 
##           4          11          20          39          64          23 
##  (94.5,103]   (103,112] 
##           5           1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(heifer<span class="op">$</span>bin)</code></pre></div>
<pre><code>## [1] &quot;factor&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(heifer) <span class="co"># gives the summary for all variables</span></code></pre></div>
<pre><code>##        No             ID              Birth_Year      Birth_Wt    
##  Min.   :  1.0   Length:167         Min.   :2005   Min.   : 42.0  
##  1st Qu.: 42.5   Class :character   1st Qu.:2005   1st Qu.: 70.5  
##  Median : 84.0   Mode  :character   Median :2005   Median : 78.0  
##  Mean   : 84.4                      Mean   :2005   Mean   : 76.6  
##  3rd Qu.:126.5                      3rd Qu.:2005   3rd Qu.: 84.0  
##  Max.   :168.0                      Max.   :2005   Max.   :112.0  
##                                                                   
##    Birth_Date                     Dam_Age     
##  Min.   :2005-01-17 00:00:00   Min.   : 2.00  
##  1st Qu.:2005-09-16 00:00:00   1st Qu.: 4.00  
##  Median :2005-10-01 00:00:00   Median : 7.00  
##  Mean   :2005-08-22 05:36:17   Mean   : 6.06  
##  3rd Qu.:2005-10-23 00:00:00   3rd Qu.: 8.00  
##  Max.   :2005-12-09 00:00:00   Max.   :12.00  
##                                               
##    Wean_Date                      Wean_AGE        Wean_Wt     
##  Min.   :2005-08-17 00:00:00   Min.   :158.0   Min.   :344.0  
##  1st Qu.:2006-04-26 00:00:00   1st Qu.:190.0   1st Qu.:478.5  
##  Median :2006-05-10 00:00:00   Median :211.0   Median :522.0  
##  Mean   :2006-03-17 12:47:25   Mean   :207.3   Mean   :528.1  
##  3rd Qu.:2006-05-15 00:00:00   3rd Qu.:224.0   3rd Qu.:573.0  
##  Max.   :2006-05-19 00:00:00   Max.   :243.0   Max.   :704.0  
##                                                               
##     Wt_205d         Wean_Ht        Year_Date                  
##  Min.   :395.9   Min.   : 0.00   Min.   :2006-03-02 00:00:00  
##  1st Qu.:492.1   1st Qu.:42.15   1st Qu.:2006-09-25 00:00:00  
##  Median :539.3   Median :44.00   Median :2006-10-26 00:00:00  
##  Mean   :537.4   Mean   :36.39   Mean   :2006-09-03 10:03:35  
##  3rd Qu.:585.2   3rd Qu.:45.15   3rd Qu.:2006-10-27 00:00:00  
##  Max.   :744.1   Max.   :49.80   Max.   :2006-10-27 00:00:00  
##                                                               
##     Year_AGE        Year_Wt          Wt_365d      
##  Min.   :320.0   Min.   : 604.0   Min.   : 616.9  
##  1st Qu.:363.5   1st Qu.: 739.0   1st Qu.: 737.9  
##  Median :383.0   Median : 806.0   Median : 806.3  
##  Mean   :377.2   Mean   : 812.7   Mean   : 805.0  
##  3rd Qu.:396.0   3rd Qu.: 879.0   3rd Qu.: 867.3  
##  Max.   :409.0   Max.   :1066.0   Max.   :1087.6  
##                                                   
##     US _Date                        REA               FT        
##  Min.   :2006-03-02 00:00:00   Min.   : 6.400   Min.   :0.0800  
##  1st Qu.:2006-09-25 00:00:00   1st Qu.: 8.900   1st Qu.:0.1800  
##  Median :2006-10-26 00:00:00   Median : 9.800   Median :0.2300  
##  Mean   :2006-09-03 09:46:20   Mean   : 9.752   Mean   :0.2411  
##  3rd Qu.:2006-10-27 00:00:00   3rd Qu.:10.600   3rd Qu.:0.2900  
##  Max.   :2006-10-27 00:00:00   Max.   :12.900   Max.   :0.5400  
##                                                                 
##       IMF                 bin    
##  Min.   :1.740   (77,85.8]  :64  
##  1st Qu.:3.440   (68.2,77]  :39  
##  Median :3.810   (85.8,94.5]:23  
##  Mean   :3.902   (59.5,68.2]:20  
##  3rd Qu.:4.440   (50.8,59.5]:11  
##  Max.   :6.720   (94.5,103] : 5  
##                  (Other)    : 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># What kind of result or object does summary() produce?</span>

<span class="kw">class</span>(<span class="kw">summary</span>(heifer)) <span class="co"># This is functional programming; nested functions</span></code></pre></div>
<pre><code>## [1] &quot;table&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mode</span>(<span class="kw">summary</span>(heifer))</code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(<span class="kw">summary</span>(heifer)) <span class="co"># See the inside of an object!!</span></code></pre></div>
<pre><code>##  &#39;table&#39; chr [1:7, 1:20] &quot;Min.   :  1.0  &quot; &quot;1st Qu.: 42.5  &quot; ...
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : chr [1:7] &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; ...
##   ..$ : chr [1:20] &quot;      No&quot; &quot;     ID&quot; &quot;  Birth_Year&quot; &quot;   Birth_Wt&quot; ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(heifer)[<span class="dv">1</span>,<span class="dv">1</span>] <span class="co"># get the first element of the table</span></code></pre></div>
<pre><code>## [1] &quot;Min.   :  1.0  &quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(heifer)[<span class="dv">1</span>,] <span class="co"># get the first row of the summary table</span></code></pre></div>
<pre><code>##                              No                              ID 
##               &quot;Min.   :  1.0  &quot;            &quot;Length:167        &quot; 
##                      Birth_Year                        Birth_Wt 
##                &quot;Min.   :2005  &quot;               &quot;Min.   : 42.0  &quot; 
##                      Birth_Date                         Dam_Age 
## &quot;Min.   :2005-01-17 00:00:00  &quot;               &quot;Min.   : 2.00  &quot; 
##                       Wean_Date                        Wean_AGE 
## &quot;Min.   :2005-08-17 00:00:00  &quot;               &quot;Min.   :158.0  &quot; 
##                         Wean_Wt                         Wt_205d 
##               &quot;Min.   :344.0  &quot;               &quot;Min.   :395.9  &quot; 
##                         Wean_Ht                       Year_Date 
##               &quot;Min.   : 0.00  &quot; &quot;Min.   :2006-03-02 00:00:00  &quot; 
##                        Year_AGE                         Year_Wt 
##               &quot;Min.   :320.0  &quot;              &quot;Min.   : 604.0  &quot; 
##                         Wt_365d                        US _Date 
##              &quot;Min.   : 616.9  &quot; &quot;Min.   :2006-03-02 00:00:00  &quot; 
##                             REA                              FT 
##              &quot;Min.   : 6.400  &quot;              &quot;Min.   :0.0800  &quot; 
##                             IMF                             bin 
##               &quot;Min.   :1.740  &quot;              &quot;(77,85.8]  :64  &quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(heifer)[,<span class="dv">1</span>] <span class="co">#  get the first column of the summary table</span></code></pre></div>
<pre><code>##                                                                         
## &quot;Min.   :  1.0  &quot; &quot;1st Qu.: 42.5  &quot; &quot;Median : 84.0  &quot; &quot;Mean   : 84.4  &quot; 
##                                                       
## &quot;3rd Qu.:126.5  &quot; &quot;Max.   :168.0  &quot;                NA</code></pre>
<p>The function str() is really important to see what objects are composed of and to use parts of those objects. Any part of an object can be referenced and modified using its “address.”</p>
</div>
<div id="box-and-whisker-plot-and-5-number-summary-1" class="section level3">
<h3><span class="header-section-number">3.2.5</span> Box-and-Whisker Plot and 5-Number Summary</h3>
<p>Data can be summarized using a boxplot and or the 5-number summary. These contain information about the average, median, first quartile, third quartile, range and outliers. The <em>range</em> argument determines how far the plot whiskers extend out from the box. If range is positive, the whiskers extend to the most extreme data point which is no more than <em>range</em> times the interquartile range (IQR) from the box. Data points that fall outside the whiskers are plotted and can be interpreted as “outliers” or values more extreme than expected. Outliers are so only on the basis of some preconceived expectation, usually a more or less normal distribution. A range value of zero causes the whiskers to extend to the data extremes, so no outliers are shown.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myrange.factor =<span class="st"> </span><span class="fl">1.5</span> <span class="co"># save number in a named object for later use</span>

<span class="kw">boxplot</span>(heifer<span class="op">$</span>Birth_Wt, <span class="dt">range =</span> myrange.factor)

<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">0.70</span>, <span class="dt">y =</span> <span class="kw">median</span>(heifer<span class="op">$</span>Birth_Wt), <span class="dt">label =</span> <span class="st">&quot;Median&quot;</span>)

<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">0.65</span>, <span class="dt">y =</span> <span class="kw">quantile</span>(heifer<span class="op">$</span>Birth_Wt, <span class="fl">0.75</span>), <span class="dt">label =</span> <span class="st">&quot;3rd quartile or 75% quantile&quot;</span>)

<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.30</span>, <span class="dt">y =</span> <span class="kw">quantile</span>(heifer<span class="op">$</span>Birth_Wt, <span class="fl">0.75</span>), <span class="dt">label =</span> <span class="st">&quot;Upper Hinge&quot;</span>)

<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">0.65</span>, <span class="dt">y =</span> <span class="kw">quantile</span>(heifer<span class="op">$</span>Birth_Wt, <span class="fl">0.25</span>), <span class="dt">label =</span> <span class="st">&quot;1st quartile or 25% quantile&quot;</span>)

<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.30</span>, <span class="dt">y =</span> <span class="kw">quantile</span>(heifer<span class="op">$</span>Birth_Wt, <span class="fl">0.25</span>), <span class="dt">label =</span> <span class="st">&quot;Lower Hinge&quot;</span>)

<span class="co"># To get the location of the top &quot;fence&quot; we need to identify the datapoint that is closest to but no greater than the upper hinge plus 1.5 * interquartile range.</span>

(iqrange &lt;-<span class="st"> </span><span class="kw">IQR</span>(heifer<span class="op">$</span>Birth_Wt)) <span class="co"># Calculate the interquartile range</span></code></pre></div>
<pre><code>## [1] 13.5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(uplimit &lt;-<span class="st"> </span><span class="kw">quantile</span>(heifer<span class="op">$</span>Birth_Wt, <span class="fl">0.75</span>) <span class="op">+</span><span class="st"> </span>myrange.factor <span class="op">*</span><span class="st"> </span>iqrange)</code></pre></div>
<pre><code>##    75% 
## 104.25</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(rows.where.lt.uplimit &lt;-<span class="st"> </span><span class="kw">which</span>(heifer<span class="op">$</span>Birth_Wt <span class="op">&lt;=</span><span class="st"> </span>uplimit)) <span class="co"># gives row numbers of those that are less than uplimit</span></code></pre></div>
<pre><code>##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
##  [18]  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34
##  [35]  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51
##  [52]  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66  68  69
##  [69]  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86
##  [86]  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103
## [103] 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120
## [120] 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137
## [137] 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154
## [154] 155 156 157 158 159 160 161 162 163 164 165 166 167</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heifer<span class="op">$</span>Birth_Wt[rows.where.lt.uplimit] <span class="co"># gives bwt in those rows</span></code></pre></div>
<pre><code>##   [1] 81 63 72 71 81 86 76 82 74 94 88 88 79 94 82 64 70 70 70 80 66 52 80
##  [24] 78 70 82 79 86 82 70 86 58 87 81 82 82 67 62 72 79 80 91 82 78 74 81
##  [47] 82 97 84 52 72 78 86 66 54 78 76 75 77 78 91 81 68 75 86 72 84 58 64
##  [70] 85 71 78 82 82 74 72 68 42 81 76 72 72 74 68 56 82 70 88 95 76 74 88
##  [93] 58 68 61 74 79 88 84 61 90 78 78 54 85 92 78 68 71 76 84 84 76 51 65
## [116] 70 78 44 72 62 96 74 78 72 84 83 76 91 73 82 84 92 80 68 83 61 62 92
## [139] 84 85 67 78 94 78 82 92 84 84 80 79 78 90 96 84 58 71 84 80 98 50 83
## [162] 85 48 84 74 58</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(up.fence &lt;-<span class="st"> </span><span class="kw">max</span>(heifer<span class="op">$</span>Birth_Wt[rows.where.lt.uplimit])) <span class="co"># gives the value we seek</span></code></pre></div>
<pre><code>## [1] 98</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(outl &lt;-<span class="st"> </span>heifer<span class="op">$</span>Birth_Wt[heifer<span class="op">$</span>Birth_Wt <span class="op">&gt;</span><span class="st"> </span>up.fence]) <span class="co"># 10 outliers</span></code></pre></div>
<pre><code>## [1] 112</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">0.65</span>, <span class="dt">y =</span> up.fence, <span class="dt">label =</span> <span class="st">&quot;Upper Fence&quot;</span>)</code></pre></div>
<p><img src="02.0_Rcomputation_files/figure-html/as%20boxplot1-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">help</span>(boxplot) <span class="co"># get more information about the boxplot.</span></code></pre></div>
<p>If we choose a smaller value for the <em>range</em> argument of boxplot we can make some values appear like outliers. Note that 1.5 is a commonly accepted value for range. Just to see how the plots behave with a different range, we copy the code above and re-run it after changing the range value.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myrange.factor =<span class="st"> </span><span class="fl">0.5</span>

<span class="kw">boxplot</span>(heifer<span class="op">$</span>Birth_Wt, <span class="dt">range =</span> myrange.factor)

<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">0.70</span>, <span class="dt">y =</span> <span class="kw">median</span>(heifer<span class="op">$</span>Birth_Wt), <span class="dt">label =</span> <span class="st">&quot;Median&quot;</span>)

<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">0.65</span>, <span class="dt">y =</span> <span class="kw">quantile</span>(heifer<span class="op">$</span>Birth_Wt, <span class="fl">0.75</span>), <span class="dt">label =</span> <span class="st">&quot;3rd quartile or 75% quantile&quot;</span>)

<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.30</span>, <span class="dt">y =</span> <span class="kw">quantile</span>(heifer<span class="op">$</span>Birth_Wt, <span class="fl">0.75</span>), <span class="dt">label =</span> <span class="st">&quot;Upper Hinge&quot;</span>)

<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">0.65</span>, <span class="dt">y =</span> <span class="kw">quantile</span>(heifer<span class="op">$</span>Birth_Wt, <span class="fl">0.25</span>), <span class="dt">label =</span> <span class="st">&quot;1st quartile or 25% quantile&quot;</span>)

<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">1.30</span>, <span class="dt">y =</span> <span class="kw">quantile</span>(heifer<span class="op">$</span>Birth_Wt, <span class="fl">0.25</span>), <span class="dt">label =</span> <span class="st">&quot;Lower Hinge&quot;</span>)

<span class="co"># To get the location of the top &quot;fence&quot; we need to identify the datapoint that is closest to but no greater than the upper hinge plus 1.5 * interquartile range.</span>

(iqrange &lt;-<span class="st"> </span><span class="kw">IQR</span>(heifer<span class="op">$</span>Birth_Wt)) <span class="co"># Calculate the interquartile range</span></code></pre></div>
<pre><code>## [1] 13.5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(uplimit &lt;-<span class="st"> </span><span class="kw">quantile</span>(heifer<span class="op">$</span>Birth_Wt, <span class="fl">0.75</span>) <span class="op">+</span><span class="st"> </span>myrange.factor <span class="op">*</span><span class="st"> </span>iqrange)</code></pre></div>
<pre><code>##   75% 
## 90.75</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(rows.where.lt.uplimit &lt;-<span class="st"> </span><span class="kw">which</span>(heifer<span class="op">$</span>Birth_Wt <span class="op">&lt;=</span><span class="st"> </span>uplimit)) <span class="co"># gives row numbers of those that are less than uplimit</span></code></pre></div>
<pre><code>##   [1]   1   2   3   4   5   6   7   8   9  11  12  13  15  16  17  18  19
##  [18]  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36
##  [35]  37  38  39  40  41  43  44  45  46  47  49  50  51  52  53  54  55
##  [52]  56  57  58  59  60  62  63  64  65  66  68  69  70  71  72  73  74
##  [69]  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  91  92
##  [86]  93  94  95  96  97  98  99 100 101 102 103 104 105 106 108 109 110
## [103] 111 112 113 114 115 116 117 118 119 120 121 123 124 125 126 127 128
## [120] 130 131 132 134 135 136 137 138 140 141 142 143 145 146 148 149 150
## [137] 151 152 153 155 156 157 158 159 161 162 163 164 165 166 167</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heifer<span class="op">$</span>Birth_Wt[rows.where.lt.uplimit] <span class="co"># gives bwt in those rows</span></code></pre></div>
<pre><code>##   [1] 81 63 72 71 81 86 76 82 74 88 88 79 82 64 70 70 70 80 66 52 80 78 70
##  [24] 82 79 86 82 70 86 58 87 81 82 82 67 62 72 79 80 82 78 74 81 82 84 52
##  [47] 72 78 86 66 54 78 76 75 77 78 81 68 75 86 72 84 58 64 85 71 78 82 82
##  [70] 74 72 68 42 81 76 72 72 74 68 56 82 70 88 76 74 88 58 68 61 74 79 88
##  [93] 84 61 90 78 78 54 85 78 68 71 76 84 84 76 51 65 70 78 44 72 62 74 78
## [116] 72 84 83 76 73 82 84 80 68 83 61 62 84 85 67 78 78 82 84 84 80 79 78
## [139] 90 84 58 71 84 80 50 83 85 48 84 74 58</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(up.fence &lt;-<span class="st"> </span><span class="kw">max</span>(heifer<span class="op">$</span>Birth_Wt[rows.where.lt.uplimit])) <span class="co"># gives the value we seek</span></code></pre></div>
<pre><code>## [1] 90</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(outl &lt;-<span class="st"> </span>heifer<span class="op">$</span>Birth_Wt[heifer<span class="op">$</span>Birth_Wt <span class="op">&gt;</span><span class="st"> </span>up.fence]) <span class="co"># We have 90 outliers!</span></code></pre></div>
<pre><code>##  [1]  94  94  91  97  91 112  95  92  96  91  92  92  94  92  96  98</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">0.65</span>, <span class="dt">y =</span> up.fence, <span class="dt">label =</span> <span class="st">&quot;Upper Fence&quot;</span>)</code></pre></div>
<p><img src="02.0_Rcomputation_files/figure-html/as%20boxplot2-1.png" width="672" /></p>
<p><strong>PUT THIS IN THE CORRECT PLACE</strong></p>
<p>Note that the uniform distribution U(0, 1) is the distribution of the random numbers generated by the function RAND() in Excel. For more details on this distribution, see Uniform Distribution at <a href="https://en.wikipedia.org/wiki/Uniform_distribution_(continuous)" class="uri">https://en.wikipedia.org/wiki/Uniform_distribution_(continuous)</a>.</p>
<span class="math display" id="eq:unifPdf">\[\begin{equation}
f(x) =
  \begin{cases}
    \frac{1}{b-a}       &amp; \quad \text{if } a \leq x \leq b \\
    0                   &amp; \quad \text{otherwise }
  \end{cases}
    \tag{3.1}
\end{equation}\]</span>
<p><strong>DOWN TO HERE</strong></p>
<p>The values for the five-number summary can be obtained directly with the fivenum() function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pander</span>(<span class="kw">cbind</span>(<span class="kw">c</span>(<span class="st">&quot;min&quot;</span>, <span class="st">&quot;lower hinge&quot;</span>, <span class="st">&quot;median&quot;</span>, <span class="st">&quot;upper hinge&quot;</span>, <span class="st">&quot;max&quot;</span>), <span class="kw">fivenum</span>(heifer<span class="op">$</span>Birth_Wt)))</code></pre></div>
<table style="width:28%;">
<colgroup>
<col width="19%" />
<col width="8%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="center">min</td>
<td align="center">42</td>
</tr>
<tr class="even">
<td align="center">lower hinge</td>
<td align="center">70.5</td>
</tr>
<tr class="odd">
<td align="center">median</td>
<td align="center">78</td>
</tr>
<tr class="even">
<td align="center">upper hinge</td>
<td align="center">84</td>
</tr>
<tr class="odd">
<td align="center">max</td>
<td align="center">112</td>
</tr>
</tbody>
</table>
</div>
<div id="analyses-by-groups-1" class="section level3">
<h3><span class="header-section-number">3.2.6</span> Analyses by Groups</h3>
<p>The heifer data has groups defined by the year. Because the group numbers are just labels, we need to transform them into what is called “factor” class in R. This way, we can apply functions that obtain summaries and figures for each group. We can see if there are any differences in the birth weight across the three years for heifers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heifer<span class="op">$</span>year &lt;-<span class="st"> </span><span class="kw">factor</span>(heifer<span class="op">$</span>Birth_Year)

<span class="kw">summary</span>(heifer)</code></pre></div>
<pre><code>##        No             ID              Birth_Year      Birth_Wt    
##  Min.   :  1.0   Length:167         Min.   :2005   Min.   : 42.0  
##  1st Qu.: 42.5   Class :character   1st Qu.:2005   1st Qu.: 70.5  
##  Median : 84.0   Mode  :character   Median :2005   Median : 78.0  
##  Mean   : 84.4                      Mean   :2005   Mean   : 76.6  
##  3rd Qu.:126.5                      3rd Qu.:2005   3rd Qu.: 84.0  
##  Max.   :168.0                      Max.   :2005   Max.   :112.0  
##                                                                   
##    Birth_Date                     Dam_Age     
##  Min.   :2005-01-17 00:00:00   Min.   : 2.00  
##  1st Qu.:2005-09-16 00:00:00   1st Qu.: 4.00  
##  Median :2005-10-01 00:00:00   Median : 7.00  
##  Mean   :2005-08-22 05:36:17   Mean   : 6.06  
##  3rd Qu.:2005-10-23 00:00:00   3rd Qu.: 8.00  
##  Max.   :2005-12-09 00:00:00   Max.   :12.00  
##                                               
##    Wean_Date                      Wean_AGE        Wean_Wt     
##  Min.   :2005-08-17 00:00:00   Min.   :158.0   Min.   :344.0  
##  1st Qu.:2006-04-26 00:00:00   1st Qu.:190.0   1st Qu.:478.5  
##  Median :2006-05-10 00:00:00   Median :211.0   Median :522.0  
##  Mean   :2006-03-17 12:47:25   Mean   :207.3   Mean   :528.1  
##  3rd Qu.:2006-05-15 00:00:00   3rd Qu.:224.0   3rd Qu.:573.0  
##  Max.   :2006-05-19 00:00:00   Max.   :243.0   Max.   :704.0  
##                                                               
##     Wt_205d         Wean_Ht        Year_Date                  
##  Min.   :395.9   Min.   : 0.00   Min.   :2006-03-02 00:00:00  
##  1st Qu.:492.1   1st Qu.:42.15   1st Qu.:2006-09-25 00:00:00  
##  Median :539.3   Median :44.00   Median :2006-10-26 00:00:00  
##  Mean   :537.4   Mean   :36.39   Mean   :2006-09-03 10:03:35  
##  3rd Qu.:585.2   3rd Qu.:45.15   3rd Qu.:2006-10-27 00:00:00  
##  Max.   :744.1   Max.   :49.80   Max.   :2006-10-27 00:00:00  
##                                                               
##     Year_AGE        Year_Wt          Wt_365d      
##  Min.   :320.0   Min.   : 604.0   Min.   : 616.9  
##  1st Qu.:363.5   1st Qu.: 739.0   1st Qu.: 737.9  
##  Median :383.0   Median : 806.0   Median : 806.3  
##  Mean   :377.2   Mean   : 812.7   Mean   : 805.0  
##  3rd Qu.:396.0   3rd Qu.: 879.0   3rd Qu.: 867.3  
##  Max.   :409.0   Max.   :1066.0   Max.   :1087.6  
##                                                   
##     US _Date                        REA               FT        
##  Min.   :2006-03-02 00:00:00   Min.   : 6.400   Min.   :0.0800  
##  1st Qu.:2006-09-25 00:00:00   1st Qu.: 8.900   1st Qu.:0.1800  
##  Median :2006-10-26 00:00:00   Median : 9.800   Median :0.2300  
##  Mean   :2006-09-03 09:46:20   Mean   : 9.752   Mean   :0.2411  
##  3rd Qu.:2006-10-27 00:00:00   3rd Qu.:10.600   3rd Qu.:0.2900  
##  Max.   :2006-10-27 00:00:00   Max.   :12.900   Max.   :0.5400  
##                                                                 
##       IMF                 bin       year    
##  Min.   :1.740   (77,85.8]  :64   2005:167  
##  1st Qu.:3.440   (68.2,77]  :39             
##  Median :3.810   (85.8,94.5]:23             
##  Mean   :3.902   (59.5,68.2]:20             
##  3rd Qu.:4.440   (50.8,59.5]:11             
##  Max.   :6.720   (94.5,103] : 5             
##                  (Other)    : 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(heifer)</code></pre></div>
<pre><code>## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    167 obs. of  21 variables:
##  $ No        : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ ID        : chr  &quot;2005060&quot; &quot;2005062&quot; &quot;2005076&quot; &quot;2005080&quot; ...
##  $ Birth_Year: num  2005 2005 2005 2005 2005 ...
##  $ Birth_Wt  : num  81 63 72 71 81 86 76 82 74 94 ...
##  $ Birth_Date: POSIXct, format: &quot;2005-01-28&quot; &quot;2005-02-19&quot; ...
##  $ Dam_Age   : num  2 2 6 5 6 6 3 3 3 7 ...
##  $ Wean_Date : POSIXct, format: &quot;2005-08-30&quot; &quot;2005-08-30&quot; ...
##  $ Wean_AGE  : num  214 192 198 194 191 190 210 205 185 169 ...
##  $ Wean_Wt   : num  660 455 416 434 534 520 575 625 630 510 ...
##  $ Wt_205d   : num  690 536 428 455 567 ...
##  $ Wean_Ht   : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ Year_Date : POSIXct, format: &quot;2006-03-09&quot; &quot;2006-03-09&quot; ...
##  $ Year_AGE  : num  405 383 390 386 383 382 401 396 376 360 ...
##  $ Year_Wt   : num  902 690 866 730 812 788 852 946 1040 780 ...
##  $ Wt_365d   : num  892 732 803 701 799 ...
##  $ US _Date  : POSIXct, format: &quot;2006-03-09&quot; &quot;2006-03-09&quot; ...
##  $ REA       : num  10.47 7.6 10.07 9.42 10.28 ...
##  $ FT        : num  0.37 0.12 0.23 0.08 0.2 0.11 0.17 0.14 0.22 0.12 ...
##  $ IMF       : num  4.18 3.19 3.65 3.26 4.08 3.01 3.12 3.5 5.14 3.4 ...
##  $ bin       : Factor w/ 8 levels &quot;(41.9,50.8]&quot;,..: 5 3 4 4 5 6 4 5 4 6 ...
##  $ year      : Factor w/ 1 level &quot;2005&quot;: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(Birth_Wt <span class="op">~</span><span class="st"> </span>year, <span class="dt">data =</span> heifer, <span class="dt">notch =</span> <span class="ot">TRUE</span>) <span class="co"># boxplots by treatment</span></code></pre></div>
<p><img src="02.0_Rcomputation_files/figure-html/as%20grouped-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">help</span>(by) <span class="co"># by produces a list with an element for each value of the grouping variable.</span>

<span class="kw">pander</span>(sumry.by.temp &lt;-<span class="st"> </span><span class="kw">by</span>(<span class="dt">data =</span> heifer<span class="op">$</span>Birth_Wt, <span class="dt">INDICES =</span> heifer<span class="op">$</span>year, <span class="dt">FUN =</span> summary))</code></pre></div>
<ul>
<li><p><strong>2005</strong>:</p>
<table style="width:68%;">
<colgroup>
<col width="9%" />
<col width="13%" />
<col width="12%" />
<col width="9%" />
<col width="13%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Min.</th>
<th align="center">1st Qu.</th>
<th align="center">Median</th>
<th align="center">Mean</th>
<th align="center">3rd Qu.</th>
<th align="center">Max.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">42</td>
<td align="center">70.5</td>
<td align="center">78</td>
<td align="center">76.6</td>
<td align="center">84</td>
<td align="center">112</td>
</tr>
</tbody>
</table></li>
</ul>
<!-- end of list -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(fiven.by.temp &lt;-<span class="st"> </span><span class="kw">by</span>(<span class="dt">data =</span> heifer<span class="op">$</span>Birth_Wt, <span class="dt">INDICES =</span> heifer<span class="op">$</span>year, <span class="dt">FUN =</span> fivenum))</code></pre></div>
<pre><code>## heifer$year: 2005
## [1]  42.0  70.5  78.0  84.0 112.0</code></pre>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exercises.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
