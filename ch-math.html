<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <meta name="description" content="">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  


<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Applied Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path=""><a href="#ch.math"><i class="fa fa-check"></i><b>1</b> Required Math Skills and Symbols</a><ul>
<li class="chapter" data-level="1.1" data-path=""><a href="#math.obj"><i class="fa fa-check"></i><b>1.1</b> Learning Objectives for Chapter</a></li>
<li class="chapter" data-level="1.2" data-path=""><a href="#math.sum"><i class="fa fa-check"></i><b>1.2</b> Data Columns and Summation</a></li>
<li class="chapter" data-level="1.3" data-path=""><a href="#math.2Dtbl"><i class="fa fa-check"></i><b>1.3</b> Two-dimensional Data Tables and Summation</a></li>
<li class="chapter" data-level="1.4" data-path=""><a href="#math.modl"><i class="fa fa-check"></i><b>1.4</b> Models</a><ul>
<li class="chapter" data-level="1.4.1" data-path=""><a href="#math.smplMod"><i class="fa fa-check"></i><b>1.4.1</b> The simplest model</a></li>
<li class="chapter" data-level="1.4.2" data-path=""><a href="#math.bttrMod"><i class="fa fa-check"></i><b>1.4.2</b> A slightly more complex model</a></li>
<li class="chapter" data-level="1.4.3" data-path=""><a href="#mathGroups"><i class="fa fa-check"></i><b>1.4.3</b> Grouping or Indicator Variables</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path=""><a href="#mathDevs"><i class="fa fa-check"></i><b>1.5</b> Deviations, Errors and Residuals</a><ul>
<li class="chapter" data-level="1.5.1" data-path=""><a href="#mathSimu"><i class="fa fa-check"></i><b>1.5.1</b> Simulation: Population is Known</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path=""><a href="#mathOptim"><i class="fa fa-check"></i><b>1.6</b> Optimization</a></li>
<li class="chapter" data-level="1.7" data-path=""><a href="#math.symbls"><i class="fa fa-check"></i><b>1.7</b> Symbols and Terms</a></li>
<li class="chapter" data-level="1.8" data-path=""><a href="#math.exe"><i class="fa fa-check"></i><b>1.8</b> Exercises and Solutions</a><ul>
<li class="chapter" data-level="1.8.1" data-path=""><a href="#exercise-1"><i class="fa fa-check"></i><b>1.8.1</b> Exercise 1</a></li>
<li class="chapter" data-level="1.8.2" data-path=""><a href="#exercise-2"><i class="fa fa-check"></i><b>1.8.2</b> Exercise 2</a></li>
<li class="chapter" data-level="1.8.3" data-path=""><a href="#exercise-3"><i class="fa fa-check"></i><b>1.8.3</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path=""><a href="#mathHwk"><i class="fa fa-check"></i><b>1.9</b> Homework</a><ul>
<li class="chapter" data-level="1.9.1" data-path=""><a href="#homework-exercise"><i class="fa fa-check"></i><b>1.9.1</b> Homework Exercise</a></li>
<li class="chapter" data-level="1.9.2" data-path=""><a href="#homework-exercise-1"><i class="fa fa-check"></i><b>1.9.2</b> Homework Exercise</a></li>
<li class="chapter" data-level="1.9.3" data-path=""><a href="#homework-exercise-2"><i class="fa fa-check"></i><b>1.9.3</b> Homework Exercise</a></li>
<li class="chapter" data-level="1.9.4" data-path=""><a href="#homework-exercise-3"><i class="fa fa-check"></i><b>1.9.4</b> Homework Exercise</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:title:end-->
<!--bookdown:title:start-->
<div id="ch.math" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Required Math Skills and Symbols</h1>
<p>In this chapter we introduce most of the mathematics and symbols that are used in the book. We start with the concept and symbols for summation used to represent sums of many numbers generally and succinctly. We use simple numerical examples for which we give the mathematical equations and the corresponding R code to perform the operations. In order to present the symbols in a context that is relevant for the rest of the book, we dive into equations for averages and variances, and we present models. At this point, the definitions of mean, variance, etc. and the formulation of specific models are not the main points, and they will be presented later in more detail.</p>
<p>A key point in this chapter is that in statistics we are always using models, and that making those models explicit by writing them down completely is essential to understanding and communicating what we are doing. The chapter develops a couple of models of increasing complexity and uses those to present the equations, symbols and mathematical concepts that are used throughout the rest of the book.</p>
<p>A second key concept, related to the first one, is that we rarely, if ever, can know the actual “true” value of parameters, variables or quantities about the real world. We do not know parameter values because we rarely know or even have access to the whole population, which would be necessary to “measure” a parameter like the true mean. Measurements are imperfect because measuring instruments have limited precision, and because they are used by “imperfect” humans that make all sorts of errors. The imperfection of measurements should rarely be an issue for the topics covered in this course, and our focus is on estimation of unknown parameters. However, when dealing with chaotic systems, for example in weather forecasting, the imprecision of the measurements is a major limitation, because even minute errors in measurement grow exponentially over time. Although the physical properties of the atmosphere are well known, the imperfection of measurements prevent long-term prediction of specific weather with high confidence.</p>
<p>In reading this chapter, focus on the symbols and concepts. In addition to, and better before doing the exercises, students should make sure that they can reproduce the tables of symbols with subscripts, and the symbols for specific table elements and sums of elements. We recommend writing down the equations as they are read, and then trying to reproduce them from memory and a description of the calculation (e.g. sum of all moisture values for corn in fields 3 through 7). This will greatly facilitate the attention to the symbols and details of each equation, and will reveal those aspects that are were not yet clear to the reader.</p>
<div id="math.obj" class="section level2">
<h2><span class="header-section-number">1.1</span> Learning Objectives for Chapter</h2>
<ol style="list-style-type: decimal">
<li>Identify and write down simple statistical models.</li>
<li>Read and interpret mathematical equations.</li>
<li>Identify random and fixed components of statistical models.</li>
<li>Pair symbols with corresponding concepts or definitions.</li>
<li>Express sums using summation symbol and expand sums defined with the summation symbol.</li>
<li>Calculate sum of squared deviations for a set of numbers.</li>
<li>Identify the symbols that correspond to standard deviation, variance, population mean, and sample average.</li>
<li>List different strategies we can use to find the optimal value for an unknown parameter.</li>
<li>Identify and write down polynomials and linear combinations of parameters.</li>
</ol>
</div>
<div id="math.sum" class="section level2">
<h2><span class="header-section-number">1.2</span> Data Columns and Summation</h2>
<p>Summations, the sum of several numbers that are organized with subscripts, is used all the time in statistics. In order to be able to read equations and understand the concepts in them, you have to be familiar with summations. The Greek letter capital sigma <span class="math inline">\(\Sigma\)</span> is used to represent summation. For example, <span class="math inline">\(\sum_{i=1}^{4} Y_i\)</span> represents the sum <span class="math inline">\(Y_1 + Y_2 + Y_3 + Y_4\)</span>. Sometimes, for simplicity, when we want to sum over all possible values of the subscript i from <span class="math inline">\(i = 1\)</span> to the maximum but unspecified value of <span class="math inline">\(i = k\)</span>, we write <span class="math inline">\(\sum_{i=1}^k Y_i\)</span>, meaning “sum of all values of <span class="math inline">\(Y_i\)</span>.”</p>
<p>We can write a symbol for all the <span class="math inline">\(Y_i\)</span> to avoid having to write each one of them. All the values of <span class="math inline">\(Y\)</span> in the correct order constitute a <em>vector</em> of values. We use bold letters to refer to vectors. Suppose we have a vector with the numbers 7, 5, 9 and 6. We write this as:</p>
<span class="math display" id="eq:math01">\[\begin{equation}
\mathbf{Y} = \begin{pmatrix} Y_1 &amp; Y_2 &amp; Y_3 &amp; Y_4 \end{pmatrix} = \begin{pmatrix} 7 &amp; 5 &amp; 9 &amp; 6 \end{pmatrix} = \left( Y_i \right) \quad i = 1, \dots, 4
\tag{1.1}
\end{equation}\]</span>
<p>where it is implied that <span class="math inline">\(Y_1 = 7\)</span>, <span class="math inline">\(Y_2 = 5\)</span>, <span class="math inline">\(Y_3 = 9\)</span> and <span class="math inline">\(Y_4 = 6\)</span>. There are no calculations or concepts here other than the fact that vectors are sets of numbers with order, and that we can refer to them with symbols. In R we can define the vector and give it values using the <code>c</code> function, which stands for “combine.”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">6</span>)
<span class="kw">print</span>(Y)</code></pre></div>
<pre><code>## [1] 7 5 9 6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The &quot;[1]&quot; on the left simply indicates that 7 is the first element in the vector.</span></code></pre></div>
<p>These summation equations have parallels in R code. In R, we put all values of Y in a vector, and the subscripts are automatically assigned or implicit based on the position of each value of Y. You can think of the vector being a column, so the positions of the vector elements are the row numbers.</p>
<p>We can refer to each element in Y by using its row number or index number inside brackets and right next to the name of the vector. For example, <code>Y[2]</code> is the second element of Y, which is the number 5. Using different expressions instead of a single number we can extract any parts of Y we need to operate with.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Extract the third element of Y</span>
Y[<span class="dv">3</span>]</code></pre></div>
<pre><code>## [1] 9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The &quot;[1]&quot; on the left simply indicates that 3 is the first element </span>
<span class="co"># in the vector represented by the third element of Y.</span>

<span class="co"># Extract elements 2 to 3 of Y</span>
Y[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</code></pre></div>
<pre><code>## [1] 5 9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The &quot;[1]&quot; on the left simply indicates that 5 is the first element </span>
<span class="co"># in the vector represented by the third and forth elements of Y.</span>

<span class="co"># Extract elements 1, 3 and 4 of Y</span>
Y[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">4</span>)]</code></pre></div>
<pre><code>## [1] 7 9 6</code></pre>
<p>Consider the following to get an idea of what the symbols mean and how they work.</p>
<span class="math display" id="eq:math02">\[\begin{equation} 
\sum\mathbf{Y} = \sum_{i=1}^{i=4} Y_i = Y_1 + Y_2 + Y_3 + Y_4 = 7 + 5 + 9 + 6 = 27
\tag{1.2}
\end{equation}\]</span>
<p>Because most R operations are vectorized, if we want to use the whole vector we do not need to specify subscripts, R takes <code>sum(Y)</code> to mean “sum all elements of Y.” To sum parts of a vector we need to use the extraction method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(Y)</code></pre></div>
<pre><code>## [1] 27</code></pre>
<span class="math display" id="eq:math03">\[\begin{equation} 
\displaystyle\sum_{i=2}^{i=4} Y_i = Y_2 + Y_3 + Y_4 = 5 + 9 + 6 = 20
\tag{1.3}
\end{equation}\]</span>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(Y[<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>])</code></pre></div>
<pre><code>## [1] 20</code></pre>
<p>The subscripts for summations can themselves be equations, which makes these formulas very versatile, although in this course we will not be using many complicated subscripts.</p>
<span class="math display" id="eq:math04">\[\begin{equation} 
\displaystyle\sum_{i=1}^{i=3} Y_{i} = \displaystyle\sum_{i=2}^{i=4} Y_{i-1} = Y_1 + Y_2 + Y_3 = 7 + 5 + 9 = 21
\tag{1.4}
\end{equation}\]</span>
<span class="math display" id="eq:math05">\[\begin{equation} 
\begin{aligned}
\displaystyle\sum_{i=1}^{i=3} \left( Y_{i} + Y_{i+1} \right) &amp;= \left( Y_1 + Y_2 \right) + \left( Y_2 + Y_3 \right) + \left( Y_3 + Y_4 \right) \\ &amp;= 
Y_1 + Y_2 + Y_2 + Y_3 + Y_3 + Y_4 \\ \\ &amp;= 
7 + 5 + 5 + 9 + 9 + 6 = 41
\end{aligned}
\tag{1.5}
\end{equation}\]</span>
<p>As usual, there are many ways to achieve a task in R. To perform the sum above we can use the following alternatives:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(Y[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] <span class="op">+</span><span class="st"> </span>Y[<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>])</code></pre></div>
<pre><code>## [1] 41</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(Y[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y[<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>])</code></pre></div>
<pre><code>## [1] 41</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">i &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>
<span class="kw">sum</span>(Y[i] <span class="op">+</span><span class="st"> </span>Y[i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>])</code></pre></div>
<pre><code>## [1] 41</code></pre>
<p>In order to explain further properties of the summation, let’s use a second vector represented by the letter <span class="math inline">\(\mathbf{X}\)</span>, where</p>
<span class="math display" id="eq:math06">\[\begin{equation} 
\mathbf{X} = \begin{pmatrix} X_1 &amp; X_2 &amp; X_3 &amp; X_4 \end{pmatrix} = \begin{pmatrix} 3 &amp; 2 &amp; 4 &amp; 5 \end{pmatrix} = \left( X_i \right) \quad i = 1, \dots, 4
\tag{1.6}
\end{equation}\]</span>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>)
<span class="kw">print</span>(X)</code></pre></div>
<pre><code>## [1] 3 2 4 5</code></pre>
<p>The notation is very general and can be used to express sums like the following sum of products of corresponding elements in <span class="math inline">\(\mathbf{X}\)</span> and <span class="math inline">\(\mathbf{Y}\)</span>:</p>
<span class="math display" id="eq:math07">\[\begin{equation} 
\begin{aligned}
\displaystyle\sum_{i=1}^{i=4} (X_{i} \ Y_{i}) 
&amp;= (X_1 \ Y_1) + (X_2 \ Y_2) + (X_3 \ Y_3) + (X_4 \ Y_4) \\ &amp;= 
3 \times 7 + 2 \times 5 + 4 \times 9 + 5 \times 6 = 97
\end{aligned}
\tag{1.7}
\end{equation}\]</span>
</div>
<div id="math.2Dtbl" class="section level2">
<h2><span class="header-section-number">1.3</span> Two-dimensional Data Tables and Summation</h2>
<p>The vectors <span class="math inline">\(\mathbf{X}\)</span> and <span class="math inline">\(\mathbf{Y}\)</span> used above are 1-dimensional; they are single columns of numbers. Frequently, data is organized in more than one dimension, as in a 2-dimensional table with rows and columns. A conventional and very clear way to represent those tables is a matrix where each element is identified by its “address” in the table given by the row and column numbers, always in that order. The subscript <span class="math inline">\(i\)</span> refers to rows and <span class="math inline">\(j\)</span> refers to columns. We illustrate this with an example in which soil moisture was measured under wheat, corn and tomatoes in each of 7 fields (numbers are fictitious). The matrix is built by using rows for crop and columns for fields. Note that the subscripts are not numbers with 2 digits, but two single-digit integer written together; subscript 26 does <strong>not</strong> mean 2 times 10 plus 6 times 1, but simply the second row and sixth column. For situations when there are more than 9 rows and or columns, we use a separator between the row and column numbers to avoid ambiguity (for example, to be able to tell if <span class="math inline">\(Y_{162}\)</span> is row 1 column 62 or row 16 column 2 we use <span class="math inline">\(Y_{1,62}\)</span> or <span class="math inline">\(Y_{16,2}\)</span>. The comma is omitted when each subscript is never greater than 9.</p>
<br />
<br />

<span class="math display" id="eq:math08">\[\begin{equation} 
\mathbf{Y} = 
 \begin{pmatrix}
  Y_{1,1} &amp; Y_{1,2} &amp; Y_{1,3} &amp; Y_{1,4}  &amp; Y_{1,5}  &amp; Y_{1,6}  &amp; Y_{1,7} \\
  Y_{2,1} &amp; Y_{2,2} &amp; Y_{2,3} &amp; Y_{2,4}  &amp; Y_{2,5}  &amp; Y_{2,6}  &amp; Y_{2,7} \\
  Y_{3,1} &amp; Y_{3,2} &amp; Y_{3,3} &amp; Y_{3,4}  &amp; Y_{3,5}  &amp; Y_{3,6}  &amp; Y_{3,7} 
  \end{pmatrix} \\[35pt] = 
  \begin{pmatrix}
34 &amp; 32 &amp; 27 &amp; 37 &amp; 25 &amp; 23 &amp; 30 \\
30 &amp; 26 &amp; 26 &amp; 33 &amp; 24 &amp; 22 &amp; 27 \\
29 &amp; 27 &amp; 24 &amp; 34 &amp; 23 &amp; 20 &amp; 26 
 \end{pmatrix}
 \tag{1.8}
\end{equation}\]</span>
<p><br />
<br />
In R we can define a matrix or a dataframe with rows and columns. We use a dataframe because it is the most common form for data in R and in science in general. Instead of Y, in the code below we call the data “Ydata” to avoid conflicts with the names of the vectors used above. First we make vectors of data for each crop and then we join them into a data frame with the <code>rbind</code> function, which stands for “row bind.”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wheat &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">34</span>, <span class="dv">32</span>, <span class="dv">27</span>, <span class="dv">37</span>, <span class="dv">25</span>, <span class="dv">23</span>, <span class="dv">30</span>)
corn &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">26</span>, <span class="dv">26</span>, <span class="dv">33</span>, <span class="dv">24</span>, <span class="dv">22</span>, <span class="dv">27</span>)
tomat &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">29</span>, <span class="dv">27</span>, <span class="dv">24</span>, <span class="dv">34</span>, <span class="dv">23</span>, <span class="dv">20</span>, <span class="dv">26</span>)

Ydata &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(
   <span class="kw">rbind</span>(wheat, corn, tomat)
)

<span class="kw">names</span>(Ydata) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;field1&quot;</span>, 
                  <span class="st">&quot;field2&quot;</span>, 
                  <span class="st">&quot;field3&quot;</span>, 
                  <span class="st">&quot;field4&quot;</span>, 
                  <span class="st">&quot;field5&quot;</span>, 
                  <span class="st">&quot;field6&quot;</span>, 
                  <span class="st">&quot;field7&quot;</span>)

Ydata</code></pre></div>
<pre><code>##       field1 field2 field3 field4 field5 field6 field7
## wheat     34     32     27     37     25     23     30
## corn      30     26     26     33     24     22     27
## tomat     29     27     24     34     23     20     26</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Ydata[<span class="dv">5</span>, <span class="dv">2</span>] <span class="co"># Soil moisture for field 5 with corn</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>In general, for a table of values with k rows and r columns we write:</p>
<span class="math display" id="eq:math09">\[\begin{equation} 
\mathbf{Y}_{k,r} = 
 \begin{pmatrix}
  Y_{1,1} &amp; Y_{1,2} &amp; \cdots &amp; Y_{1,r} \\
  Y_{2,1} &amp; Y_{2,2} &amp; \cdots &amp; Y_{2,r} \\
  \vdots  &amp; \vdots  &amp; \ddots &amp; \vdots  \\
  Y_{k,1} &amp; Y_{k,2} &amp; \cdots &amp; Y_{k,r} 
 \end{pmatrix}
\tag{1.9}
 \end{equation}\]</span>
<p>If we want to average all values in the table we need to use a double summation to indicate that the sum is supposed to proceed over rows and columns. As an exercise to make sure you understand the subscripts, write down the matrix <span class="math inline">\(\mathbf{Y}\)</span> with all subscripts without looking at the book</p>
$$
<span class="math display" id="eq:math10">\[\begin{equation} 
\begin{aligned}
&amp;\sum_{i=1}^{i=3} \displaystyle\sum_{j=1}^{j=7} \frac{Y_{ij}} {3 \times 7} = 
\frac{1}{3 \times 7} \ \sum_{i=1}^{i=3}\sum_{j=1}^{j=7}Y_{ij} \\[20pt] 
&amp;= \frac{1}{3 \times 7} \left( 
\sum_{j=1}^{j=7}Y_{1j} + 
\sum_{j=1}^{j=7}Y_{2j} + 
\sum_{j=1}^{j=7}Y_{3j} \right) \\[18pt]

&amp;= \frac{1}{3 \times 7} \ (Y_{11} + Y_{12} + Y_{13} + Y_{14} + Y_{15} + Y_{16} + Y_{17} \\
&amp; \qquad \qquad + Y_{21} + Y_{22} Y_{23} + Y_{24} + Y_{25} + Y_{26} + Y_{27} \\[8pt]
&amp; \qquad \qquad + Y_{31} + Y_{32} + Y_{33} + Y_{34} + Y_{35} + Y_{36} + Y_{37}) \\[20pt] 
&amp; = \frac{1}{7 \times 3} \ (34 + 32 + 27 + 37 + 25 + 23 + 30 \\
&amp; \qquad \qquad + 30 + 26 + 26 + 33 + 24 + 22 + 27 \\
&amp; \qquad \qquad + 29 + 27 + 24 + 34 + 23 + 20 + 26) = \frac{579}{21} = 27.57
\end{aligned}
\tag{1.10}
\end{equation}\]</span>
<p>$$</p>
<p>Using R we can calculate the sums and the average very easily. Note that the functions <code>nrow</code> and <code>ncol</code> extract the number of rows and columns of a data frame or matrix. The function <code>mean</code> yields the average for the whole table.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(Ydata) <span class="co"># Sums all values in table. Double summation.</span></code></pre></div>
<pre><code>## [1] 579</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># (Works only when all columns are numeric.)</span>

<span class="kw">nrow</span>(Ydata) <span class="co"># Ydata has 3 rows: k = 3</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ncol</span>(Ydata) <span class="co"># and 7 columns: r = 7</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(Ydata) <span class="op">/</span><span class="st"> </span>(<span class="kw">nrow</span>(Ydata) <span class="op">*</span><span class="st"> </span><span class="kw">ncol</span>(Ydata)) <span class="co"># Overall average</span></code></pre></div>
<pre><code>## [1] 27.57143</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(<span class="kw">as.matrix</span>(Ydata)) <span class="co"># Average of all values in table</span></code></pre></div>
<pre><code>## [1] 27.57143</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># (Works only when all columns are numeric.)</span></code></pre></div>
<p>If we just want the average for corn we specify just the row for corn (row 2) and sum over all columns for row 2. If we want the results for a field or a set of fields, we specify the corresponding column numbers. Let’s calculate the average moisture for corn and then the average for fields 3, 4, 5 and 7.</p>
<span class="math display" id="eq:math11">\[\begin{equation} 
\begin{aligned}
&amp;corn \ average = \frac{1}{7} \left( \sum_{j=1}^{i=7}Y_{2j} \right) \\[15pt] 
&amp;= \frac{1}{7} (Y_{21} + Y_{22} + Y_{23} + Y_{24} + Y_{25} + Y_{26} + Y_{27}) \\[15pt]
&amp;= \frac{1}{7} (30 + 26 + 26 + 33 + 24 + 22 + 27) = 26.86
\end{aligned}
\tag{1.11}
\end{equation}\]</span>
\
<span class="math display" id="eq:math12">\[\begin{equation} 
\begin{aligned}
&amp;fields \ 3, \ 4, \ 5 \ \&amp; \ 7 \ average = \frac{1}{4 \times 3} \left( \sum_{j=1}^{j=3}Y_{3j} + 
\sum_{j=1}^{j=3}Y_{4j} + 
\sum_{j=1}^{j=3}Y_{5j} + 
\sum_{j=1}^{j=3}Y_{7j} \right) \\[20pt]
&amp;= \frac{1}{4 \times 3} (Y_{31} + Y_{32} + Y_{33} + Y_{41} + Y_{42} + Y_{43} + Y_{51} + Y_{52} + Y_{53} + Y_{71} + Y_{72} + Y_{73}) \\[20pt]
&amp;= \frac{1}{4 \times 3} (27 + 26 + 24 + 37 + 33 + 34 + 25 + 24 + 23 + 30 + 27 + 26) \\[20pt]
&amp;= \frac{336}{12} = 28.0
\end{aligned}
\tag{1.12}
\end{equation}\]</span>
<p>We obtain those averages in R with the following code. Note that when we leave the place for row (or column) number empty, it is interpreted as all rows (or columns).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(<span class="kw">as.numeric</span>(Ydata[<span class="dv">2</span>, ])) <span class="co"># Average for corn across fields</span></code></pre></div>
<pre><code>## [1] 26.85714</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Note that the row has to be transformed into a numeric vector</span>
<span class="co"># before it can be used with the function &quot;mean.&quot;</span>

<span class="kw">sum</span>(Ydata[<span class="dv">2</span>, ]) <span class="co"># This sums all values for row 2 which is corn</span></code></pre></div>
<pre><code>## [1] 188</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(Ydata[<span class="dv">2</span>, ]) <span class="co"># This calculates the value of r for corn</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(Ydata[<span class="dv">2</span>, ]) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(Ydata[<span class="dv">2</span>, ]) <span class="co"># Average for corn</span></code></pre></div>
<pre><code>## [1] 26.85714</code></pre>
</div>
<div id="math.modl" class="section level2">
<h2><span class="header-section-number">1.4</span> Models</h2>
<p>In statistics we use models all the time, and it is necessary to make those models explicit. Explicit models make it easier to understand and critically evaluate the use of statistics. Specifically, we can determine what parts of the model may be inadequate to solve the problem at hand, and we can modify the model to improve it.</p>
<div id="math.smplMod" class="section level3">
<h3><span class="header-section-number">1.4.1</span> The simplest model</h3>
<p>Say that we are interested in studying the milk production per dairy cow in <span class="math inline">\(kg \ day^{-1}\)</span> for all dairy cows in the US today. For example, we want to estimate what proportion of cows produce less than <span class="math inline">\(24 \ kg \ day^{-1}\)</span> to gauge the number of cows that could be targets of a program to increase productivity. One way to do this is to create a <em>model</em> for the statistical distribution of milk production, take a sample to estimate the parameters of the model and then use the model with estimated parameters to make the estimation of the proportion of cows for which production is less than <span class="math inline">\(24 \ kg \ day^{-1}\)</span> or any other quantity.</p>
<p>A first attempt to estimate the needed proportion is to <em>model</em> milk production per cow as a normal distributed random variable with unknown mean and variance. Using the letter <span class="math inline">\(Y\)</span> to represent the milk production of a cow we write <span class="math inline">\(Y \sim N(\mu, \sigma^2)\)</span>, which is read “Y is a random variable with normal distribution, with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>.” Sometimes we write <span class="math inline">\(\sigma\)</span>, the standard deviation, instead of <span class="math inline">\(\sigma^2\)</span>. Obviously, the standard deviation is the square root of the variance.</p>
<p>The model is not correct, and it could not be correct, for a number of reasons. First, normal distributions can take any values between <span class="math inline">\(-\infty\)</span> and <span class="math inline">\(+\infty\)</span>, whereas milk production is zero or positive, but it cannot be negative. Moreover, if we are considering the population to be all the dairy cows in the US, although there are many dairy cows in the US (USDA estimated 9.3 million cows and heifers in 2014), the number is finite, whereas the normal distribution is for infinite populations. Yet, these flaws of our model are not important.</p>
<hr />
<blockquote>
<blockquote>
<p>Models are not supposed to be perfect representations of reality,</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>they are supposed to be <strong>useful</strong> representations of reality.</p>
</blockquote>
</blockquote>
<hr />
<p>Assuming that the variance of milk production is small relative to the mean, the fact that production has to be positive is not a problem, because a tiny and irrelevant piece of the distribution is expected to be below zero. The fact the the number of cows is finite is not a problem because we can either think of the total population as a very, very large sample of a truly infinite theoretical cow population or simply use the normal as an approximation to the truly discrete and finite real population.</p>
<p>The simple model that we are using can also be expressed as follows:</p>
<span class="math display" id="eq:math13">\[\begin{equation} 
\begin{aligned}
Y_i = \mu + \epsilon_i \\[10pt]
\epsilon_i \sim N(0, \sigma^2)
\end{aligned}
\tag{1.13}
\end{equation}\]</span>
<p>where <span class="math inline">\(Y_i\)</span> is the milk produced by cow number<span class="math inline">\(i\)</span>, <span class="math inline">\(\mu\)</span> is the population mean and <span class="math inline">\(\epsilon\)</span> is a random variable with a normal distribution with mean 0 and variance <span class="math inline">\(\sigma^2\)</span>. This is exactly the same model as before, but now we have isolated the deviations of each cow from the mean for the whole population which we call “errors” not because there is anything wrong, but because we choose not to be interested in why cows differ in milk production per day. In this model, milk production is partitioned into an overall mean and a random “error.”</p>
<p>The equation <span class="math inline">\(\epsilon_i \sim N(0, \sigma^2)\)</span> is actually a simplified version of <span class="math inline">\(\epsilon_i \sim iid \quad N(0, \sigma^2) \quad \forall i\)</span>, which means that the errors for all observations have independent and identical normal distributions with mean 0 and variance <span class="math inline">\(\sigma^2\)</span>. Why is it necessary to state this?! Isn’t <span class="math inline">\(\epsilon\)</span> just one random variable? Actually, it does not have to be, so we need to specify how we are modeling the errors. In reality, it is possible for the error for each observation to come from a different distribution, although a model with such complexity would probably not be useful. Errors can also come from distributions that are not independent. The potential differences in error distributions and their correlations are topics for a more advanced course. At this point, you should just keep in mind that in real-world applications of statistics one frequently finds errors that are not normal, have unequal variances, and/or are correlated. The more advanced models necessary to deal with those situations include parts and parameters to deal with lack of normality, heterogeneity of variance and lack of independence.</p>
<p>In order to use the simple model to estimate the proportion of cows that produce less than <span class="math inline">\(24 \ kg \ day^{-1}\)</span> we can get a random sample of r cows and, based on that sample, estimate the mean as</p>
<span class="math display" id="eq:math14">\[\begin{equation} 
\hat{\mu} = \frac{1}{r} \sum_{i=1}^{i=r} Y_i 
\tag{1.14}
\end{equation}\]</span>
<p>and the variance as</p>
<span class="math display" id="eq:math15">\[\begin{equation} 
\hat{\sigma^2} =\frac{1}{r-1} \sum_{i=1}^{i=r} (Y_i-\hat{\mu})^2
\tag{1.15}
\end{equation}\]</span>
<p>where <span class="math inline">\(e = \hat{\epsilon} = (Y_i-\hat{\mu})\)</span> are the deviations of each cow from the estimated overall mean. These equations are presented with more detail in a later chapter (@ref(ch.anova)). Finally, the proportion of cows whose daily milk production is less than <span class="math inline">\(24 \ kg \ day^{-1}\)</span> is estimated as the area under the normal distribution curve between <span class="math inline">\(-\infty\)</span> and <span class="math inline">\(24 \ kg \ day^{-1}\)</span>. Using the capital letter<span class="math inline">\(P\)</span> to indicate “probability” we can write:</p>
<span class="math display" id="eq:math16">\[\begin{equation} 
\begin{aligned}
&amp;\hat{P}(Y \le 24 \ kg \ day^{-1}) = area \ under \ curve = \int_{-\infty}^{24} f(Y) \ \mathrm{d}Y \\[20pt]
&amp;where \ f(Y) = \frac{1}{{\hat{\sigma} \sqrt{2\pi}}} \  \mathrm{exp} \left( {  - \left( {x - \hat{\mu} } \right) ^ 2 / {2\hat{\sigma}^2}} \right)
\end{aligned}
\tag{1.16}
\end{equation}\]</span>
<p>Suppose that the estimated mean and variance were <span class="math inline">\(28.3 \ kg \ day^{-1}\)</span> and <span class="math inline">\(25 \ kg^2 \ day^{-2}\)</span>. USDA reported an average production of <span class="math inline">\(28.3 \ kg \ day^{-1}\)</span> of milk per milking cow in 2016 (<a href="https://www.nass.usda.gov/Publications/Ag_Statistics/2017/Chapter08.pdf" class="uri">https://www.nass.usda.gov/Publications/Ag_Statistics/2017/Chapter08.pdf</a>). The variance was not reported, so we use a fictitious number: <span class="math inline">\(\hat\sigma^2 = 25\)</span>. The area under the curve (figure @ref(fig:prop.lt.mean)) would be calculated in R as follows (note how the code is written in several lines and indented for better readability):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pnorm</span>(           <span class="co"># function that calculates areas unde the normal</span>
   <span class="dt">q =</span> <span class="dv">24</span>,       <span class="co"># quantile desired, max. milk production in set</span>
   <span class="dt">mean =</span> <span class="fl">28.3</span>,    <span class="co"># mean of the normal distribution</span>
   <span class="dt">sd =</span> <span class="dv">5</span>        <span class="co"># standard distribution of the normal distribution</span>
)</code></pre></div>
<pre><code>## [1] 0.1948945</code></pre>
<div class="figure">
<img src="03.0_MathSymbols_files/figure-html/prop.lt.mean-1.png" alt="Simplest model for daily milk production per cow. The blue line is the probability density function (pdf) for a normal distribution with mean 28.3 and variance 25. According to this model, the area under the curve between any two values of Y (horizontal axis) represents the proportion of cows that have production between those values. The light blue area is the estimated proportion of cows that produce less than 24 kg per day. This is an estimated proportion because the actual mean and variance of the cow population are not known and were estimated based on a sample." width="672" />
<p class="caption">
(#fig:prop.lt.mean)Simplest model for daily milk production per cow. The blue line is the probability density function (pdf) for a normal distribution with mean 28.3 and variance 25. According to this model, the area under the curve between any two values of Y (horizontal axis) represents the proportion of cows that have production between those values. The light blue area is the estimated proportion of cows that produce less than 24 kg per day. This is an estimated proportion because the actual mean and variance of the cow population are not known and were estimated based on a sample.
</p>
</div>
<p>We used a very simple model for milk production with just two parameters, mean and variance. Mean and variance are called the “fixed” or non-random parts, and the error is the “random” component. When we use statistics and create models we need to choose what will be represented with fixed parameters and what parts will be represented with random variables or components. Except for the case where we consider sub-sampling, this course will only deal with models that have a single random component and we use the Greek letter <span class="math inline">\(\epsilon\)</span> (epsilon) for it.<br />
<br />
<span class="math display">\[ data = Systematic \ Structure + Random \ Variation \\[10pt]
= Fixed \ Component + Random \ Component \\[10pt]
= Fixed \ Component + Structured \ Random + White \ Noise\]</span></p>
<p><br />
Models that partition the random component into structured and unstructured (white noise) random parts are beyond the scope of this book.</p>
<table class="kable_wrapper">
<caption>
(#tab:math.tab01)Milk production per lactating dairy cow in the US, by state in 2016. Based on USDA reports.
</caption>
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="left">State</th>
<th align="right">kg.cow.day</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alabama</td>
<td align="right">16.3</td>
</tr>
<tr class="even">
<td align="left">Alaska</td>
<td align="right">14.5</td>
</tr>
<tr class="odd">
<td align="left">Arizona</td>
<td align="right">30.4</td>
</tr>
<tr class="even">
<td align="left">Arkansas</td>
<td align="right">16.4</td>
</tr>
<tr class="odd">
<td align="left">California</td>
<td align="right">28.5</td>
</tr>
<tr class="even">
<td align="left">Colorado</td>
<td align="right">32.3</td>
</tr>
<tr class="odd">
<td align="left">Connecticut</td>
<td align="right">26.7</td>
</tr>
<tr class="even">
<td align="left">Delaware</td>
<td align="right">23.7</td>
</tr>
<tr class="odd">
<td align="left">Florida</td>
<td align="right">25.3</td>
</tr>
<tr class="even">
<td align="left">Georgia</td>
<td align="right">27.1</td>
</tr>
<tr class="odd">
<td align="left">Hawaii</td>
<td align="right">18.1</td>
</tr>
<tr class="even">
<td align="left">Idaho</td>
<td align="right">30.6</td>
</tr>
<tr class="odd">
<td align="left">Illinois</td>
<td align="right">25.2</td>
</tr>
<tr class="even">
<td align="left">Indiana</td>
<td align="right">28.0</td>
</tr>
<tr class="odd">
<td align="left">Iowa</td>
<td align="right">29.4</td>
</tr>
<tr class="even">
<td align="left">Kansas</td>
<td align="right">28.3</td>
</tr>
<tr class="odd">
<td align="left">Kentucky</td>
<td align="right">22.5</td>
</tr>
<tr class="even">
<td align="left">Louisiana</td>
<td align="right">17.5</td>
</tr>
<tr class="odd">
<td align="left">Maine</td>
<td align="right">26.1</td>
</tr>
<tr class="even">
<td align="left">Maryland</td>
<td align="right">24.8</td>
</tr>
<tr class="odd">
<td align="left">Massachusetts</td>
<td align="right">22.3</td>
</tr>
<tr class="even">
<td align="left">Michigan</td>
<td align="right">32.3</td>
</tr>
<tr class="odd">
<td align="left">Minnesota</td>
<td align="right">26.1</td>
</tr>
<tr class="even">
<td align="left">Mississippi</td>
<td align="right">17.9</td>
</tr>
<tr class="odd">
<td align="left">Missouri</td>
<td align="right">19.4</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="left">State</th>
<th align="right">kg.cow.day</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Montana</td>
<td align="right">26.2</td>
</tr>
<tr class="even">
<td align="left">Nebraska</td>
<td align="right">29.0</td>
</tr>
<tr class="odd">
<td align="left">Nevada</td>
<td align="right">27.3</td>
</tr>
<tr class="even">
<td align="left">NewHampshire</td>
<td align="right">25.2</td>
</tr>
<tr class="odd">
<td align="left">NewJersey</td>
<td align="right">21.7</td>
</tr>
<tr class="even">
<td align="left">NewMexico</td>
<td align="right">30.4</td>
</tr>
<tr class="odd">
<td align="left">NewYork</td>
<td align="right">29.6</td>
</tr>
<tr class="even">
<td align="left">NorthCarolina</td>
<td align="right">26.1</td>
</tr>
<tr class="odd">
<td align="left">NorthDakota</td>
<td align="right">26.8</td>
</tr>
<tr class="even">
<td align="left">Ohio</td>
<td align="right">25.9</td>
</tr>
<tr class="odd">
<td align="left">Oklahoma</td>
<td align="right">23.2</td>
</tr>
<tr class="even">
<td align="left">Oregon</td>
<td align="right">25.8</td>
</tr>
<tr class="odd">
<td align="left">Pennsylvania</td>
<td align="right">25.4</td>
</tr>
<tr class="even">
<td align="left">RhodeIsland</td>
<td align="right">21.7</td>
</tr>
<tr class="odd">
<td align="left">SouthCarolina</td>
<td align="right">20.7</td>
</tr>
<tr class="even">
<td align="left">SouthDakota</td>
<td align="right">27.5</td>
</tr>
<tr class="odd">
<td align="left">Tennessee</td>
<td align="right">20.6</td>
</tr>
<tr class="even">
<td align="left">Texas</td>
<td align="right">28.2</td>
</tr>
<tr class="odd">
<td align="left">Utah</td>
<td align="right">28.3</td>
</tr>
<tr class="even">
<td align="left">Vermont</td>
<td align="right">26.0</td>
</tr>
<tr class="odd">
<td align="left">Virginia</td>
<td align="right">23.8</td>
</tr>
<tr class="even">
<td align="left">Washington</td>
<td align="right">29.9</td>
</tr>
<tr class="odd">
<td align="left">WestVirginia</td>
<td align="right">18.5</td>
</tr>
<tr class="even">
<td align="left">Wisconsin</td>
<td align="right">29.3</td>
</tr>
<tr class="odd">
<td align="left">Wyoming</td>
<td align="right">29.0</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
</div>
<div id="math.bttrMod" class="section level3">
<h3><span class="header-section-number">1.4.2</span> A slightly more complex model</h3>
<p>The model used above and stated in equation <a href="#eq:math13">(1.13)</a> can be improved in many ways. For example, we may guess that a lot the variance in productivity can be between states, due to different levels of investment and development of the industry in different states. By adding a part to account for differences among states in the fixed part of the model we can have much better predictions of the proportion of cows below <span class="math inline">\(15 \ kg \ day^{-1}\)</span> for each state. The model would look like this:</p>
<span class="math display" id="eq:math17">\[\begin{equation}
\begin{aligned}
Y_{ij} &amp;= \mu_{i.} + \epsilon_{ij} \\[10pt]
&amp;=  \mu_{..} + \tau_{i.} + \epsilon_{ij} \\[10pt]
\epsilon &amp;\sim N(0, \sigma^2)
\end{aligned}
\tag{1.17}
\end{equation}\]</span>
<p>where <span class="math inline">\(\mu_{i.}\)</span> is the mean for state <span class="math inline">\(i\)</span> and <span class="math inline">\(\tau_{i.}\)</span> is called the “effect” of state <span class="math inline">\(i\)</span>. In general, when we have observations that are grouped like cows in states, we can view the model as allowing a separate mean for each group or as each group having an effect on the mean. Both views are equivalent and their relationship is given by the fact that the effect is defined as the difference between each group mean and the overall mean: <span class="math inline">\(\tau_{i.} = \mu_{i.} - \mu_{..}\)</span>. The “dots” in the subscript are used as place-holders for the subscript and to indicate that the average (or sum) has been done over all values of that subscript. Because the number of cows differs among states, the overall mean in this model has to be estimated as the average of the state averages, where each state receives equal weight: <span class="math inline">\(\hat{\mu}_{..} = \sum_{i=1}^{50} \hat{\mu}_{i.} / 50\)</span>. This estimated overall mean is 25.1123929 <span class="math inline">\(kg \ day^{-1}\)</span>.</p>
</div>
<div id="mathGroups" class="section level3">
<h3><span class="header-section-number">1.4.3</span> Grouping or Indicator Variables</h3>
<p>The model above can be written in a different form that is useful for further understanding of more advanced linear models, and to be used in the formulation of contrasts and custom comparisons an linear combinations of parameters presented in the chapter about <a href="#chTrtstr">treatment structure and comparisons</a>. This form is presented here to prepare students for that topic and for further studies that require writing down the models in matrix notation. Keep in mind that the use of matrix notation does not have to involve any more complicated concepts than the understanding that we are working with strings and tables of numbers, instead of single numbers at a time.</p>
<p>Grouping or indicator variables are variables that take a value of 0 or 1 and are used to multiply parameters to determine if the parameters are included in the model for any given observation. The trick is that the equation includes all the parameters and then the values of the grouping variable are used to apply each parameter to the right rows of data. There are as many grouping variables as there are groups. For example, if an experiment has 3 treatment, there will be 3 grouping variables. Essentially, each variable “marks” each observation that belongs to a group.</p>
Perhaps an analogy helps clarify the concept before we show the equations. Think of a model as a recipe where the parameters are the ingredients and the grouping variables indicate if the ingredient is or not in the recipe. For example, consider a simple recipe that can be made either with chicken, tofu or beef, and with mild or spicy chili peppers. The recipe will have a list of amounts and ingredients <a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>:<br />
<br />

<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:recipe">Table 1.1: </span>Flexible recipe
</caption>
<thead>
<tr>
<th style="text-align:center;">
amounts
</th>
<th style="text-align:left;">
ingredient
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:left;">
egg
</td>
</tr>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:left;">
pinch of salt
</td>
</tr>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:left;">
dash of black pepper
</td>
</tr>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:left;">
cup of diced chicken, tofu, or beef
</td>
</tr>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:left;">
cup of chopped onion
</td>
</tr>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:left;">
tbs of curry paste
</td>
</tr>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:left;">
cup of jalapeños or poblano peppers
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:left;">
cup of red cabbage
</td>
</tr>
</tbody>
</table>
<p><br />
</p>
This looks like a single recipe, but it can yield 6 different dishes depending on whether you use beef, tofu or chicken, and jalapeños or poblano peppers. It is a lot simpler and shorter to write the recipe as above than to write 6 different recipes that are almost the same, at least in structure. The same happens with models. In fact, theoretically, any recipe can be expressed with this format if all ingredients are listed separately. With one row per ingredient we can decide how much (possibly none) of each ingredient to add. Let’s look at the ingredients in the example. The idea can be extended to any number of ingredients, and it is based on having a list of ingredients, so we know what the quantities refer to.<br />

<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:recipe2">Table 1.2: </span>Numerical recipes
</caption>
<thead>
<tr>
<th style="text-align:center;">
ingredient
</th>
<th style="text-align:center;">
hot_chicken
</th>
<th style="text-align:center;">
mild_chicken
</th>
<th style="text-align:center;">
hot_tofu
</th>
<th style="text-align:center;">
mild_tofu
</th>
<th style="text-align:center;">
hot_beef
</th>
<th style="text-align:left;">
mild_beef
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
eggs
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:center;">
pinch of salt
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
dash of black pepper
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
cup of diced chicken
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
cup of diced tofu
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
cup of diced beef
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
cup of chopped onion
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
tbs of curry paste
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
cup of jalapeños
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
cup of poblano peppers
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
cup of red cabbage
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:left;">
2
</td>
</tr>
</tbody>
</table>
<p><br />
Now, the table represents each recipe with a set of numbers, and all recipes use the same list of potential ingredients. Note that when we want the chicken, the row for chicken shows a 1 and the rows for tofu and beef <strong>must</strong> show 0’s. The same happens with jalapeños and poblano peppers. The amounts for those ingredients are the grouping or indicator variables that indicate which recipe type or group we want.</p>
We can easily show that the statistical models are like recipes <a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a> by chaging the symbols we use. We can simplify by noting that all recipes we are considering take eggs, salt, pepper, onions, curry paste and cabbage in the same amounts across recipes. We will refer to all of those ingredients together in the specified quantities as “common” ingredients, and to conform with the usual mathematical notation, we transpose the recipe table and put the dishes in rows and ingredients in columns with shortened names.<br />

<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:recipe3">Table 1.3: </span>Mathematical recipes
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
common
</th>
<th style="text-align:center;">
chicken
</th>
<th style="text-align:center;">
tofu
</th>
<th style="text-align:center;">
beef
</th>
<th style="text-align:center;">
jalap
</th>
<th style="text-align:center;">
pobla
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
hot_chicken
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
mild_chicken
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
hot_tofu
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
mild_tofu
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
hot_beef
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
mild_beef
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
1
</td>
</tr>
</tbody>
</table>
<p>For example, the first row of the table indicates that to make the spicy hot chicken version you add all common ingredients plus the chicken plus none of the tofu plus none of the beef, plus the jalapeño plus none of the poblanos. Note that we have three columns for protein type and two for pepper type, there is one column per option or group in each category. This is because any protein option can be combined with any pepper option, however only one protein and only one pepper type is allowed in any one dish. Additionally, whatever the dish you make, it must have a protein source and a pepper type. As a consequence of this, if you add the columns for protein or the columns for chili peppers you always get 1, regardless of the row.</p>
<p>The column for chicken is the grouping variable that groups all recipes with chicken protein. Its value is defined as follows:</p>
<span class="math display" id="eq:math18">\[\begin{equation}
chicken \ group = G_1 = 
  \begin{cases}
    1       &amp; \quad \text{if dish has chicken, i = 1}\\
    0                   &amp; \quad \text{otherwise}
  \end{cases}
    \tag{1.18}
\end{equation}\]</span>
<p>We name that column <span class="math inline">\(G_1\)</span> because it is the first grouping column, i.e., the subscript “1” is for chicken (think of chicken as treatment 1). Analogously, the columns for tofu and beef are defined as</p>
<p><br></p>
<span class="math display" id="eq:math19">\[\begin{equation}
tofu \ group = G_2 = 
  \begin{cases}
    1       &amp; \quad \text{if dish has tofu, i = 2}\\
    0                   &amp; \quad \text{otherwise}
  \end{cases}
    \tag{1.19}
\end{equation}\]</span>
<p><br></p>
<span class="math display" id="eq:math20">\[\begin{equation}
beef \ group = G_3 = 
  \begin{cases}
    1       &amp; \quad \text{if dish has beef, i = 3}\\
    0                   &amp; \quad \text{otherwise}
  \end{cases}
    \tag{1.20}
\end{equation}\]</span>
<p><br></p>
<p>The same sort of concepts are involved with the choice of pepper. For simplicity, now we consider only the recipes that differ in protein source and assume that all recipes are with poblanos and that poblanos are now included in the common ingredients. We can write the recipes as follows:</p>
<p><br></p>
<p><span class="math display">\[dish_i = 1 \times common + G_1 \times chicken + G_2 \times tofu + G_3 \times beef\]</span> <br></p>
<p>We can think of this equation/recipe as follows: if we want the chicken version then <span class="math inline">\(G1 = 1\)</span>, $ G_2 = 0$ and <span class="math inline">\(G_3 = 0\)</span>. The result indicates to include the common ingredients, plus the chicken plus none of the tofu plus none of the beef, which is is simply: common ingredients and chicken. The common ingredients are like the overall mean, and chicken, tofu and beef are the effects of each of the protein choices; think of them as treatments. In which case the equation becomes:</p>
<p><span class="math display">\[\mu + G_1 \ \tau_1 + G_2 \ \tau_2 + G_3 \ \tau_3 = \mu + \sum_{i=1}^3G_i \ \tau_i\]</span> <br></p>
</div>
</div>
<div id="mathDevs" class="section level2">
<h2><span class="header-section-number">1.5</span> Deviations, Errors and Residuals</h2>
<p>The difference between an observation and the mean is called a <em>deviation</em>, <em>residual</em> or <em>error</em>. The specific name depends on the context, but in general, we will use <em>deviation</em> for the total difference between observation and overall average, <em>residual</em> for the difference between an observation and the value estimated by a model, and <em>error</em> for the random component of a model.</p>
<span class="math display" id="eq:math18">\[\begin{equation} 
\begin{aligned}
&amp;error = \epsilon &amp;\textrm{a random variable}\\[15pt]
&amp;total \ deviation = Y_{ij} - \mu{..} &amp;\textrm{difference between observation and mean} \\[15pt]
&amp;residual = e = \hat{\epsilon} = Y_{ij} - \hat{Y_{ij}} &amp;\textrm{estimated error based on sample}
\end{aligned}
\tag{1.18}
\end{equation}\]</span>
<p>The symbol <span class="math inline">\(\hat{Y}_{ij}\)</span> is read “Y hat sub i j” and it represents the value that would be expected for that observation if the experiment were repeated many, many times. Intuitively, it is the best guess that you have for the value that would be observed if a new measurement were done for <span class="math inline">\(Y_{ij}\)</span>, based on data and model. Keep in mind that the subscripts depend on the organization of the data. For the simple model we only need one subscript because there are no groups.</p>
<p>Unfortunately, the terms <em>error</em>, <em>deviation</em> and <em>residual</em> are frequently used interchangeably, but the good news is that the meaning can be easily derived from the context. <strong>Errors</strong> <span class="math inline">\(\epsilon\)</span> are usually not observable and unknown, unless we create them in a computer simulation (see <a href="#math.simu">Simulation</a> section). The main reason for this is that all measurements include some sort of random component that we cannot control, and that we usually do not know all the values in the population of interest; we only have a sample.</p>
<p>Usually, population parameters are unknown and have to be estimated using samples, which is a main focus in statistics. With a model and a sample we can estimate parameter values, such as <span class="math inline">\(\hat{\mu}\)</span> and then by the difference we can estimate the errors. Estimated errors are called <strong>residuals</strong> in part because they are the parts of the observations that remain after all other parts accounted for by the model are subtracted. The total <strong>deviation</strong> is the difference between the value observed <span class="math inline">\(Y_{ij}\)</span> and the overall mean <span class="math inline">\(\mu_{..}\)</span>, typically estimated with the overall average <span class="math inline">\(\bar{Y}_{..}\)</span>.</p>
<p>In the two models above (equations <a href="#eq:math13">(1.13)</a> and <a href="#eq:math17">(1.17)</a> the equations to calculate the residuals are different, because observations are modeled differently. For the simple model, the best guess or estimate that we have for the production of a randomly selected cow (observation) is the overall average given in equation <a href="#eq:math19">(1.19)</a>. Because we are considering all cows <strong>not</strong> grouped by state, the overall average is equal to the weighted average of state averages, or more simply, the average of all cows, regardless of state:</p>
<span class="math display" id="eq:math19">\[\begin{equation}
\hat{Y}_i = \hat{\mu} = \bar{Y}_. \\[10pt]
e = \hat{\epsilon} = Y_i - \hat{Y}_i  = Y_i - \hat{\mu} = Y_i - \bar{Y}_. \\[10pt]
= Observation - Fixed \ Component
\tag{1.19}
\end{equation}\]</span>
<p>In this case of the simplest model, the error is equal to the total deviation, because the model does not have any other fixed component beyond the overall mean.</p>
<p>For the better model in equation <a href="#eq:math17">(1.17)</a>, the fixed part of the model includes both an overall mean and a state effect <span class="math inline">\(\tau_{i.}\)</span> where <span class="math inline">\(i\)</span> is the subscript that specifies what state is being considered. The estimation for any given observation includes both components. Thus, the residual is the observed value <span class="math inline">\(Y_{ij}\)</span> minus the estimated overall mean <span class="math inline">\(\hat{\mu}_{..}\)</span> minus the estimated state effect <span class="math inline">\(\hat{\tau}_{i.}\)</span>.</p>
<span class="math display" id="eq:math20">\[\begin{equation}
\hat{Y}_{ij} = \hat{\mu}_{i.} = \bar{Y}_{i.} = \hat{\mu} + \hat{\tau}_{i.} = \bar{Y}_{..} + \hat{\tau}_{i.}\\[10pt]
e = \hat{\epsilon} = Y_{ij} - \hat{Y}_{ij}  = Y_{ij} - \bar{Y}_{i.} = Y_{ij} - \bar{Y}_{..} - \hat{\tau}_{i.}. \\[10pt]
\tag{1.20}
\end{equation}\]</span>
<p>Keep in mind that the effect of state will be a negative number for those states that have mean milk production that is lower than the average of all states. We can use the values reported by USDA (2017) to determine the state effects for all states.</p>
<p>The dataframe <code>milk</code> has the data, including the state name, average number of milking cows in 2016 (in thousands), total milk production per year (in millions of kg) and average production per cow (in kg per day). First, we calculate the overall average to estimate <span class="math inline">\(\mu\)</span>. Then, the effect of each state is obtained by subtracting the overal mean from the average for each state. (Residuals cannot be calculated because the data reported is at the state level, not for individual cows.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(milk)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    50 obs. of  4 variables:
##  $ State     : Factor w/ 50 levels &quot;Alabama&quot;,&quot;Alaska&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Kcows     : num  7 0.3 196 6 1762 ...
##  $ tot.Mkg   : num  41.73 1.59 2171.8 35.83 18356.43 ...
##  $ kg.cow.day: num  16.3 14.5 30.4 16.4 28.5 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(mu.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(milk<span class="op">$</span>kg.cow.day))</code></pre></div>
<pre><code>## [1] 25.11239</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">milk<span class="op">$</span>state.effect &lt;-<span class="st"> </span>milk<span class="op">$</span>kg.cow.d <span class="op">-</span><span class="st"> </span>mu.hat

knitr<span class="op">::</span><span class="kw">kable</span>(
   <span class="kw">list</span>(
      milk[<span class="dv">1</span><span class="op">:</span><span class="dv">25</span>, <span class="kw">c</span>(<span class="st">&quot;State&quot;</span>, <span class="st">&quot;state.effect&quot;</span>)], 
      milk[<span class="dv">26</span><span class="op">:</span><span class="dv">50</span>, <span class="kw">c</span>(<span class="st">&quot;State&quot;</span>, <span class="st">&quot;state.effect&quot;</span>)]
   ),
   <span class="dt">booktabs =</span> <span class="ot">TRUE</span>, 
   <span class="dt">row.names =</span> <span class="ot">FALSE</span>, 
   <span class="dt">digits =</span> <span class="dv">1</span>,
   <span class="dt">caption =</span> <span class="st">&#39;Effect of state on average milk production per cow per day.&#39;</span>
)</code></pre></div>
<table class="kable_wrapper">
<caption>
<span id="tab:unnamed-chunk-11">Table 1.4: </span>Effect of state on average milk production per cow per day.
</caption>
<tbody>
<tr>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
State
</th>
<th style="text-align:right;">
state.effect
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Alabama
</td>
<td style="text-align:right;">
-8.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Alaska
</td>
<td style="text-align:right;">
-10.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Arizona
</td>
<td style="text-align:right;">
5.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Arkansas
</td>
<td style="text-align:right;">
-8.7
</td>
</tr>
<tr>
<td style="text-align:left;">
California
</td>
<td style="text-align:right;">
3.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Colorado
</td>
<td style="text-align:right;">
7.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Connecticut
</td>
<td style="text-align:right;">
1.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Delaware
</td>
<td style="text-align:right;">
-1.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Florida
</td>
<td style="text-align:right;">
0.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Georgia
</td>
<td style="text-align:right;">
2.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Hawaii
</td>
<td style="text-align:right;">
-7.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Idaho
</td>
<td style="text-align:right;">
5.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Illinois
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Indiana
</td>
<td style="text-align:right;">
2.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Iowa
</td>
<td style="text-align:right;">
4.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Kansas
</td>
<td style="text-align:right;">
3.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Kentucky
</td>
<td style="text-align:right;">
-2.7
</td>
</tr>
<tr>
<td style="text-align:left;">
Louisiana
</td>
<td style="text-align:right;">
-7.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Maine
</td>
<td style="text-align:right;">
1.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Maryland
</td>
<td style="text-align:right;">
-0.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Massachusetts
</td>
<td style="text-align:right;">
-2.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Michigan
</td>
<td style="text-align:right;">
7.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Minnesota
</td>
<td style="text-align:right;">
0.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Mississippi
</td>
<td style="text-align:right;">
-7.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Missouri
</td>
<td style="text-align:right;">
-5.7
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
State
</th>
<th style="text-align:right;">
state.effect
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Montana
</td>
<td style="text-align:right;">
1.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Nebraska
</td>
<td style="text-align:right;">
3.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Nevada
</td>
<td style="text-align:right;">
2.2
</td>
</tr>
<tr>
<td style="text-align:left;">
NewHampshire
</td>
<td style="text-align:right;">
0.1
</td>
</tr>
<tr>
<td style="text-align:left;">
NewJersey
</td>
<td style="text-align:right;">
-3.5
</td>
</tr>
<tr>
<td style="text-align:left;">
NewMexico
</td>
<td style="text-align:right;">
5.3
</td>
</tr>
<tr>
<td style="text-align:left;">
NewYork
</td>
<td style="text-align:right;">
4.5
</td>
</tr>
<tr>
<td style="text-align:left;">
NorthCarolina
</td>
<td style="text-align:right;">
1.0
</td>
</tr>
<tr>
<td style="text-align:left;">
NorthDakota
</td>
<td style="text-align:right;">
1.7
</td>
</tr>
<tr>
<td style="text-align:left;">
Ohio
</td>
<td style="text-align:right;">
0.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Oklahoma
</td>
<td style="text-align:right;">
-1.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Oregon
</td>
<td style="text-align:right;">
0.7
</td>
</tr>
<tr>
<td style="text-align:left;">
Pennsylvania
</td>
<td style="text-align:right;">
0.3
</td>
</tr>
<tr>
<td style="text-align:left;">
RhodeIsland
</td>
<td style="text-align:right;">
-3.4
</td>
</tr>
<tr>
<td style="text-align:left;">
SouthCarolina
</td>
<td style="text-align:right;">
-4.4
</td>
</tr>
<tr>
<td style="text-align:left;">
SouthDakota
</td>
<td style="text-align:right;">
2.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Tennessee
</td>
<td style="text-align:right;">
-4.5
</td>
</tr>
<tr>
<td style="text-align:left;">
Texas
</td>
<td style="text-align:right;">
3.1
</td>
</tr>
<tr>
<td style="text-align:left;">
Utah
</td>
<td style="text-align:right;">
3.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Vermont
</td>
<td style="text-align:right;">
0.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Virginia
</td>
<td style="text-align:right;">
-1.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Washington
</td>
<td style="text-align:right;">
4.8
</td>
</tr>
<tr>
<td style="text-align:left;">
WestVirginia
</td>
<td style="text-align:right;">
-6.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Wisconsin
</td>
<td style="text-align:right;">
4.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Wyoming
</td>
<td style="text-align:right;">
3.8
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<div id="mathSimu" class="section level3">
<h3><span class="header-section-number">1.5.1</span> Simulation: Population is Known</h3>
<p>A simulation consists of making up a model with known parameters and generatign data by taking random samples from the theoretical distribution specified in the model. Then, the data are analyzed as if the model were not known and results compared to the known model values. This is an empirical method to check if the method of analysis leads to good estimates. By repeating the random sampling many times, we can get simulated distributions of the estimated parameters.</p>
<p>Here, we simply use a simulation to show how sample results and estimated quantities are different from the real values. We cannot do this with real data because we tpically do not know the true parameter values.</p>
<p>The simulation will create data analogous to the US milk production data. For simplicity, we will use a sample of 100 cows per state. Thus, the weighted and unweighted averages will be the same. We will use the same values as above for state means. Note that here we use the averages reported by USDA as if they were the known means for each state. Because the variance within each state is not known, we use <span class="math inline">\(\sigma = 4\)</span> for all states. The model used to generate data is:</p>
<span class="math display" id="eq:math21">\[\begin{equation}
Y_{ij} = \mu_{i.} + \epsilon_{ij} = \mu_{..} + \tau_{i.} + \epsilon_{ij} \\
\epsilon_{ij} \sim N(0, \ \sigma = 4) 
\tag{1.21}
\end{equation}\]</span>
<p>For each state, we simulate 100 observations by generating 100 random draws from a normal distribution with mean 0 standard deviation 4 and to each we add the state average. Figure @ref(fig:resdl.vs.error) shows that residuals are not equal to the true errors, but they are related.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">39</span>)

milk.sim.dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">State =</span> <span class="kw">rep</span>(milk<span class="op">$</span>State, <span class="dv">100</span>), 
                           <span class="dt">state.mean =</span> <span class="kw">rep</span>(milk<span class="op">$</span>kg.cow.day, <span class="dv">100</span>),
                           <span class="dt">epsilon =</span> <span class="kw">rnorm</span>(<span class="dv">5000</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">4</span>))

milk.sim.dat<span class="op">$</span>Y &lt;-<span class="st"> </span><span class="kw">with</span>(milk.sim.dat, state.mean <span class="op">+</span><span class="st"> </span>epsilon)

state.avg &lt;-<span class="st"> </span><span class="kw">aggregate</span>(Y <span class="op">~</span><span class="st"> </span>State, 
                       <span class="dt">data =</span> milk.sim.dat,
                       <span class="dt">FUN =</span> mean)

<span class="kw">names</span>(state.avg)[<span class="dv">2</span>] &lt;-<span class="st"> &quot;state.average&quot;</span>

milk.sim.dat &lt;-<span class="st"> </span><span class="kw">merge</span>(milk.sim.dat, state.avg, <span class="dt">by =</span> <span class="st">&quot;State&quot;</span>, <span class="dt">all =</span> <span class="ot">TRUE</span>)

milk.sim.dat<span class="op">$</span>residual =<span class="st"> </span><span class="kw">with</span>(milk.sim.dat, Y <span class="op">-</span><span class="st"> </span>state.average)

<span class="kw">str</span>(milk.sim.dat)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    5000 obs. of  6 variables:
##  $ State        : Factor w/ 50 levels &quot;Alabama&quot;,&quot;Alaska&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ state.mean   : num  16.3 16.3 16.3 16.3 16.3 ...
##  $ epsilon      : num  -0.742 -2.178 1.829 -9.166 -9.399 ...
##  $ Y            : num  15.59 14.16 18.16 7.17 6.93 ...
##  $ state.average: num  16 16 16 16 16 ...
##  $ residual     : num  -0.425 -1.861 2.146 -8.849 -9.082 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(residual <span class="op">~</span><span class="st"> </span>epsilon, milk.sim.dat, <span class="dt">pch =</span> <span class="st">&quot;.&quot;</span>)
<span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>)</code></pre></div>
<div class="figure">
<img src="03.0_MathSymbols_files/figure-html/resdl.vs.error-1.png" alt="Plot of estimated error or residuals vs. the true errors based on a simulation. The true errors come from a normal distribution, whereas the residuals were estimated as the difference between each observation and the corresponding group average. The green line is Y = X." width="672" />
<p class="caption">
(#fig:resdl.vs.error)Plot of estimated error or residuals vs. the true errors based on a simulation. The true errors come from a normal distribution, whereas the residuals were estimated as the difference between each observation and the corresponding group average. The green line is Y = X.
</p>
</div>
</div>
</div>
<div id="mathOptim" class="section level2">
<h2><span class="header-section-number">1.6</span> Optimization</h2>
<p>One way to “guess” or estimate the mean of a distribution using a sample is to calculate the <em>average</em>. The average minimizes the sum of the squared deviations of the observations. Minimization of sums of squares - called “least-squares” - is the most common method we will use to make estimates, but it is not the only method. Another common method used is likelihood maximization, whereby parameters are estimated by choosing the values that maximize the likelihood of observing the data. The good news is that for most of the situations we will study, which involve the use of linear models, least-squares and maximum likelihood yield identical results.</p>
<p>In many cases, the optimal value for a parameter can be found analytically, which means that we can use an equation that yields the best estimate directly. This formula is obtained by taking the first derivative of the equation that calculates the SS as a function of the estimate, set it to zero and solve for the estimate. For some advanced statistical methods, there are no equations available, so numerical computations are used to approximate the optimal estimates.</p>
<p>Linear models are models that can be represented by a linear combination of parameters, it is like a recipe where the ingredients are the parameters. For example, to make a cup of swet tea with milk you combine 1 teaspoon of tea, 1 cup of hot water, 1 tablespoon of honey and 0.25 cups of milk.</p>
<span class="math display">\[\begin{equation}
1 \ cup \ tea = 1 \ tsp \ tea + 1 \ cup \ hot \ water + 1 \ tbsp \ honey + 0.25 \ cup \ milk \\
Y = X_1 \beta_1 + X_2 \beta_2 + X_3 \beta_3 + X_4 \beta_4
\end{equation}\]</span>
<p>What makes the equation <em>linear in the parameters</em> is that the parameters represented by the <span class="math inline">\(\beta\)</span>’s are not in exponents, powers, quotients or operations other than multiplication and addition. Even if the variables that multiply the parameters are involved in any kind of function, for as long as the complicated function does not involve a paramters, the equation is linear *_<em>in the parameters_</em>. For example, the following equations are linear in the parameters represented by the <span class="math inline">\(beta\)</span>’s.</p>
<span class="math display">\[\begin{equation}
Y = X_1^2 \beta_1 + log(X_2) \beta_2 + e^{X_3} \beta_3 + X_4 \beta_4 \\
Y = X_1^0 \beta_0 + X_1^1 \beta_1 + X_1^2 \beta_2 + X_1^3 \beta_2
\end{equation}\]</span>
<p>The second equation is called a <strong>polynomial</strong> because it only involves powers of the variable <span class="math inline">\(X_1\)</span> multiplying the parameters. Because the highest power of X is 3, the polynomial is said to be of <em>3rd degree</em> or a <em>cubic</em> polynomial. Polynomials of 2nd degree are called <em>quadratic</em>. All polynomials are linear combinations of parameters. Typical polynomials of order or degree 0 to 3 are plottled in figure @ref(fig:math.polys).</p>
<div class="figure">
<img src="03.0_MathSymbols_files/figure-html/math.polys-1.png" alt="Types of shapes that can be produced by polynomials of first (black), second (blue) and third (orange) degree. Note that all have ranges where they are almost straight lines. The orientation, location and range of each shape can be changed by changing the values of the parameters of the polynomial." width="672" />
<p class="caption">
(#fig:math.polys)Types of shapes that can be produced by polynomials of first (black), second (blue) and third (orange) degree. Note that all have ranges where they are almost straight lines. The orientation, location and range of each shape can be changed by changing the values of the parameters of the polynomial.
</p>
</div>
<p>Linear combinations are use throughout this book and are important to understand where the basic equations that we use come from. For example, we refer to linear combinations to derive the statistical properties of the sample average, and again to determine if two averages are significantly different <a href="ch.2pops">Chapter 8</a> .</p>
</div>
<div id="math.symbls" class="section level2">
<h2><span class="header-section-number">1.7</span> Symbols and Terms</h2>
<table>
<colgroup>
<col width="18%" />
<col width="81%" />
</colgroup>
<thead>
<tr class="header">
<th>Term or symbol</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Observation</td>
<td>Result of measuring one or several variables in one unit of experimental material. For example, the milk production of one cow in a day.</td>
</tr>
<tr class="even">
<td>Expectation</td>
<td>The mean of a random variable. For example the expectation of number of dots when rolling a cubic die is 3.5.</td>
</tr>
<tr class="odd">
<td>Variance</td>
<td>The expected value of the squared total deviation of a random variable. For a die the variance is 2.9166667</td>
</tr>
<tr class="even">
<td>Mean</td>
<td>Expectation</td>
</tr>
<tr class="odd">
<td>Average</td>
<td>Sum of sample values divided by sample size. For example, the average of a sample of 4 rolls of a die {5, 5, 5, 4} is (5 + 5 + 5 + 4)/4 = 4.75. The average is usually used to estimate the mean.</td>
</tr>
<tr class="even">
<td>Sample Variance</td>
<td>Estimated variance based on a sample. Average of the square deviations from observation to average, but divided by sample size minus the number of other parameters estimated. In the simplest case, the only estimated parameter is the mean so the divisor is n-1.</td>
</tr>
<tr class="odd">
<td>Model</td>
<td>Sets of equations that describe the components of each observation.</td>
</tr>
<tr class="even">
<td>White noise</td>
<td>Random variation with unstructured normal distribution. Independent errors with normal distribution and equal variance.</td>
</tr>
<tr class="odd">
<td>Random</td>
<td>Describes a process or experiment whose result is not known with certainty beforehand.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(Y_i\)</span></td>
<td>Value taken by the <em>ith</em> instance of the variable Y. One observation of Y.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(Y_{ij}\)</span></td>
<td>Y sub i j; value taken by the <em>jth</em> instance of the variable Y in the <em>ith</em> group. One observation of Y when there are groups in one dimension. Value of variable Y in row <em>i</em> and column <em>j</em>.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\hat{Y}_{ij}\)</span></td>
<td>Y hat sub i j; estimated expected value of Y for row i and column j.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(Y_{ijh}\)</span></td>
<td>Y sub i j h. Value taken by the <em>hth</em> instance of the variable Y in the <em>ijth</em> group . One observation of Y when there are groups in two dimensions. Value of variable Y in row <em>i</em>, column <em>j</em> and page <em>h</em>.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\epsilon\)</span></td>
<td>Epsilon. Random error component of a model. Usually modelled itself as having a normal distribution with mean 0 and variance <span class="math inline">\(\sigma^2\)</span>.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\bar{Y}_{i.}\)</span></td>
<td>Y bar sub i dot; average of all Y values observed in group i.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\bar{Y}_{..}\)</span></td>
<td>Y bar dot dot; average of all values.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\mu\)</span></td>
<td>Population mean; a parameter of the normal distribution.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\bar{Y}\)</span></td>
<td>Sample average.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\hat{\mu}\)</span></td>
<td>Mu hat; estimated mean.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\hat{\tau}_{i.}\)</span></td>
<td>Tau hat sub i; estimated effect of treatment i.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\tau_{i.}\)</span></td>
<td>Tau sub i; effect of treatment i.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\mu_{i.}\)</span></td>
<td>Mu sub i; mean for group (usually treatment) i.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\hat{\sigma^2}\)</span></td>
<td>Sigma squared hat; estimated variance of something, usually variance of epsilon.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\sigma^2\)</span></td>
<td>Sigma squared; variance of something, usually variance of epsilon.</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\sigma\)</span></td>
<td>Sigma, standard deviation; square root of variance.</td>
</tr>
<tr class="even">
<td><span class="math inline">\(N(0, \sigma^2)\)</span></td>
<td>Normal distribution with mean 0 and variance <span class="math inline">\(\sigma^2\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\sim\)</span></td>
<td>In R formulas: “is modeled as”; in math equations: “is distributed as.”</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\sum_{i=1}^{i=4} Y_i\)</span></td>
<td>Sum of Y sub i for i equal 1 to 4;</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\sum\)</span></td>
<td>Capital Sigma, summation symbol</td>
</tr>
</tbody>
</table>
</div>
<div id="math.exe" class="section level2">
<h2><span class="header-section-number">1.8</span> Exercises and Solutions</h2>
<div id="exercise-1" class="section level3">
<h3><span class="header-section-number">1.8.1</span> Exercise 1</h3>
<p>Write pseudo-code (set of logical instructions in natural language) for an algorithm to find out what integer between 0 and 1000 I am thinking of just by asking if it is larger than a value that you choose for each question (or to numerically approximate a root of a polynomial).</p>
<p><strong>Solution:</strong></p>
<ol style="list-style-type: decimal">
<li>Set max = 1000</li>
<li>Set min = 0</li>
<li>Set mid = (max + min)/2</li>
<li>Ask if number is greater than mid</li>
<li>if YES, set min = mid and go to step 3 if NO ask if number is equal to mid</li>
<li>if YES stop if NO set max = mid and go to step 3</li>
</ol>
</div>
<div id="exercise-2" class="section level3">
<h3><span class="header-section-number">1.8.2</span> Exercise 2</h3>
<p>Expand the following summations with symbols, then with numbers and calculate it using the data in the table:</p>
<p><span class="math display">\[\sum_{i=1}^{i=4}(Y_i - \bar{Y}_{..})\]</span> <span class="math display">\[\sum_{i=1}^{i=4}(Y_i - \bar{Y}_{..})^2\]</span></p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
i
</th>
<th style="text-align:right;">
Y_i
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5
</td>
</tr>
</tbody>
</table>
<p><strong>Solution:</strong></p>
<p><span class="math display">\[\sum_{i=1}^{i=4}(Y_i - \bar{Y}_{..}) = (Y_1 - \bar{Y}_{..}) + (Y_2 - \bar{Y}_{..}) + (Y_3 - \bar{Y}_{..}) + (Y_4 - \bar{Y}_{..})\\[15pt]
= (6 - 4) + (2 - 4) + (3 - 4) + (5 - 4) = 0\]</span></p>
<p><span class="math display">\[\sum_{i=1}^{i=4}(Y_i - \bar{Y}_{..})^2 = (Y_1 - \bar{Y}_{..})^2 + (Y_2 - \bar{Y}_{..})^2 + (Y_3 - \bar{Y}_{..})^2 + (Y_4 - \bar{Y}_{..})^2\\[15pt]
= (6 - 4)^2 + (2 - 4)^2 + (3 - 4)^2 + (5 - 4)^2 = 4 + 4 + 1 + 1 = 10\]</span></p>
</div>
<div id="exercise-3" class="section level3">
<h3><span class="header-section-number">1.8.3</span> Exercise 3</h3>
<p>The following table has values for <span class="math inline">\(Y_{ij}\)</span>. States are in the rows, and each row has columns for different cows sampled from each state.</p>
<p>What is the sample size r for all states?</p>
<p>What is the value of k?</p>
<p>Write down the equation with summation and symbols and then with numbers for Alabama’s average.</p>
<p>Calculate the averages by state and then all the residuals.</p>
<p>Calculate all estimated state effects.</p>
<p>Write down the partition of three observations into overall average, state effect and residual.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
cow1
</th>
<th style="text-align:right;">
cow2
</th>
<th style="text-align:right;">
cow3
</th>
<th style="text-align:right;">
cow4
</th>
<th style="text-align:right;">
cow5
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Alabama
</td>
<td style="text-align:right;">
15.59
</td>
<td style="text-align:right;">
11.42
</td>
<td style="text-align:right;">
14.62
</td>
<td style="text-align:right;">
13.95
</td>
<td style="text-align:right;">
18.20
</td>
</tr>
<tr>
<td style="text-align:left;">
Alaska
</td>
<td style="text-align:right;">
16.19
</td>
<td style="text-align:right;">
10.41
</td>
<td style="text-align:right;">
12.01
</td>
<td style="text-align:right;">
17.85
</td>
<td style="text-align:right;">
18.35
</td>
</tr>
<tr>
<td style="text-align:left;">
California
</td>
<td style="text-align:right;">
28.96
</td>
<td style="text-align:right;">
28.30
</td>
<td style="text-align:right;">
31.36
</td>
<td style="text-align:right;">
25.52
</td>
<td style="text-align:right;">
26.36
</td>
</tr>
<tr>
<td style="text-align:left;">
Wisconsin
</td>
<td style="text-align:right;">
27.45
</td>
<td style="text-align:right;">
28.80
</td>
<td style="text-align:right;">
31.46
</td>
<td style="text-align:right;">
29.59
</td>
<td style="text-align:right;">
28.34
</td>
</tr>
</tbody>
</table>
<p><strong>Solution</strong></p>
<p>Sample size is 5 cows for each states.</p>
<p>k is the number of rows. There are 4 states in rows, so k = 4.</p>
<p>Alabama is in row 1, thus i = 1. We need to sum over j from j=1 to j=5.</p>
<p><span class="math display">\[\frac{1}{5} \sum_{j=1}^{j=5} Y_{1j} = 15.59 + 11.42 + 14.62 + 13.95 + 18.20 = 14.76\]</span> The rest of the calculations are performed in R to save time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Data are in the matrix called &quot;tbl.exer3.math&quot;</span>
tbl.exer3.math</code></pre></div>
<pre><code>##             cow1  cow2  cow3  cow4  cow5
## Alabama    15.59 11.42 14.62 13.95 18.20
## Alaska     16.19 10.41 12.01 17.85 18.35
## California 28.96 28.30 31.36 25.52 26.36
## Wisconsin  27.45 28.80 31.46 29.59 28.34</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(Alab.avg &lt;-<span class="st"> </span><span class="kw">mean</span>(tbl.exer3.math[<span class="dv">1</span>, ]))</code></pre></div>
<pre><code>## [1] 14.756</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(Alas.avg &lt;-<span class="st"> </span><span class="kw">mean</span>(tbl.exer3.math[<span class="dv">2</span>, ]))</code></pre></div>
<pre><code>## [1] 14.962</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(Cali.avg &lt;-<span class="st"> </span><span class="kw">mean</span>(tbl.exer3.math[<span class="dv">3</span>, ]))</code></pre></div>
<pre><code>## [1] 28.1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(Wisc.avg &lt;-<span class="st"> </span><span class="kw">mean</span>(tbl.exer3.math[<span class="dv">4</span>, ]))</code></pre></div>
<pre><code>## [1] 29.128</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Make a matrix with the averages</span>
(averages &lt;-<span class="st"> </span><span class="kw">rbind</span>(
   <span class="kw">rep</span>(Alab.avg, <span class="dv">5</span>),
   <span class="kw">rep</span>(Alas.avg, <span class="dv">5</span>),
   <span class="kw">rep</span>(Cali.avg, <span class="dv">5</span>),
   <span class="kw">rep</span>(Wisc.avg, <span class="dv">5</span>)
))</code></pre></div>
<pre><code>##        [,1]   [,2]   [,3]   [,4]   [,5]
## [1,] 14.756 14.756 14.756 14.756 14.756
## [2,] 14.962 14.962 14.962 14.962 14.962
## [3,] 28.100 28.100 28.100 28.100 28.100
## [4,] 29.128 29.128 29.128 29.128 29.128</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculate overall average as average of state averages.</span>
<span class="co"># Obviously, this overall average is just for the four states considered,</span>
<span class="co"># and therefore, the state effects are relative to just the four states.</span>

(overall.avg &lt;-<span class="st"> </span>(Alab.avg <span class="op">+</span><span class="st"> </span>Alas.avg <span class="op">+</span><span class="st"> </span>Cali.avg <span class="op">+</span><span class="st"> </span>Wisc.avg) <span class="op">/</span><span class="st"> </span><span class="dv">4</span>)</code></pre></div>
<pre><code>## [1] 21.7365</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># State effects</span>
(st.fx &lt;-<span class="st"> </span>averages <span class="op">-</span><span class="st"> </span>overall.avg)</code></pre></div>
<pre><code>##         [,1]    [,2]    [,3]    [,4]    [,5]
## [1,] -6.9805 -6.9805 -6.9805 -6.9805 -6.9805
## [2,] -6.7745 -6.7745 -6.7745 -6.7745 -6.7745
## [3,]  6.3635  6.3635  6.3635  6.3635  6.3635
## [4,]  7.3915  7.3915  7.3915  7.3915  7.3915</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Residuals</span>
(resdl &lt;-<span class="st"> </span>tbl.exer3.math <span class="op">-</span><span class="st"> </span>averages)</code></pre></div>
<pre><code>##              cow1   cow2   cow3   cow4   cow5
## Alabama     0.834 -3.336 -0.136 -0.806  3.444
## Alaska      1.228 -4.552 -2.952  2.888  3.388
## California  0.860  0.200  3.260 -2.580 -1.740
## Wisconsin  -1.678 -0.328  2.332  0.462 -0.788</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Note that each observation in the original table of data is</span>
<span class="co"># partitioned into overall average, state effect, and residual.</span></code></pre></div>
</div>
</div>
<div id="mathHwk" class="section level2">
<h2><span class="header-section-number">1.9</span> Homework</h2>
<div id="homework-exercise" class="section level3">
<h3><span class="header-section-number">1.9.1</span> Homework Exercise</h3>
<p>Write the following expressions with short equations using summation</p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math inline">\(a_1 + 2 \ a_2 + 3 \ a_3 + 4 \ a_4 + 5 \ a_5\)</span></p></li>
<li><p><span class="math inline">\(p^n + p^{n-1} \ q^1 + + p^{n-2} \ q^2 +\dots + p^{n-r} \ q^r + \dots + q^n\)</span></p></li>
</ol>
</div>
<div id="homework-exercise-1" class="section level3">
<h3><span class="header-section-number">1.9.2</span> Homework Exercise</h3>
<p>Imagine you studied the effects of probiotic supplement on white cell count in rats. Five rats selected randomly from a set of 15 received a base diet, 5 received a based diet with sterilized probiotic and 5 received the base diet with the live probiotic. White cells were counted and averaged over 7 days for each rat before the treatments and again during second week after starting the diets.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Formulate a statistical model for this experiment and describe each component. Identify fixed and random components. Use subscripts and define their ranges and meaning.</p></li>
<li><p>What is the response variable of interest? What is the predictor variable of interest?</p></li>
</ol>
</div>
<div id="homework-exercise-2" class="section level3">
<h3><span class="header-section-number">1.9.3</span> Homework Exercise</h3>
</div>
<div id="homework-exercise-3" class="section level3">
<h3><span class="header-section-number">1.9.4</span> Homework Exercise</h3>
</div>
</div>
</div>







<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>For this simple example we merged the units with the ingredients. Explicit use of units it always necessary. Measure twice cut once! One of many costly examples: NASA lost a Mars Explorer due to confusion between metric and imperial units.<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>In reality, linear statistical models are <em>almost</em> like recipes because in statistical models we can have negative values for the amounts of a parameter put into the combination, but in recipes we cannot have negative amounts of ingredients.<a href="#fnref2">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
