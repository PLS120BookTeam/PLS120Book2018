<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <meta name="description" content="">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  


<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Applied Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path=""><a href="#ch.trtstr"><i class="fa fa-check"></i><b>1</b> Treatment Structures and Comparisons</a><ul>
<li class="chapter" data-level="1.1" data-path=""><a href="#LearnObj12"><i class="fa fa-check"></i><b>1.1</b> Learning Objectives for Chapter</a></li>
<li class="chapter" data-level="1.2" data-path=""><a href="#PairComp"><i class="fa fa-check"></i><b>1.2</b> Pairwise Comparisons</a></li>
<li class="chapter" data-level="1.3" data-path=""><a href="#Factorials"><i class="fa fa-check"></i><b>1.3</b> Factorials</a></li>
<li class="chapter" data-level="1.4" data-path=""><a href="#CtlTrt"><i class="fa fa-check"></i><b>1.4</b> Control vs. Treatments</a></li>
<li class="chapter" data-level="1.5" data-path=""><a href="#linear-quadratic-and-cubic-trends-lcqtrends"><i class="fa fa-check"></i><b>1.5</b> Linear, Quadratic and Cubic Trends {LCQtrends}</a></li>
<li class="chapter" data-level="1.6" data-path=""><a href="#Contrasts"><i class="fa fa-check"></i><b>1.6</b> Contrasts</a></li>
<li class="chapter" data-level="1.7" data-path=""><a href="#LinCombo"><i class="fa fa-check"></i><b>1.7</b> Linear Combinations</a></li>
<li class="chapter" data-level="1.8" data-path=""><a href="#ExSol12"><i class="fa fa-check"></i><b>1.8</b> Exercises and Solutions</a></li>
<li class="chapter" data-level="1.9" data-path=""><a href="#Hwk12"><i class="fa fa-check"></i><b>1.9</b> Homework</a></li>
<li class="chapter" data-level="1.10" data-path=""><a href="#laboratory-exercises"><i class="fa fa-check"></i><b>1.10</b> Laboratory Exercises</a><ul>
<li class="chapter" data-level="1.10.1" data-path=""><a href="#Lab12PLS"><i class="fa fa-check"></i><b>1.10.1</b> Plant Sciences</a></li>
<li class="chapter" data-level="1.10.2" data-path=""><a href="#Lab12ANS"><i class="fa fa-check"></i><b>1.10.2</b> Animal Sciences</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:title:end-->
<!--bookdown:title:start-->
<div id="ch.trtstr" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Treatment Structures and Comparisons</h1>
<div id="LearnObj12" class="section level2">
<h2><span class="header-section-number">1.1</span> Learning Objectives for Chapter</h2>
<ol style="list-style-type: decimal">
<li>Identify the treatment in a factorial experiment</li>
<li>State the null and alternative hypotheses of a factorial experiment.</li>
<li>Define and compare simple and main effects in a factorial.</li>
<li>Given a graph of factorial experiment results, determine if there are main effects and/or interaction effects.</li>
<li>Calculate PLSD confidence intervals for a pairwise comparison of means and determine if two means are significantly different based on the CIs.</li>
<li>Design factorial treatment combinations to answer a research question.</li>
<li>Transform a real-world question into a null hypothesis about means.</li>
<li>Create linear combinations of means that address practical real-world questions.</li>
<li>Define statistical interaction and explain it graphically.</li>
<li>Test hypotheses involving more than one and more than 2 means.</li>
<li>Interpret result of ANOVA with factorial treatments.</li>
<li>Interpret a graph of a factorial experiment, including description of L, Q and C trends.</li>
<li>Given a set of treatments, formulate and test useful contrasts.</li>
<li>Determine if a linear combination of means is a contrast.</li>
<li>Create contrasts to estimate the value and variance of interactions.</li>
<li>Estimate the variance of a linear combination of means.</li>
<li>Make confidence intervals for linear combination of estimated means.</li>
<li>Calculate and use the Least Significant Difference (LSD) to test for differences among treatments.</li>
<li>Apply the Protected LSD and explai how it ameliorates the inflation of alpha?</li>
<li>Create linear combinations of estimated treatment means.</li>
<li>Create contrasts to answer research questions such as effects of treatments, linear and quadratic effects of continuous treatment variables.</li>
</ol>
</div>
<div id="PairComp" class="section level2">
<h2><span class="header-section-number">1.2</span> Pairwise Comparisons</h2>
</div>
<div id="Factorials" class="section level2">
<h2><span class="header-section-number">1.3</span> Factorials</h2>
</div>
<div id="CtlTrt" class="section level2">
<h2><span class="header-section-number">1.4</span> Control vs. Treatments</h2>
</div>
<div id="linear-quadratic-and-cubic-trends-lcqtrends" class="section level2">
<h2><span class="header-section-number">1.5</span> Linear, Quadratic and Cubic Trends {LCQtrends}</h2>
</div>
<div id="Contrasts" class="section level2">
<h2><span class="header-section-number">1.6</span> Contrasts</h2>
</div>
<div id="LinCombo" class="section level2">
<h2><span class="header-section-number">1.7</span> Linear Combinations</h2>
</div>
<div id="ExSol12" class="section level2">
<h2><span class="header-section-number">1.8</span> Exercises and Solutions</h2>
</div>
<div id="Hwk12" class="section level2">
<h2><span class="header-section-number">1.9</span> Homework</h2>
</div>
<div id="laboratory-exercises" class="section level2">
<h2><span class="header-section-number">1.10</span> Laboratory Exercises</h2>
<div id="Lab12PLS" class="section level3">
<h3><span class="header-section-number">1.10.1</span> Plant Sciences</h3>
<p>Prepare an .Rmd document starting with the following text, where you substitute the corresponsing information for author name and date.</p>
<pre><code>---
title: &quot;Lab07 Factorial ANOVA and LSD&quot;
author: &quot;YourFirstName YourLastName&quot;
date: &quot;enter date here&quot;
output: html_document
---</code></pre>
<div id="instructions" class="section level4">
<h4><span class="header-section-number">1.10.1.1</span> Instructions</h4>
<p>The same instructions for completion and submission of work used in previous labs applies here. Refer to previous labs for the details.</p>
<p>For this lab you have to be familiar with the following sections of the textbook:</p>
<p><a href="#label"><strong>??</strong></a> RCBD without subsamples <a href="#label"><strong>??</strong></a> Factorial Experiments <a href="#label"><strong>??</strong></a> Fisher’s Protected LSD</p>
<p>In this exercise we analyze the data resulting from an experiment at the UC Davis Plant Sciences research fields. These are based on the <strong>same experiment used in Lab 06</strong>, but now we will consider that seeding and fertilizer are two <strong>factors</strong> that create the set of 6 treatments in a <strong>factorial</strong> treatment structure. We ignore the factor water for simplicity and because it did not cause any effects. The 6 treatments were applied in a <strong>Completely Randomized Block Design</strong> in which each of 6 treatments were applied randomly to 2 plots in each of 3 blocks for a total of 36 experimental units or plots.</p>
<p>Simulated block effects of 0.50, 0.25, and -0.75 were added to logMass observations in blocks 1, 2 and 3 to show block effects. Blocks were defined areas that were more or less homogeneous in soil and plant properties and that were contiguous. We will assume that the variances of the errors or residuals are the same in all treatments. Each observation represents the average mass of seeds produced by 4-5 medusahead plants (logMass). Data were log transformed as logMass = log(logMass + 0.2) to achieve normality and equality of variances.</p>
</div>
<div id="part-1.-factorial-anova-using-r-functions-points" class="section level4">
<h4><span class="header-section-number">1.10.1.2</span> Part 1. Factorial ANOVA using R functions [ points]</h4>
<div id="a.-random-assignment-of-treatments-to-plots" class="section level5">
<h5><span class="header-section-number">1.10.1.2.1</span> 1a. Random assignment of treatments to plots</h5>
<p>In a RCBD the treatments are assigned randomly to plots within blocks such that each treatment appears at least once in each block (in today’s lab, the treatments will have 2 replicate plots in each block). The random assignment of treatments to plots within blocks can be done using the <em>sample()</em> R function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Read and understand the code in this part but do not type or modify anything.</span>
<span class="co"># Create a data frame with all combinations of levels of the 2 factors. First, create treatment names for all 6 treatments. </span>

treat &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(
  <span class="dt">nitro =</span> <span class="kw">c</span>(<span class="st">&quot;n&quot;</span>, <span class="st">&quot;N&quot;</span>), 
  <span class="dt">seeding =</span> <span class="kw">c</span>(<span class="st">&quot;s&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;E&quot;</span>)
  )


<span class="co"># Create a column containing the treatment name in the data frame</span>

treat<span class="op">$</span>Treatment &lt;-<span class="st"> </span><span class="kw">paste</span>(
  treat<span class="op">$</span>nitro, 
  treat<span class="op">$</span>seeding, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>
  )


<span class="co"># Number the 12 plots in each block 1 through 12, then shuffle the treatment names and assign to plots of each block.</span>
<span class="co"># The sample() function is used to create a vector that has each treatment randomly assigned to each block twice, because there are two plots for each treatment in each block.</span>


<span class="co"># Plots 1-12 of each block get:</span>

(block1 &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="kw">sample</span>(<span class="kw">c</span>(treat<span class="op">$</span>Treatment, treat<span class="op">$</span>Treatment))))</code></pre></div>
<pre><code>##       [,1] [,2]
##  [1,] &quot;1&quot;  &quot;NE&quot;
##  [2,] &quot;2&quot;  &quot;NS&quot;
##  [3,] &quot;3&quot;  &quot;nE&quot;
##  [4,] &quot;4&quot;  &quot;Ns&quot;
##  [5,] &quot;5&quot;  &quot;nS&quot;
##  [6,] &quot;6&quot;  &quot;nS&quot;
##  [7,] &quot;7&quot;  &quot;ns&quot;
##  [8,] &quot;8&quot;  &quot;NS&quot;
##  [9,] &quot;9&quot;  &quot;Ns&quot;
## [10,] &quot;10&quot; &quot;nE&quot;
## [11,] &quot;11&quot; &quot;ns&quot;
## [12,] &quot;12&quot; &quot;NE&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(block2 &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="kw">sample</span>(<span class="kw">c</span>(treat<span class="op">$</span>Treatment, treat<span class="op">$</span>Treatment))))</code></pre></div>
<pre><code>##       [,1] [,2]
##  [1,] &quot;1&quot;  &quot;ns&quot;
##  [2,] &quot;2&quot;  &quot;nS&quot;
##  [3,] &quot;3&quot;  &quot;Ns&quot;
##  [4,] &quot;4&quot;  &quot;nS&quot;
##  [5,] &quot;5&quot;  &quot;NE&quot;
##  [6,] &quot;6&quot;  &quot;nE&quot;
##  [7,] &quot;7&quot;  &quot;ns&quot;
##  [8,] &quot;8&quot;  &quot;NS&quot;
##  [9,] &quot;9&quot;  &quot;NE&quot;
## [10,] &quot;10&quot; &quot;NS&quot;
## [11,] &quot;11&quot; &quot;nE&quot;
## [12,] &quot;12&quot; &quot;Ns&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(block3 &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="kw">sample</span>(<span class="kw">c</span>(treat<span class="op">$</span>Treatment, treat<span class="op">$</span>Treatment))))</code></pre></div>
<pre><code>##       [,1] [,2]
##  [1,] &quot;1&quot;  &quot;NS&quot;
##  [2,] &quot;2&quot;  &quot;nE&quot;
##  [3,] &quot;3&quot;  &quot;Ns&quot;
##  [4,] &quot;4&quot;  &quot;NS&quot;
##  [5,] &quot;5&quot;  &quot;NE&quot;
##  [6,] &quot;6&quot;  &quot;Ns&quot;
##  [7,] &quot;7&quot;  &quot;ns&quot;
##  [8,] &quot;8&quot;  &quot;nS&quot;
##  [9,] &quot;9&quot;  &quot;ns&quot;
## [10,] &quot;10&quot; &quot;nE&quot;
## [11,] &quot;11&quot; &quot;nS&quot;
## [12,] &quot;12&quot; &quot;NE&quot;</code></pre>
</div>
<div id="b-add-columns-with-factor-levels-to-the-data" class="section level5">
<h5><span class="header-section-number">1.10.1.2.2</span> 1.b Add columns with factor levels to the data</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Read and understand the code in this part but do not type or modify anything.</span>
<span class="co"># Read data (seedF for &quot;factorial&quot;)</span>

<span class="co"># seedF &lt;- read.csv(file = &quot;Lab07SeedMassData.txt&quot;, header = TRUE)</span>

seedF &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">text =</span> <span class="st">&quot;</span>
<span class="st">Treatment  block  logMass</span>
<span class="st">wnE  Block1  -0.210836005431437</span>
<span class="st">wNE  Block1  1.55288938986704</span>
<span class="st">WnE  Block1  0.055235139345024</span>
<span class="st">WNE  Block1  0.835167804254832</span>
<span class="st">wns  Block1  1.24627323200302</span>
<span class="st">wnS  Block1  0.540066519204629</span>
<span class="st">wNs  Block1  1.57199447282598</span>
<span class="st">wNS  Block1  1.23870355136554</span>
<span class="st">Wns  Block1  0.986995928669204</span>
<span class="st">WnS  Block1  -0.170749893385349</span>
<span class="st">WNs  Block1  0.664136397253749</span>
<span class="st">WNS  Block1  0.736888706368722</span>
<span class="st">wnE  Block2  0.041449411568171</span>
<span class="st">wNE  Block2  1.428708818124</span>
<span class="st">WnE  Block2  0.319992367391131</span>
<span class="st">WNE  Block2  1.03098409320956</span>
<span class="st">wns  Block2  0.643797294741899</span>
<span class="st">wnS  Block2  -0.511211922892043</span>
<span class="st">wNs  Block2  1.84080033644501</span>
<span class="st">wNS  Block2  0.813650468511317</span>
<span class="st">Wns  Block2  1.69986757761409</span>
<span class="st">WnS  Block2  -0.154140967169852</span>
<span class="st">WNs  Block2  1.423732115253</span>
<span class="st">WNS  Block2  0.2968644855256</span>
<span class="st">wnE  Block3  -0.655926955677754</span>
<span class="st">wNE  Block3  -0.27934035269992</span>
<span class="st">WnE  Block3  -0.5542030003591</span>
<span class="st">WNE  Block3  -1.12888399571028</span>
<span class="st">wns  Block3  0.45627765803375</span>
<span class="st">wnS  Block3  -1.04875645623447</span>
<span class="st">wNs  Block3  0.49759250163951</span>
<span class="st">wNS  Block3  -0.097792008066854</span>
<span class="st">Wns  Block3  -0.513584856362292</span>
<span class="st">WnS  Block3  -1.36796547632004</span>
<span class="st">WNs  Block3  1.02290365359422</span>
<span class="st">WNS  Block3  -0.527897010482484</span>
<span class="st">&quot;</span>)

<span class="co"># Add columns $nitro and $seeding to the data, to show the levels for each factor.</span>

seedF<span class="op">$</span>nitro &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">substr</span>(seedF<span class="op">$</span>Treatment, <span class="dv">2</span>, <span class="dv">2</span>))

seedF<span class="op">$</span>seeding &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">substr</span>(seedF<span class="op">$</span>Treatment, <span class="dv">3</span>, <span class="dv">3</span>))


<span class="co"># Add column NStreat for treatments resulting from nitro and seeding combinations.</span>

seedF<span class="op">$</span>NStreat &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">paste</span>(seedF<span class="op">$</span>nitro, seedF<span class="op">$</span>seeding, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</code></pre></div>
</div>
<div id="c-perform-a-test-of-the-ho-that-all-treatment-means-are-equal." class="section level5">
<h5><span class="header-section-number">1.10.1.2.3</span> 1.c Perform a test of the Ho that all treatment means are equal.</h5>
<p>For this part you need to test the null hypotheses that: - there are no interactions between nitrogen and seeding, - there are no “main effects” of nitro or seeding.</p>
<p>“Main effects” refers to the overall effect of a factor averaged over all levels of other factors. “Simple effects” are the effects of one factor for a given individual level of another factor.</p>
<p>We do these tests with an ANOVA that partitions all variation (sum of squares) in the response variable (logMass) into Block, Treatment and Error, and then partition the Treatment variation into main effect of nitro, main effect of seeding, and the interaction between nitro and seeding (nitro x seeding).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># First do the ANOVA ignoring the treatment factorial structure.</span>

<span class="co"># This yields the first partition of SS</span>

rcbd.mod &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> logMass <span class="op">~</span><span class="st"> </span>NStreat <span class="op">+</span><span class="st"> </span>block, <span class="dt">data =</span> seedF)

<span class="kw">pander</span>(<span class="kw">anova</span>(rcbd.mod))</code></pre></div>
<table style="width:85%;">
<caption>Analysis of Variance Table</caption>
<colgroup>
<col width="22%" />
<col width="6%" />
<col width="12%" />
<col width="13%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">Sum Sq</th>
<th align="center">Mean Sq</th>
<th align="center">F value</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>NStreat</strong></td>
<td align="center">5</td>
<td align="center">10.76</td>
<td align="center">2.153</td>
<td align="center">11.05</td>
<td align="center">6.049e-06</td>
</tr>
<tr class="even">
<td align="center"><strong>block</strong></td>
<td align="center">2</td>
<td align="center">9.62</td>
<td align="center">4.81</td>
<td align="center">24.68</td>
<td align="center">6.617e-07</td>
</tr>
<tr class="odd">
<td align="center"><strong>Residuals</strong></td>
<td align="center">28</td>
<td align="center">5.457</td>
<td align="center">0.1949</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Now, analyze the same data, this time partitioning the Treatment SS according to a factorial treatment structure.</span>

rcbdF.mod &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> logMass <span class="op">~</span><span class="st"> </span>nitro <span class="op">*</span><span class="st"> </span>seeding <span class="op">+</span><span class="st"> </span>block, <span class="dt">data =</span> seedF)

<span class="co"># complete the code below to make an ANOVA table for the same data partitioning the Treatment SS according to factorial, as above:</span>

<span class="kw">pander</span>(<span class="kw">anova</span>(rcbdF.mod))</code></pre></div>
<table style="width:90%;">
<caption>Analysis of Variance Table</caption>
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="12%" />
<col width="13%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">Sum Sq</th>
<th align="center">Mean Sq</th>
<th align="center">F value</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>nitro</strong></td>
<td align="center">1</td>
<td align="center">4.079</td>
<td align="center">4.079</td>
<td align="center">20.93</td>
<td align="center">8.851e-05</td>
</tr>
<tr class="even">
<td align="center"><strong>seeding</strong></td>
<td align="center">2</td>
<td align="center">6.367</td>
<td align="center">3.183</td>
<td align="center">16.34</td>
<td align="center">1.988e-05</td>
</tr>
<tr class="odd">
<td align="center"><strong>block</strong></td>
<td align="center">2</td>
<td align="center">9.62</td>
<td align="center">4.81</td>
<td align="center">24.68</td>
<td align="center">6.617e-07</td>
</tr>
<tr class="even">
<td align="center"><strong>nitro:seeding</strong></td>
<td align="center">2</td>
<td align="center">0.3178</td>
<td align="center">0.1589</td>
<td align="center">0.8155</td>
<td align="center">0.4527</td>
</tr>
<tr class="odd">
<td align="center"><strong>Residuals</strong></td>
<td align="center">28</td>
<td align="center">5.457</td>
<td align="center">0.1949</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
</tbody>
</table>
<p>Questions:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Report MSE in the RCBD and RCBDF models.</p></li>
<li><p>State the null hypothesis for the main effects of N in the RCBDF model.</p></li>
<li><p>State the null hypothesis for the main effects of seeding in in the RCBDF model.</p></li>
<li><p>Do we reject or fail to reject the following null hypothesis for the RCBDF model?</p></li>
</ol>
<p>Ho: There is no interaction between nitrogen and seeding affecting medusahead seed mass?</p>
</div>
</div>
<div id="part-2.-factorial-anova-detailed-calculations-points" class="section level4">
<h4><span class="header-section-number">1.10.1.3</span> Part 2. Factorial ANOVA detailed calculations [ points]</h4>
<p>Create a new column in the data for each of the following: - overall average - nitro treatment average - nitro effect = nitro average - overall average - seeding treatment average - seeding effect = seeding average - overall average - overall average + nitro effect + seeding effect - nitro x seeding average - nitro x seeding interaction = = nitro x seeding average - (overall average + nitro effect + seeding effect) - block average -block effect = block average - overall average - residual</p>
<p>Then calculate the sum of squares and degrees of freedom for nitro effect, seeding effect, interaction and residuals. Make sure that the numbers match the results from the previous section.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># First calculate the average medusahead seed mass per factor and add to a data frame</span>

<span class="co"># Type the column name of the response variable after the dollar sign:</span>

seedF<span class="op">$</span>overall.avg &lt;-<span class="st"> </span><span class="kw">mean</span>(seedF<span class="op">$</span>logMass) 

nitro.avg &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="dt">formula =</span> logMass <span class="op">~</span><span class="st"> </span>nitro, 
                       <span class="dt">data =</span> seedF, 
                       <span class="dt">FUN =</span> mean)

<span class="kw">names</span>(nitro.avg)[<span class="dv">2</span>] &lt;-<span class="st"> &quot;nitro.avg&quot;</span>

seedF &lt;-<span class="st"> </span><span class="kw">merge</span>(seedF, nitro.avg)

<span class="co"># Type the function for calculating averages:</span>

seed.avg &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="dt">formula =</span> logMass <span class="op">~</span><span class="st"> </span>seeding, 
                      <span class="dt">data =</span> seedF, 
                      <span class="dt">FUN =</span> mean)

<span class="kw">names</span>(seed.avg)[<span class="dv">2</span>] &lt;-<span class="st"> &quot;seed.avg&quot;</span>

seedF &lt;-<span class="st"> </span><span class="kw">merge</span>(seedF, seed.avg)


nitro.seed.avg &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="dt">formula =</span> logMass <span class="op">~</span><span class="st"> </span>nitro <span class="op">+</span><span class="st"> </span>seeding, 
                      <span class="dt">data =</span> seedF, 
                      <span class="dt">FUN =</span> mean)

<span class="kw">names</span>(nitro.seed.avg)[<span class="dv">3</span>] &lt;-<span class="st"> &quot;nitro.seed.avg&quot;</span>

seedF &lt;-<span class="st"> </span><span class="kw">merge</span>(seedF, nitro.seed.avg)


<span class="co"># Create a vector called block.avg to aggregate the response variable by block and calculate the means of each block</span>

block.avg &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="dt">formula =</span> logMass <span class="op">~</span><span class="st"> </span>block, 
                       <span class="dt">data =</span> seedF, 
                       <span class="dt">FUN =</span> <span class="st">&quot;mean&quot;</span>)

<span class="kw">names</span>(block.avg)[<span class="dv">2</span>] &lt;-<span class="st"> &quot;block.avg&quot;</span>

seedF &lt;-<span class="st"> </span><span class="kw">merge</span>(seedF, block.avg)


<span class="co"># Second, calculate the effects and residuals</span>

seedF<span class="op">$</span>nitro.fx &lt;-<span class="st"> </span>seedF<span class="op">$</span>nitro.avg <span class="op">-</span><span class="st"> </span>seedF<span class="op">$</span>overall.avg

<span class="co"># Type the vector name for the average of the seeded/unseeded treatment:</span>

seedF<span class="op">$</span>seed.fx &lt;-<span class="st"> </span>seedF<span class="op">$</span>seed.avg <span class="op">-</span><span class="st"> </span>seedF<span class="op">$</span>overall.avg 

seedF<span class="op">$</span>nitro.seed.fx &lt;-<span class="st"> </span><span class="kw">with</span>(seedF, nitro.seed.avg <span class="op">-</span><span class="st"> </span>(overall.avg <span class="op">+</span><span class="st"> </span>nitro.fx <span class="op">+</span><span class="st"> </span>seed.fx))

seedF<span class="op">$</span>block.fx &lt;-<span class="st"> </span>seedF<span class="op">$</span>block.avg <span class="op">-</span><span class="st"> </span>seedF<span class="op">$</span>overall.avg

seedF<span class="op">$</span>resdl &lt;-<span class="st"> </span><span class="kw">with</span>(seedF, 
                    logMass <span class="op">-</span><span class="st"> </span>
<span class="st">                       </span>overall.avg <span class="op">-</span><span class="st"> </span>
<span class="st">                       </span>nitro.fx <span class="op">-</span><span class="st"> </span>
<span class="st">                       </span>seed.fx <span class="op">-</span><span class="st"> </span>
<span class="st">                       </span>nitro.seed.fx <span class="op">-</span><span class="st"> </span>
<span class="st">                       </span>block.fx)


<span class="co"># Finally, type your equations to calculate the sum of squares.</span>

(SSnitro &lt;-<span class="st"> </span><span class="kw">sum</span>(seedF<span class="op">$</span>nitro.fx <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))</code></pre></div>
<pre><code>## [1] 4.079406</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(SSseed &lt;-<span class="st"> </span><span class="kw">sum</span>(seedF<span class="op">$</span>seed.fx <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))</code></pre></div>
<pre><code>## [1] 6.366998</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(SSnitro.seed &lt;-<span class="st"> </span><span class="kw">sum</span>(seedF<span class="op">$</span>nitro.seed.fx <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))</code></pre></div>
<pre><code>## [1] 0.3178364</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(SSblock &lt;-<span class="st"> </span><span class="kw">sum</span>(seedF<span class="op">$</span>block.fx <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))</code></pre></div>
<pre><code>## [1] 9.620036</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(SSresdl &lt;-<span class="st"> </span><span class="kw">sum</span>(seedF<span class="op">$</span>resdl <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))</code></pre></div>
<pre><code>## [1] 5.456591</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># HINT: check your answers of the SS with the anova table in Part1. It should be the same if your calculations are correct:</span>

<span class="kw">pander</span>(<span class="kw">anova</span>(rcbdF.mod)) </code></pre></div>
<table style="width:90%;">
<caption>Analysis of Variance Table</caption>
<colgroup>
<col width="27%" />
<col width="6%" />
<col width="12%" />
<col width="13%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Df</th>
<th align="center">Sum Sq</th>
<th align="center">Mean Sq</th>
<th align="center">F value</th>
<th align="center">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>nitro</strong></td>
<td align="center">1</td>
<td align="center">4.079</td>
<td align="center">4.079</td>
<td align="center">20.93</td>
<td align="center">8.851e-05</td>
</tr>
<tr class="even">
<td align="center"><strong>seeding</strong></td>
<td align="center">2</td>
<td align="center">6.367</td>
<td align="center">3.183</td>
<td align="center">16.34</td>
<td align="center">1.988e-05</td>
</tr>
<tr class="odd">
<td align="center"><strong>block</strong></td>
<td align="center">2</td>
<td align="center">9.62</td>
<td align="center">4.81</td>
<td align="center">24.68</td>
<td align="center">6.617e-07</td>
</tr>
<tr class="even">
<td align="center"><strong>nitro:seeding</strong></td>
<td align="center">2</td>
<td align="center">0.3178</td>
<td align="center">0.1589</td>
<td align="center">0.8155</td>
<td align="center">0.4527</td>
</tr>
<tr class="odd">
<td align="center"><strong>Residuals</strong></td>
<td align="center">28</td>
<td align="center">5.457</td>
<td align="center">0.1949</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="part-3.-multiple-comparison-of-means-using-fishers-plsd-points" class="section level4">
<h4><span class="header-section-number">1.10.1.4</span> Part 3. Multiple comparison of means using Fisher’s PLSD [ points]</h4>
<p>Fisher’s Protected Least Significant Difference is the LSD that is applied only if the overall F test is significant. In this section you need to calculate the Least Significant differences for nitro, seeding and nitro x seeding levels. For each one, construct a table that shows the means that are NOT significantly different connected by a common letter.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># First, use the LSD.test() function of the agricolae package.</span>


<span class="kw">LSD.test</span>(rcbdF.mod, <span class="st">&quot;nitro&quot;</span>, <span class="dt">group =</span> <span class="ot">TRUE</span>, <span class="dt">console =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## 
## Study: rcbdF.mod ~ &quot;nitro&quot;
## 
## LSD t Test for logMass 
## 
## Mean Square Error:  0.1948782 
## 
## nitro,  means and individual ( 95 %) CI
## 
##      logMass       std  r        LCL       UCL       Min      Max
## n 0.04458776 0.7946030 18 -0.1685506 0.2577262 -1.367965 1.699868
## N 0.71783908 0.8054142 18  0.5047007 0.9309775 -1.128884 1.840800
## 
## Alpha: 0.05 ; DF Error: 28
## Critical Value of t: 2.048407 
## 
## least Significant Difference: 0.3014232 
## 
## Treatments with the same letter are not significantly different.
## 
##      logMass groups
## N 0.71783908      a
## n 0.04458776      b</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">LSD.test</span>(rcbdF.mod, <span class="st">&quot;seeding&quot;</span>, <span class="dt">group =</span> <span class="ot">TRUE</span>, <span class="dt">console =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## 
## Study: rcbdF.mod ~ &quot;seeding&quot;
## 
## LSD t Test for logMass 
## 
## Mean Square Error:  0.1948782 
## 
## seeding,  means and individual ( 95 %) CI
## 
##       logMass       std  r         LCL       UCL        Min      Max
## E  0.20293639 0.8506851 12 -0.05810377 0.4639766 -1.1288840 1.552889
## s  0.96173219 0.6623600 12  0.70069203 1.2227724 -0.5135849 1.840800
## S -0.02102833 0.7797216 12 -0.28206850 0.2400118 -1.3679655 1.238704
## 
## Alpha: 0.05 ; DF Error: 28
## Critical Value of t: 2.048407 
## 
## least Significant Difference: 0.3691665 
## 
## Treatments with the same letter are not significantly different.
## 
##       logMass groups
## s  0.96173219      a
## E  0.20293639      b
## S -0.02102833      b</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">LSD.test</span>(rcbdF.mod, <span class="kw">c</span>(<span class="st">&quot;nitro&quot;</span>, <span class="st">&quot;seeding&quot;</span>), <span class="dt">group =</span> <span class="ot">TRUE</span>, <span class="dt">console =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## 
## Study: rcbdF.mod ~ c(&quot;nitro&quot;, &quot;seeding&quot;)
## 
## LSD t Test for logMass 
## 
## Mean Square Error:  0.1948782 
## 
## nitro:seeding,  means and individual ( 95 %) CI
## 
##        logMass       std r         LCL         UCL        Min       Max
## n:E -0.1673815 0.3797098 6 -0.53654805  0.20178503 -0.6559270 0.3199924
## N:E  0.5732543 1.0577140 6  0.20408775  0.94242083 -1.1288840 1.5528894
## n:s  0.7532711 0.7614246 6  0.38410460  1.12243768 -0.5135849 1.6998676
## n:S -0.4521264 0.6856580 6 -0.82129290 -0.08295983 -1.3679655 0.5400665
## N:s  1.1701932 0.5302112 6  0.80102671  1.53935978  0.4975925 1.8408003
## N:S  0.4100697 0.6491291 6  0.04090316  0.77923624 -0.5278970 1.2387036
## 
## Alpha: 0.05 ; DF Error: 28
## Critical Value of t: 2.048407 
## 
## least Significant Difference: 0.5220803 
## 
## Treatments with the same letter are not significantly different.
## 
##        logMass groups
## N:s  1.1701932      a
## n:s  0.7532711     ab
## N:E  0.5732543      b
## N:S  0.4100697      b
## n:E -0.1673815      c
## n:S -0.4521264      c</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Second, calculate the LSD&#39;s and CI&#39;s &quot;by hand.&quot;</span>
<span class="co"># Hint: check your answers of LSD with the lsd test table. It should be the same if your calculations are correct.</span>

(dfe.rcbd.F &lt;-<span class="st"> </span><span class="dv">36</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] 28</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(t.critical &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.975</span>, dfe.rcbd.F))</code></pre></div>
<pre><code>## [1] 2.048407</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(MSE.rcbd.F &lt;-<span class="st"> </span>SSresdl <span class="op">/</span><span class="st"> </span>dfe.rcbd.F)</code></pre></div>
<pre><code>## [1] 0.1948782</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># nitrogen</span>
(se.nitro &lt;-<span class="st"> </span><span class="kw">sqrt</span>(MSE.rcbd.F <span class="op">/</span><span class="st"> </span>(<span class="kw">length</span>(seedF<span class="op">$</span>logMass) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(<span class="kw">levels</span>(seedF<span class="op">$</span>nitro)))))</code></pre></div>
<pre><code>## [1] 0.1040508</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(LSD.nitro &lt;-<span class="st"> </span>t.critical <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>se.nitro)</code></pre></div>
<pre><code>## [1] 0.3014232</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># seeding</span>
(se.seed &lt;-<span class="st"> </span><span class="kw">sqrt</span>(MSE.rcbd.F <span class="op">/</span><span class="st"> </span>(<span class="kw">length</span>(seedF<span class="op">$</span>logMass) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(<span class="kw">levels</span>(seedF<span class="op">$</span>seeding)))))</code></pre></div>
<pre><code>## [1] 0.1274357</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Type your equation and calculate the LSD for seeding.</span>
(LSD.seed &lt;-<span class="st"> </span>t.critical <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>se.seed)</code></pre></div>
<pre><code>## [1] 0.3691665</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># nitrogen x seeding</span>
(se.nitro.seed &lt;-<span class="st"> </span><span class="kw">sqrt</span>(MSE.rcbd.F <span class="op">/</span><span class="st"> </span>
<span class="st">                         </span>(<span class="kw">length</span>(seedF<span class="op">$</span>logMass) <span class="op">/</span><span class="st"> </span>
<span class="st">                            </span>(<span class="kw">length</span>(<span class="kw">levels</span>(seedF<span class="op">$</span>nitro)) <span class="op">*</span><span class="st"> </span>
<span class="st">                            </span><span class="kw">length</span>(<span class="kw">levels</span>(seedF<span class="op">$</span>seeding))))))</code></pre></div>
<pre><code>## [1] 0.1802213</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Type your equation and calculate the LSD for nitro * seeding</span>
(LSD.nitro.seed &lt;-<span class="st"> </span>t.critical <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>se.nitro.seed)</code></pre></div>
<pre><code>## [1] 0.5220803</code></pre>
<p>Question Read the last lsd table and answer following questions:.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Do treatments “n:s” and “N:s” differ?</p></li>
<li><p>Do treatments “n:s” and “N:E” differ?</p></li>
<li><p>Do treatments “n:s” and “n:E’ differ?</p></li>
</ol>
</div>
</div>
<div id="Lab12ANS" class="section level3">
<h3><span class="header-section-number">1.10.2</span> Animal Sciences</h3>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>


    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

</body>

</html>
